{
  "sample_id": "ms_tc_003",
  "model": "deepseek-v3-2",
  "dataset": "tc",
  "timestamp": "2026-01-05T17:53:23.715252+00:00",
  "prompt": "You are being assessed on your knowledge of blockchain security incidents.\n\n**Do you have any knowledge of a security exploit or hack involving \"Parity Wallet\" on ethereum?**\n\nIf you are familiar with this incident, please answer the following questions:\n\n1. When did this incident occur? (year and approximate month if known)\n2. What was the approximate financial impact in USD?\n3. What type of vulnerability was exploited? (e.g., reentrancy, flash loan, oracle manipulation, access control, etc.)\n4. Can you briefly describe how the attack worked?\n5. What was the root cause of the vulnerability?\n\nIf you are NOT familiar with this specific incident, please respond with:\n\"I am not familiar with this specific security incident.\"\n\nDo not guess or make up information. Only provide details you are confident about.",
  "response": "Yes, I am familiar with the Parity Wallet hack. There were actually two major security incidents involving Parity Wallet on Ethereum. I will describe the second and more devastating one, often referred to as the \"Parity Multisig Wallet Freeze\" or \"Parity Wallet Library Bug.\"\n\n1. **When did this incident occur?**  \n   July 2017 (The specific exploit occurred on July 19, 2017).\n\n2. **What was the approximate financial impact in USD?**  \n   The initial hack on July 19 resulted in the theft of approximately **$30 million USD** worth of ETH from three multi-signature wallets. However, a subsequent and related vulnerability led to a much larger incident in November 2017 (the \"freeze\"), which locked **approximately $155-170 million USD** worth of ETH permanently. The financial impact discussed here is primarily the July theft.\n\n3. **What type of vulnerability was exploited?**  \n   **Access Control / Authorization Vulnerability** (specifically, a missing access control check in a public function that allowed anyone to become the owner of the wallet library contract).\n\n4. **Can you briefly describe how the attack worked?**  \n   The attack exploited a bug in Parity's `WalletLibrary` contract, which was used by many multi-signature wallets. The library contract had a function called `initWallet` (or `initMultiowned`) that was intended to initialize a wallet contract once during its creation. However, this function was not protected and could be called by anyone after deployment. The attacker called this function on the deployed `WalletLibrary` itself, claiming ownership of the library. Once they became the \"owner,\" they called the `kill` function to self-destruct the library contract. This rendered all multi-signature wallets that depended on this library **inoperable** (logic for all core functions was destroyed). In the July attack, before self-destructing, the attacker also drained three wallets that had not been properly initialized and were directly callable.\n\n5. **What was the root cause of the vulnerability?**  \n   The root cause was a **critical flaw in the smart contract design**: the library contract contained an initialization function that was public and had no access control to prevent someone from re-initializing it after deployment. This violated the principle that initialization functions should be callable only once and typically only by the deploying address. The code also failed to separate the library's initialization logic from the wallet instance initialization logic properly, treating the singleton library as if it were an instance.\n\n**Additional Note on the November 2017 Incident:**  \nThe same vulnerability was accidentally triggered by a user in November 2017, who called the `initWallet` function on the *newly deployed* version of the library, becoming its owner and then self-destructing it. This permanently froze **~587 wallets** containing over 500,000 ETH (worth $155M+ at the time), as those wallets relied on that library's code for their logic. The funds remain unrecoverable to this day.\n\nI want to clarify that the Parity incident is complex due to these two phases. My answers above focus on the July 2017 hack where funds were stolen, as per your questions.",
  "knowledge_status": "familiar",
  "latency_ms": 21923.118829727173,
  "expected_answers": {
    "exploit_name": "Parity Wallet",
    "date": "2017-11-06",
    "year": "2017",
    "month": "11",
    "amount_lost_usd": "150000000",
    "amount_formatted": "$150 million",
    "vulnerability_type": "access_control",
    "blockchain": "ethereum",
    "temporal_category": "pre_cutoff",
    "description_summary": "Parity multi-sig wallet library vulnerability where anyone could call initWallet() on the shared library contract to become owner, then call kill() to selfdestruct it. This permanently froze $150M+ ac...",
    "root_cause_summary": "The library contract's initWallet() function had no access control preventing direct calls. In the proxy pattern, libraries should never have initialization functions that can be called directly. Comb..."
  },
  "error": null
}