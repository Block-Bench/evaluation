{
  "sample_id": "ds_t2_024",
  "tier": "tier2",
  "tool": "slither",
  "tool_version": "0.11.3",
  "solc_version": "0.4.23",
  "timestamp": "2026-01-03T22:34:54.250346",
  "success": true,
  "error": "",
  "execution_time_ms": 1340.4979705810547,
  "processing": {
    "processed_at": "2026-01-04T12:56:07.048375",
    "original_finding_count": 127,
    "filtered_finding_count": 41,
    "filter_breakdown": {
      "kept_high_medium": 21,
      "kept_low_mapped": 20,
      "filtered_excluded": 83,
      "filtered_low_unmapped": 0,
      "filtered_informational": 3
    },
    "filters_applied": [
      "High/Medium severity: keep all",
      "Low severity: keep only if mapped to vulnerability type",
      "Informational/Optimization: filter out",
      "Always exclude: 18 detector types"
    ]
  },
  "findings": [
    {
      "original_index": 0,
      "check": "arbitrary-send-eth",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "access_control",
      "description": "LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691) sends eth to arbitrary user\n\tDangerous calls:\n\t- Channels[_lcID].partyAddresses[0].transfer(_balances[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#660)\n\t- Channels[_lcID].partyAddresses[1].transfer(_balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#661)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[0].transfer(_balances[0])",
          "line_start": 660,
          "line_end": 660,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[1].transfer(_balances[1])",
          "line_start": 661,
          "line_end": 661,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 1,
      "check": "encode-packed-collision",
      "impact": "High",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "ECTools.toEthereumSignedMessage(string) (samples/ds/tier2/contracts/ds_t2_024.sol#152-159) calls abi.encodePacked() with multiple dynamic arguments:\n\t- keccak256()(abi.encodePacked(prefix,uintToString(len),_msg)) (samples/ds/tier2/contracts/ds_t2_024.sol#158)\n",
      "elements": [
        {
          "type": "function",
          "name": "toEthereumSignedMessage",
          "line_start": 152,
          "line_end": 159,
          "contract": "ECTools"
        },
        {
          "type": "node",
          "name": "keccak256()(abi.encodePacked(prefix,uintToString(len),_msg))",
          "line_start": 158,
          "line_end": 158,
          "function": "toEthereumSignedMessage(string)",
          "contract": "ECTools"
        }
      ]
    },
    {
      "original_index": 2,
      "check": "reentrancy-eth",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045):\n\tExternal calls:\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1018-1024)\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1025-1031)\n\tExternal calls sending eth:\n\t- channel.partyAddresses[0].transfer(ethbalanceA) (samples/ds/tier2/contracts/ds_t2_024.sol#1013)\n\t- channel.partyAddresses[1].transfer(ethbalanceI) (samples/ds/tier2/contracts/ds_t2_024.sol#1014)\n\tState variables written after the call(s):\n\t- channel.isOpen = false (samples/ds/tier2/contracts/ds_t2_024.sol#1034)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "byzantineCloseChannel",
          "line_start": 966,
          "line_end": 1045,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure)",
          "line_start": 1018,
          "line_end": 1024,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure)",
          "line_start": 1025,
          "line_end": 1031,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "channel.partyAddresses[0].transfer(ethbalanceA)",
          "line_start": 1013,
          "line_end": 1013,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "channel.partyAddresses[1].transfer(ethbalanceI)",
          "line_start": 1014,
          "line_end": 1014,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "channel.isOpen = false",
          "line_start": 1034,
          "line_end": 1034,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 3,
      "check": "reentrancy-eth",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#497-503)\n\tExternal calls sending eth:\n\t- Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#492-494)\n\tState variables written after the call(s):\n\t- delete Channels[_lcID] (samples/ds/tier2/contracts/ds_t2_024.sol#516)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "LCOpenTimeout",
          "line_start": 484,
          "line_end": 517,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure)",
          "line_start": 497,
          "line_end": 503,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0])",
          "line_start": 492,
          "line_end": 494,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "delete Channels[_lcID]",
          "line_start": 516,
          "line_end": 516,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 4,
      "check": "constant-function-asm",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel._isContained(bytes32,bytes,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1047-1068) is declared view but contains assembly code\n",
      "elements": [
        {
          "type": "function",
          "name": "_isContained",
          "line_start": 1047,
          "line_end": 1068,
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 5,
      "check": "constant-function-asm",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "ECTools.recoverSigner(bytes32,string) (samples/ds/tier2/contracts/ds_t2_024.sol#66-95) is declared view but contains assembly code\n",
      "elements": [
        {
          "type": "function",
          "name": "recoverSigner",
          "line_start": 66,
          "line_end": 95,
          "contract": "ECTools"
        }
      ]
    },
    {
      "original_index": 6,
      "check": "constant-function-asm",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "ECTools.uintToBytes32(uint256) (samples/ds/tier2/contracts/ds_t2_024.sol#143-148) is declared view but contains assembly code\n",
      "elements": [
        {
          "type": "function",
          "name": "uintToBytes32",
          "line_start": 143,
          "line_end": 148,
          "contract": "ECTools"
        }
      ]
    },
    {
      "original_index": 7,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691) uses a dangerous strict equality:\n\t- require(bool)(totalTokenDeposit == _balances[2] + _balances[3]) (samples/ds/tier2/contracts/ds_t2_024.sol#630)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(totalTokenDeposit == _balances[2] + _balances[3])",
          "line_start": 630,
          "line_end": 630,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 8,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691) uses a dangerous strict equality:\n\t- require(bool)(Channels[_lcID].isOpen == true) (samples/ds/tier2/contracts/ds_t2_024.sol#622)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].isOpen == true)",
          "line_start": 622,
          "line_end": 622,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 9,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550) uses a dangerous strict equality:\n\t- require(bool)(Channels[_lcID].isOpen == false) (samples/ds/tier2/contracts/ds_t2_024.sol#521)\n",
      "elements": [
        {
          "type": "function",
          "name": "joinChannel",
          "line_start": 519,
          "line_end": 550,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].isOpen == false)",
          "line_start": 521,
          "line_end": 521,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 10,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832) uses a dangerous strict equality:\n\t- require(bool)(_isContained(_initState,_proof,Channels[_lcID].VCrootHash) == true) (samples/ds/tier2/contracts/ds_t2_024.sol#805-807)\n",
      "elements": [
        {
          "type": "function",
          "name": "initVCstate",
          "line_start": 768,
          "line_end": 832,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(_isContained(_initState,_proof,Channels[_lcID].VCrootHash) == true)",
          "line_start": 805,
          "line_end": 807,
          "function": "initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 11,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611) uses a dangerous strict equality:\n\t- require(bool,string)(Channels[_lcID].isOpen == true,Tried adding funds to a closed channel) (samples/ds/tier2/contracts/ds_t2_024.sol#559-562)\n",
      "elements": [
        {
          "type": "function",
          "name": "deposit",
          "line_start": 553,
          "line_end": 611,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].isOpen == true,Tried adding funds to a closed channel)",
          "line_start": 559,
          "line_end": 562,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 12,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517) uses a dangerous strict equality:\n\t- require(bool)(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false) (samples/ds/tier2/contracts/ds_t2_024.sol#485-488)\n",
      "elements": [
        {
          "type": "function",
          "name": "LCOpenTimeout",
          "line_start": 484,
          "line_end": 517,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false)",
          "line_start": 485,
          "line_end": 488,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 13,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691) uses a dangerous strict equality:\n\t- require(bool)(totalEthDeposit == _balances[0] + _balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#629)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(totalEthDeposit == _balances[0] + _balances[1])",
          "line_start": 629,
          "line_end": 629,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 14,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "LedgerChannel._isContained(bytes32,bytes,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1047-1068) uses a dangerous strict equality:\n\t- cursor == _root (samples/ds/tier2/contracts/ds_t2_024.sol#1067)\n",
      "elements": [
        {
          "type": "function",
          "name": "_isContained",
          "line_start": 1047,
          "line_end": 1068,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "cursor == _root",
          "line_start": 1067,
          "line_end": 1067,
          "function": "_isContained(bytes32,bytes,bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 15,
      "check": "reentrancy-no-eth",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#572-579)\n\tState variables written after the call(s):\n\t- Channels[_lcID].erc20Balances[2] += _balance (samples/ds/tier2/contracts/ds_t2_024.sol#580)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].ethBalances[3] += msg.value (samples/ds/tier2/contracts/ds_t2_024.sol#606)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "deposit",
          "line_start": 553,
          "line_end": 611,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 572,
          "line_end": 579,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].erc20Balances[2] += _balance",
          "line_start": 580,
          "line_end": 580,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].ethBalances[3] += msg.value",
          "line_start": 606,
          "line_end": 606,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 16,
      "check": "reentrancy-no-eth",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#532-539)\n\tState variables written after the call(s):\n\t- Channels[_lcID].erc20Balances[1] = _balances[1] (samples/ds/tier2/contracts/ds_t2_024.sol#540)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].initialDeposit[0] += _balances[0] (samples/ds/tier2/contracts/ds_t2_024.sol#543)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].initialDeposit[1] += _balances[1] (samples/ds/tier2/contracts/ds_t2_024.sol#544)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].isOpen = true (samples/ds/tier2/contracts/ds_t2_024.sol#546)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "joinChannel",
          "line_start": 519,
          "line_end": 550,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure)",
          "line_start": 532,
          "line_end": 539,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].erc20Balances[1] = _balances[1]",
          "line_start": 540,
          "line_end": 540,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].initialDeposit[0] += _balances[0]",
          "line_start": 543,
          "line_end": 543,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].initialDeposit[1] += _balances[1]",
          "line_start": 544,
          "line_end": 544,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].isOpen = true",
          "line_start": 546,
          "line_end": 546,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 17,
      "check": "reentrancy-no-eth",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#572-579)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#592-599)\n\tState variables written after the call(s):\n\t- Channels[_lcID].erc20Balances[3] += _balance (samples/ds/tier2/contracts/ds_t2_024.sol#600)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "deposit",
          "line_start": 553,
          "line_end": 611,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 572,
          "line_end": 579,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 592,
          "line_end": 599,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].erc20Balances[3] += _balance",
          "line_start": 600,
          "line_end": 600,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 18,
      "check": "reentrancy-no-eth",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#455-462)\n\tState variables written after the call(s):\n\t- Channels[_lcID].erc20Balances[0] = _balances[1] (samples/ds/tier2/contracts/ds_t2_024.sol#463)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].sequence = 0 (samples/ds/tier2/contracts/ds_t2_024.sol#466)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].confirmTime = _confirmTime (samples/ds/tier2/contracts/ds_t2_024.sol#467)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].LCopenTimeout = now + _confirmTime (samples/ds/tier2/contracts/ds_t2_024.sol#470)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n\t- Channels[_lcID].initialDeposit = _balances (samples/ds/tier2/contracts/ds_t2_024.sol#471)\n\tLedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421) can be used in cross function reentrancies:\n\t- LedgerChannel.Channels (samples/ds/tier2/contracts/ds_t2_024.sol#421)\n\t- LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517)\n\t- LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045)\n\t- LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964)\n\t- LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691)\n\t- LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482)\n\t- LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611)\n\t- LedgerChannel.getChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1071-1106)\n\t- LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832)\n\t- LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550)\n\t- LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912)\n\t- LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765)\n",
      "elements": [
        {
          "type": "function",
          "name": "createChannel",
          "line_start": 423,
          "line_end": 482,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure)",
          "line_start": 455,
          "line_end": 462,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].erc20Balances[0] = _balances[1]",
          "line_start": 463,
          "line_end": 463,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].sequence = 0",
          "line_start": 466,
          "line_end": 466,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].confirmTime = _confirmTime",
          "line_start": 467,
          "line_end": 467,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].LCopenTimeout = now + _confirmTime",
          "line_start": 470,
          "line_end": 470,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].initialDeposit = _balances",
          "line_start": 471,
          "line_end": 471,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 19,
      "check": "tautology",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "integer_issues",
      "description": "ECTools.substring(string,uint256,uint256) (samples/ds/tier2/contracts/ds_t2_024.sol#181-196) contains a tautology or contradiction:\n\t- require(bool)(_startIndex >= 0) (samples/ds/tier2/contracts/ds_t2_024.sol#188)\n",
      "elements": [
        {
          "type": "function",
          "name": "substring",
          "line_start": 181,
          "line_end": 196,
          "contract": "ECTools"
        },
        {
          "type": "node",
          "name": "require(bool)(_startIndex >= 0)",
          "line_start": 188,
          "line_end": 188,
          "function": "substring(string,uint256,uint256)",
          "contract": "ECTools"
        }
      ]
    },
    {
      "original_index": 20,
      "check": "tautology",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "integer_issues",
      "description": "LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482) contains a tautology or contradiction:\n\t- require(bool,string)(_balances[0] >= 0 && _balances[1] >= 0,Balances cannot be negative) (samples/ds/tier2/contracts/ds_t2_024.sol#435-438)\n",
      "elements": [
        {
          "type": "function",
          "name": "createChannel",
          "line_start": 423,
          "line_end": 482,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(_balances[0] >= 0 && _balances[1] >= 0,Balances cannot be negative)",
          "line_start": 435,
          "line_end": 438,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 21,
      "check": "reentrancy-benign",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#665-671)\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#672-678)\n\tExternal calls sending eth:\n\t- Channels[_lcID].partyAddresses[0].transfer(_balances[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#660)\n\t- Channels[_lcID].partyAddresses[1].transfer(_balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#661)\n\tState variables written after the call(s):\n\t- numChannels -- (samples/ds/tier2/contracts/ds_t2_024.sol#681)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure)",
          "line_start": 665,
          "line_end": 671,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure)",
          "line_start": 672,
          "line_end": 678,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure)",
          "line_start": 665,
          "line_end": 671,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure)",
          "line_start": 672,
          "line_end": 678,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "numChannels --",
          "line_start": 681,
          "line_end": 681,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 22,
      "check": "reentrancy-benign",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045):\n\tExternal calls:\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1018-1024)\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1025-1031)\n\tExternal calls sending eth:\n\t- channel.partyAddresses[0].transfer(ethbalanceA) (samples/ds/tier2/contracts/ds_t2_024.sol#1013)\n\t- channel.partyAddresses[1].transfer(ethbalanceI) (samples/ds/tier2/contracts/ds_t2_024.sol#1014)\n\tState variables written after the call(s):\n\t- numChannels -- (samples/ds/tier2/contracts/ds_t2_024.sol#1035)\n",
      "elements": [
        {
          "type": "function",
          "name": "byzantineCloseChannel",
          "line_start": 966,
          "line_end": 1045,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure)",
          "line_start": 1018,
          "line_end": 1024,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure)",
          "line_start": 1025,
          "line_end": 1031,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure)",
          "line_start": 1018,
          "line_end": 1024,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure)",
          "line_start": 1025,
          "line_end": 1031,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "numChannels --",
          "line_start": 1035,
          "line_end": 1035,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 23,
      "check": "reentrancy-benign",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#532-539)\n\tState variables written after the call(s):\n\t- numChannels ++ (samples/ds/tier2/contracts/ds_t2_024.sol#547)\n",
      "elements": [
        {
          "type": "function",
          "name": "joinChannel",
          "line_start": 519,
          "line_end": 550,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure)",
          "line_start": 532,
          "line_end": 539,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure)",
          "line_start": 532,
          "line_end": 539,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "numChannels ++",
          "line_start": 547,
          "line_end": 547,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 24,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#455-462)\n\tEvent emitted after the call(s):\n\t- DidLCOpen(_lcID,msg.sender,_partyI,_balances[0],_token,_balances[1],Channels[_lcID].LCopenTimeout) (samples/ds/tier2/contracts/ds_t2_024.sol#473-481)\n",
      "elements": [
        {
          "type": "function",
          "name": "createChannel",
          "line_start": 423,
          "line_end": 482,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure)",
          "line_start": 455,
          "line_end": 462,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCOpen(_lcID,msg.sender,_partyI,_balances[0],_token,_balances[1],Channels[_lcID].LCopenTimeout)",
          "line_start": 473,
          "line_end": 481,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 25,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045):\n\tExternal calls:\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1018-1024)\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1025-1031)\n\tExternal calls sending eth:\n\t- channel.partyAddresses[0].transfer(ethbalanceA) (samples/ds/tier2/contracts/ds_t2_024.sol#1013)\n\t- channel.partyAddresses[1].transfer(ethbalanceI) (samples/ds/tier2/contracts/ds_t2_024.sol#1014)\n\tEvent emitted after the call(s):\n\t- DidLCClose(_lcID,channel.sequence,ethbalanceA,ethbalanceI,tokenbalanceA,tokenbalanceI) (samples/ds/tier2/contracts/ds_t2_024.sol#1037-1044)\n",
      "elements": [
        {
          "type": "function",
          "name": "byzantineCloseChannel",
          "line_start": 966,
          "line_end": 1045,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure)",
          "line_start": 1018,
          "line_end": 1024,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure)",
          "line_start": 1025,
          "line_end": 1031,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "channel.partyAddresses[0].transfer(ethbalanceA)",
          "line_start": 1013,
          "line_end": 1013,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "channel.partyAddresses[1].transfer(ethbalanceI)",
          "line_start": 1014,
          "line_end": 1014,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCClose(_lcID,channel.sequence,ethbalanceA,ethbalanceI,tokenbalanceA,tokenbalanceI)",
          "line_start": 1037,
          "line_end": 1044,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 26,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#665-671)\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#672-678)\n\tExternal calls sending eth:\n\t- Channels[_lcID].partyAddresses[0].transfer(_balances[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#660)\n\t- Channels[_lcID].partyAddresses[1].transfer(_balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#661)\n\tEvent emitted after the call(s):\n\t- DidLCClose(_lcID,_sequence,_balances[0],_balances[1],_balances[2],_balances[3]) (samples/ds/tier2/contracts/ds_t2_024.sol#683-690)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure)",
          "line_start": 665,
          "line_end": 671,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure)",
          "line_start": 672,
          "line_end": 678,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[0].transfer(_balances[0])",
          "line_start": 660,
          "line_end": 660,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[1].transfer(_balances[1])",
          "line_start": 661,
          "line_end": 661,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCClose(_lcID,_sequence,_balances[0],_balances[1],_balances[2],_balances[3])",
          "line_start": 683,
          "line_end": 690,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 27,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#572-579)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#592-599)\n\tEvent emitted after the call(s):\n\t- DidLCDeposit(_lcID,recipient,_balance,isToken) (samples/ds/tier2/contracts/ds_t2_024.sol#610)\n",
      "elements": [
        {
          "type": "function",
          "name": "deposit",
          "line_start": 553,
          "line_end": 611,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 572,
          "line_end": 579,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 592,
          "line_end": 599,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCDeposit(_lcID,recipient,_balance,isToken)",
          "line_start": 610,
          "line_end": 610,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 28,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#497-503)\n\tExternal calls sending eth:\n\t- Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#492-494)\n\tEvent emitted after the call(s):\n\t- DidLCClose(_lcID,0,Channels[_lcID].ethBalances[0],Channels[_lcID].erc20Balances[0],0,0) (samples/ds/tier2/contracts/ds_t2_024.sol#506-513)\n",
      "elements": [
        {
          "type": "function",
          "name": "LCOpenTimeout",
          "line_start": 484,
          "line_end": 517,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure)",
          "line_start": 497,
          "line_end": 503,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[0].transfer(Channels[_lcID].ethBalances[0])",
          "line_start": 492,
          "line_end": 494,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCClose(_lcID,0,Channels[_lcID].ethBalances[0],Channels[_lcID].erc20Balances[0],0,0)",
          "line_start": 506,
          "line_end": 513,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 29,
      "check": "reentrancy-events",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "reentrancy",
      "description": "Reentrancy in LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550):\n\tExternal calls:\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#532-539)\n\tEvent emitted after the call(s):\n\t- DidLCJoin(_lcID,_balances[0],_balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#549)\n",
      "elements": [
        {
          "type": "function",
          "name": "joinChannel",
          "line_start": 519,
          "line_end": 550,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure)",
          "line_start": 532,
          "line_end": 539,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "DidLCJoin(_lcID,_balances[0],_balances[1])",
          "line_start": 549,
          "line_end": 549,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 30,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel._isContained(bytes32,bytes,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#1047-1068) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- cursor == _root (samples/ds/tier2/contracts/ds_t2_024.sol#1067)\n",
      "elements": [
        {
          "type": "function",
          "name": "_isContained",
          "line_start": 1047,
          "line_end": 1068,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "cursor == _root",
          "line_start": 1067,
          "line_end": 1067,
          "function": "_isContained(bytes32,bytes,bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 31,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#768-832) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(Channels[_lcID].isOpen,LC is closed.) (samples/ds/tier2/contracts/ds_t2_024.sol#778)\n\t- require(bool,string)(Channels[_lcID].updateLCtimeout < now,LC timeout not over.) (samples/ds/tier2/contracts/ds_t2_024.sol#782)\n\t- require(bool)(_isContained(_initState,_proof,Channels[_lcID].VCrootHash) == true) (samples/ds/tier2/contracts/ds_t2_024.sol#805-807)\n",
      "elements": [
        {
          "type": "function",
          "name": "initVCstate",
          "line_start": 768,
          "line_end": 832,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].isOpen,LC is closed.)",
          "line_start": 778,
          "line_end": 778,
          "function": "initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].updateLCtimeout < now,LC timeout not over.)",
          "line_start": 782,
          "line_end": 782,
          "function": "initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(_isContained(_initState,_proof,Channels[_lcID].VCrootHash) == true)",
          "line_start": 805,
          "line_end": 807,
          "function": "initVCstate(bytes32,bytes32,bytes,address,address,uint256[2],uint256[4],string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 32,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.createChannel(bytes32,address,uint256,address,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#423-482) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(Channels[_lcID].partyAddresses[0] == address(0),Channel has already been created.) (samples/ds/tier2/contracts/ds_t2_024.sol#430-433)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#455-462)\n",
      "elements": [
        {
          "type": "function",
          "name": "createChannel",
          "line_start": 423,
          "line_end": 482,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].partyAddresses[0] == address(0),Channel has already been created.)",
          "line_start": 430,
          "line_end": 433,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),CreateChannel: token transfer failure)",
          "line_start": 455,
          "line_end": 462,
          "function": "createChannel(bytes32,address,uint256,address,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 33,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.closeVirtualChannel(bytes32,bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#914-964) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(Channels[_lcID].isOpen,LC is closed.) (samples/ds/tier2/contracts/ds_t2_024.sol#916)\n\t- require(bool,string)(virtualChannels[_vcID].updateVCtimeout < now,Update vc timeout has not elapsed.) (samples/ds/tier2/contracts/ds_t2_024.sol#921-924)\n\t- virtualChannels[_vcID].partyA == Channels[_lcID].partyAddresses[0] (samples/ds/tier2/contracts/ds_t2_024.sol#933)\n\t- virtualChannels[_vcID].partyB == Channels[_lcID].partyAddresses[0] (samples/ds/tier2/contracts/ds_t2_024.sol#945)\n",
      "elements": [
        {
          "type": "function",
          "name": "closeVirtualChannel",
          "line_start": 914,
          "line_end": 964,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].isOpen,LC is closed.)",
          "line_start": 916,
          "line_end": 916,
          "function": "closeVirtualChannel(bytes32,bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(virtualChannels[_vcID].updateVCtimeout < now,Update vc timeout has not elapsed.)",
          "line_start": 921,
          "line_end": 924,
          "function": "closeVirtualChannel(bytes32,bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "virtualChannels[_vcID].partyA == Channels[_lcID].partyAddresses[0]",
          "line_start": 933,
          "line_end": 933,
          "function": "closeVirtualChannel(bytes32,bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "virtualChannels[_vcID].partyB == Channels[_lcID].partyAddresses[0]",
          "line_start": 945,
          "line_end": 945,
          "function": "closeVirtualChannel(bytes32,bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 34,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.joinChannel(bytes32,uint256[2]) (samples/ds/tier2/contracts/ds_t2_024.sol#519-550) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(Channels[_lcID].isOpen == false) (samples/ds/tier2/contracts/ds_t2_024.sol#521)\n\t- require(bool)(msg.sender == Channels[_lcID].partyAddresses[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#522)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#532-539)\n",
      "elements": [
        {
          "type": "function",
          "name": "joinChannel",
          "line_start": 519,
          "line_end": 550,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].isOpen == false)",
          "line_start": 521,
          "line_end": 521,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(msg.sender == Channels[_lcID].partyAddresses[1])",
          "line_start": 522,
          "line_end": 522,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balances[1]),joinChannel: token transfer failure)",
          "line_start": 532,
          "line_end": 539,
          "function": "joinChannel(bytes32,uint256[2])",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 35,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.LCOpenTimeout(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#484-517) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false) (samples/ds/tier2/contracts/ds_t2_024.sol#485-488)\n\t- require(bool)(now > Channels[_lcID].LCopenTimeout) (samples/ds/tier2/contracts/ds_t2_024.sol#489)\n\t- Channels[_lcID].initialDeposit[0] != 0 (samples/ds/tier2/contracts/ds_t2_024.sol#491)\n\t- Channels[_lcID].initialDeposit[1] != 0 (samples/ds/tier2/contracts/ds_t2_024.sol#496)\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#497-503)\n",
      "elements": [
        {
          "type": "function",
          "name": "LCOpenTimeout",
          "line_start": 484,
          "line_end": 517,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(msg.sender == Channels[_lcID].partyAddresses[0] && Channels[_lcID].isOpen == false)",
          "line_start": 485,
          "line_end": 488,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(now > Channels[_lcID].LCopenTimeout)",
          "line_start": 489,
          "line_end": 489,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].initialDeposit[0] != 0",
          "line_start": 491,
          "line_end": 491,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].initialDeposit[1] != 0",
          "line_start": 496,
          "line_end": 496,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],Channels[_lcID].erc20Balances[0]),CreateChannel: token transfer failure)",
          "line_start": 497,
          "line_end": 503,
          "function": "LCOpenTimeout(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 36,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.consensusCloseChannel(bytes32,uint256,uint256[4],string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#613-691) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(Channels[_lcID].isOpen == true) (samples/ds/tier2/contracts/ds_t2_024.sol#622)\n\t- require(bool)(totalEthDeposit == _balances[0] + _balances[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#629)\n\t- require(bool)(totalTokenDeposit == _balances[2] + _balances[3]) (samples/ds/tier2/contracts/ds_t2_024.sol#630)\n\t- require(bool)(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state,_sigA)) (samples/ds/tier2/contracts/ds_t2_024.sol#648-651)\n\t- require(bool)(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state,_sigI)) (samples/ds/tier2/contracts/ds_t2_024.sol#652-655)\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#665-671)\n\t- require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#672-678)\n",
      "elements": [
        {
          "type": "function",
          "name": "consensusCloseChannel",
          "line_start": 613,
          "line_end": 691,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].isOpen == true)",
          "line_start": 622,
          "line_end": 622,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(totalEthDeposit == _balances[0] + _balances[1])",
          "line_start": 629,
          "line_end": 629,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(totalTokenDeposit == _balances[2] + _balances[3])",
          "line_start": 630,
          "line_end": 630,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].partyAddresses[0] == ECTools.recoverSigner(_state,_sigA))",
          "line_start": 648,
          "line_end": 651,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].partyAddresses[1] == ECTools.recoverSigner(_state,_sigI))",
          "line_start": 652,
          "line_end": 655,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[0],_balances[2]),happyCloseChannel: token transfer failure)",
          "line_start": 665,
          "line_end": 671,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transfer(Channels[_lcID].partyAddresses[1],_balances[3]),happyCloseChannel: token transfer failure)",
          "line_start": 672,
          "line_end": 678,
          "function": "consensusCloseChannel(bytes32,uint256,uint256[4],string,string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 37,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.byzantineCloseChannel(bytes32) (samples/ds/tier2/contracts/ds_t2_024.sol#966-1045) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(channel.isOpen,Channel is not open) (samples/ds/tier2/contracts/ds_t2_024.sol#970)\n\t- require(bool)(channel.isUpdateLCSettling == true) (samples/ds/tier2/contracts/ds_t2_024.sol#971)\n\t- require(bool)(channel.numOpenVC == 0) (samples/ds/tier2/contracts/ds_t2_024.sol#972)\n\t- require(bool,string)(channel.updateLCtimeout < now,LC timeout over.) (samples/ds/tier2/contracts/ds_t2_024.sol#973)\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1018-1024)\n\t- require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#1025-1031)\n",
      "elements": [
        {
          "type": "function",
          "name": "byzantineCloseChannel",
          "line_start": 966,
          "line_end": 1045,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.isOpen,Channel is not open)",
          "line_start": 970,
          "line_end": 970,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.isUpdateLCSettling == true)",
          "line_start": 971,
          "line_end": 971,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.numOpenVC == 0)",
          "line_start": 972,
          "line_end": 972,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.updateLCtimeout < now,LC timeout over.)",
          "line_start": 973,
          "line_end": 973,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[0],tokenbalanceA),byzantineCloseChannel: token transfer failure)",
          "line_start": 1018,
          "line_end": 1024,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(channel.token.transfer(channel.partyAddresses[1],tokenbalanceI),byzantineCloseChannel: token transfer failure)",
          "line_start": 1025,
          "line_end": 1031,
          "function": "byzantineCloseChannel(bytes32)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 38,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string) (samples/ds/tier2/contracts/ds_t2_024.sol#835-912) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(Channels[_lcID].isOpen,LC is closed.) (samples/ds/tier2/contracts/ds_t2_024.sol#844)\n\t- require(bool)(Channels[_lcID].updateLCtimeout < now) (samples/ds/tier2/contracts/ds_t2_024.sol#865)\n",
      "elements": [
        {
          "type": "function",
          "name": "settleVC",
          "line_start": 835,
          "line_end": 912,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].isOpen,LC is closed.)",
          "line_start": 844,
          "line_end": 844,
          "function": "settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(Channels[_lcID].updateLCtimeout < now)",
          "line_start": 865,
          "line_end": 865,
          "function": "settleVC(bytes32,bytes32,uint256,address,address,uint256[4],string)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 39,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.deposit(bytes32,address,uint256,bool) (samples/ds/tier2/contracts/ds_t2_024.sol#553-611) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(Channels[_lcID].isOpen == true,Tried adding funds to a closed channel) (samples/ds/tier2/contracts/ds_t2_024.sol#559-562)\n\t- require(bool)(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1]) (samples/ds/tier2/contracts/ds_t2_024.sol#563-566)\n\t- Channels[_lcID].partyAddresses[0] == recipient (samples/ds/tier2/contracts/ds_t2_024.sol#570)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#572-579)\n\t- Channels[_lcID].partyAddresses[1] == recipient (samples/ds/tier2/contracts/ds_t2_024.sol#590)\n\t- require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure) (samples/ds/tier2/contracts/ds_t2_024.sol#592-599)\n",
      "elements": [
        {
          "type": "function",
          "name": "deposit",
          "line_start": 553,
          "line_end": 611,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].isOpen == true,Tried adding funds to a closed channel)",
          "line_start": 559,
          "line_end": 562,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(recipient == Channels[_lcID].partyAddresses[0] || recipient == Channels[_lcID].partyAddresses[1])",
          "line_start": 563,
          "line_end": 566,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[0] == recipient",
          "line_start": 570,
          "line_end": 570,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 572,
          "line_end": 579,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "Channels[_lcID].partyAddresses[1] == recipient",
          "line_start": 590,
          "line_end": 590,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool,string)(Channels[_lcID].token.transferFrom(msg.sender,this,_balance),deposit: token transfer failure)",
          "line_start": 592,
          "line_end": 599,
          "function": "deposit(bytes32,address,uint256,bool)",
          "contract": "LedgerChannel"
        }
      ]
    },
    {
      "original_index": 40,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "LedgerChannel.updateLCstate(bytes32,uint256[6],bytes32,string,string) (samples/ds/tier2/contracts/ds_t2_024.sol#695-765) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool)(channel.isOpen) (samples/ds/tier2/contracts/ds_t2_024.sol#703)\n\t- require(bool)(channel.sequence < updateParams[0]) (samples/ds/tier2/contracts/ds_t2_024.sol#704)\n\t- require(bool)(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3]) (samples/ds/tier2/contracts/ds_t2_024.sol#705-708)\n\t- require(bool)(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5]) (samples/ds/tier2/contracts/ds_t2_024.sol#709-712)\n\t- require(bool)(channel.updateLCtimeout > now) (samples/ds/tier2/contracts/ds_t2_024.sol#715)\n\t- require(bool)(channel.partyAddresses[0] == ECTools.recoverSigner(_state,_sigA)) (samples/ds/tier2/contracts/ds_t2_024.sol#734-736)\n\t- require(bool)(channel.partyAddresses[1] == ECTools.recoverSigner(_state,_sigI)) (samples/ds/tier2/contracts/ds_t2_024.sol#737-739)\n",
      "elements": [
        {
          "type": "function",
          "name": "updateLCstate",
          "line_start": 695,
          "line_end": 765,
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.isOpen)",
          "line_start": 703,
          "line_end": 703,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.sequence < updateParams[0])",
          "line_start": 704,
          "line_end": 704,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.ethBalances[0] + channel.ethBalances[1] >= updateParams[2] + updateParams[3])",
          "line_start": 705,
          "line_end": 708,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.erc20Balances[0] + channel.erc20Balances[1] >= updateParams[4] + updateParams[5])",
          "line_start": 709,
          "line_end": 712,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.updateLCtimeout > now)",
          "line_start": 715,
          "line_end": 715,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.partyAddresses[0] == ECTools.recoverSigner(_state,_sigA))",
          "line_start": 734,
          "line_end": 736,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        },
        {
          "type": "node",
          "name": "require(bool)(channel.partyAddresses[1] == ECTools.recoverSigner(_state,_sigI))",
          "line_start": 737,
          "line_end": 739,
          "function": "updateLCstate(bytes32,uint256[6],bytes32,string,string)",
          "contract": "LedgerChannel"
        }
      ]
    }
  ]
}