{
  "sample_id": "ds_t2_029",
  "tier": "tier2",
  "tool": "slither",
  "tool_version": "0.11.3",
  "solc_version": "0.4.19",
  "timestamp": "2026-01-03T21:20:04.025419",
  "success": true,
  "error": null,
  "execution_time_ms": 697.8170871734619,
  "processing": {
    "processed_at": "2026-01-04T12:56:07.061233",
    "original_finding_count": 23,
    "filtered_finding_count": 15,
    "filter_breakdown": {
      "kept_high_medium": 11,
      "kept_low_mapped": 4,
      "filtered_excluded": 7,
      "filtered_low_unmapped": 0,
      "filtered_informational": 1
    },
    "filters_applied": [
      "High/Medium severity: keep all",
      "Low severity: keep only if mapped to vulnerability type",
      "Informational/Optimization: filter out",
      "Always exclude: 18 detector types"
    ]
  },
  "findings": [
    {
      "original_index": 0,
      "check": "controlled-array-length",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone (samples/ds/tier2/contracts/ds_t2_029.sol#5-150) contract sets array length with a user-controlled value:\n\t- pastMonarchs.push(currentMonarch) (samples/ds/tier2/contracts/ds_t2_029.sol#108)\n",
      "elements": [
        {
          "type": "contract",
          "name": "KingOfTheEtherThrone",
          "line_start": 5,
          "line_end": 150
        },
        {
          "type": "node",
          "name": "pastMonarchs.push(currentMonarch)",
          "line_start": 108,
          "line_end": 108,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 1,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 1000000000000000 * (rawNewClaimPrice / 1000000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#120)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 1000000000000000 * (rawNewClaimPrice / 1000000000000000)",
          "line_start": 120,
          "line_end": 120,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 2,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 10000000000000000 * (rawNewClaimPrice / 10000000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#122)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 10000000000000000 * (rawNewClaimPrice / 10000000000000000)",
          "line_start": 122,
          "line_end": 122,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 3,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 100000000000000 * (rawNewClaimPrice / 100000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#118)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 100000000000000 * (rawNewClaimPrice / 100000000000000)",
          "line_start": 118,
          "line_end": 118,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 4,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 1000000000000000000 * (rawNewClaimPrice / 1000000000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#126)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 1000000000000000000 * (rawNewClaimPrice / 1000000000000000000)",
          "line_start": 126,
          "line_end": 126,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 5,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 10000000000000000000 * (rawNewClaimPrice / 10000000000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#128)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 10000000000000000000 * (rawNewClaimPrice / 10000000000000000000)",
          "line_start": 128,
          "line_end": 128,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 6,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) performs a multiplication on the result of a division:\n\t- currentClaimPrice = 100000000000000000 * (rawNewClaimPrice / 100000000000000000) (samples/ds/tier2/contracts/ds_t2_029.sol#124)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentClaimPrice = 100000000000000000 * (rawNewClaimPrice / 100000000000000000)",
          "line_start": 124,
          "line_end": 124,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 7,
      "check": "unchecked-send",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "unchecked_return",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) ignores return value by msg.sender.send(excessPaid) (samples/ds/tier2/contracts/ds_t2_029.sol#88)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "msg.sender.send(excessPaid)",
          "line_start": 88,
          "line_end": 88,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 8,
      "check": "unchecked-send",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "unchecked_return",
      "description": "KingOfTheEtherThrone.sweepCommission(uint256) (samples/ds/tier2/contracts/ds_t2_029.sol#142-144) ignores return value by wizardAddress.send(amount) (samples/ds/tier2/contracts/ds_t2_029.sol#143)\n",
      "elements": [
        {
          "type": "function",
          "name": "sweepCommission",
          "line_start": 142,
          "line_end": 144,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "wizardAddress.send(amount)",
          "line_start": 143,
          "line_end": 143,
          "function": "sweepCommission(uint256)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 9,
      "check": "unchecked-send",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "unchecked_return",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) ignores return value by msg.sender.send(valuePaid) (samples/ds/tier2/contracts/ds_t2_029.sol#81)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "msg.sender.send(valuePaid)",
          "line_start": 81,
          "line_end": 81,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 10,
      "check": "unchecked-send",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "unchecked_return",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) ignores return value by currentMonarch.etherAddress.send(compensation) (samples/ds/tier2/contracts/ds_t2_029.sol#102)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentMonarch.etherAddress.send(compensation)",
          "line_start": 102,
          "line_end": 102,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 11,
      "check": "events-access",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "KingOfTheEtherThrone.transferOwnership(address) (samples/ds/tier2/contracts/ds_t2_029.sol#147-149) should emit an event for: \n\t- wizardAddress = newOwner (samples/ds/tier2/contracts/ds_t2_029.sol#148) \n",
      "elements": [
        {
          "type": "function",
          "name": "transferOwnership",
          "line_start": 147,
          "line_end": 149,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "wizardAddress = newOwner",
          "line_start": 148,
          "line_end": 148,
          "function": "transferOwnership(address)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 12,
      "check": "missing-zero-check",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "KingOfTheEtherThrone.transferOwnership(address).newOwner (samples/ds/tier2/contracts/ds_t2_029.sol#147) lacks a zero-check on :\n\t\t- wizardAddress = newOwner (samples/ds/tier2/contracts/ds_t2_029.sol#148)\n",
      "elements": [
        {
          "type": "variable",
          "name": "newOwner",
          "line_start": 147,
          "line_end": 147,
          "function": "transferOwnership(address)",
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "wizardAddress = newOwner",
          "line_start": 148,
          "line_end": 148,
          "function": "transferOwnership(address)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 13,
      "check": "incorrect-modifier",
      "impact": "Low",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "Modifier KingOfTheEtherThrone.onlywizard() (samples/ds/tier2/contracts/ds_t2_029.sol#22-24) does not always execute _; or revert\n",
      "elements": [
        {
          "type": "function",
          "name": "onlywizard",
          "line_start": 22,
          "line_end": 24,
          "contract": "KingOfTheEtherThrone"
        }
      ]
    },
    {
      "original_index": 14,
      "check": "timestamp",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "timestamp_dependency",
      "description": "KingOfTheEtherThrone.claimThrone(string) (samples/ds/tier2/contracts/ds_t2_029.sol#76-139) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- currentMonarch.etherAddress != wizardAddress (samples/ds/tier2/contracts/ds_t2_029.sol#101)\n",
      "elements": [
        {
          "type": "function",
          "name": "claimThrone",
          "line_start": 76,
          "line_end": 139,
          "contract": "KingOfTheEtherThrone"
        },
        {
          "type": "node",
          "name": "currentMonarch.etherAddress != wizardAddress",
          "line_start": 101,
          "line_end": 101,
          "function": "claimThrone(string)",
          "contract": "KingOfTheEtherThrone"
        }
      ]
    }
  ]
}