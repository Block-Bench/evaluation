{
  "sample_id": "ds_t4_013",
  "tier": "tier4",
  "tool": "slither",
  "tool_version": "0.11.3",
  "solc_version": "0.4.13",
  "timestamp": "2026-01-04T08:24:34.094503",
  "success": true,
  "error": null,
  "execution_time_ms": 2362.0848655700684,
  "processing": {
    "processed_at": "2026-01-04T12:56:07.392778",
    "original_finding_count": 79,
    "filtered_finding_count": 24,
    "filter_breakdown": {
      "kept_high_medium": 19,
      "kept_low_mapped": 5,
      "filtered_excluded": 51,
      "filtered_low_unmapped": 0,
      "filtered_informational": 4
    },
    "filters_applied": [
      "High/Medium severity: keep all",
      "Low severity: keep only if mapped to vulnerability type",
      "Informational/Optimization: filter out",
      "Always exclude: 18 detector types"
    ]
  },
  "findings": [
    {
      "original_index": 0,
      "check": "controlled-array-length",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) contract sets array length with a user-controlled value:\n\t- dividends.push(0) (samples/ds/tier4/contracts/ds_t4_013.sol#288)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "node",
          "name": "dividends.push(0)",
          "line_start": 288,
          "line_end": 288,
          "function": "houseKeeping()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 1,
      "check": "controlled-array-length",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) contract sets array length with a user-controlled value:\n\t- dividends.push(0) (samples/ds/tier4/contracts/ds_t4_013.sol#180)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "node",
          "name": "dividends.push(0)",
          "line_start": 180,
          "line_end": 180,
          "function": "SmartBillions()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 2,
      "check": "controlled-array-length",
      "impact": "High",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) contract sets array length with a user-controlled value:\n\t- dividends.push(0) (samples/ds/tier4/contracts/ds_t4_013.sol#181)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "node",
          "name": "dividends.push(0)",
          "line_start": 181,
          "line_end": 181,
          "function": "SmartBillions()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 3,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "SmartBillions.commitDividend(address) (samples/ds/tier4/contracts/ds_t4_013.sol#395-414) performs a multiplication on the result of a division:\n\t- share = (balances[_who] * 0xffffffff) / totalSupply (samples/ds/tier4/contracts/ds_t4_013.sol#404)\n\t- balance += share * dividends[last] (samples/ds/tier4/contracts/ds_t4_013.sol#407)\n",
      "elements": [
        {
          "type": "function",
          "name": "commitDividend",
          "line_start": 395,
          "line_end": 414,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "share = (balances[_who] * 0xffffffff) / totalSupply",
          "line_start": 404,
          "line_end": 404,
          "function": "commitDividend(address)",
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "balance += share * dividends[last]",
          "line_start": 407,
          "line_end": 407,
          "function": "commitDividend(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 4,
      "check": "divide-before-multiply",
      "impact": "Medium",
      "confidence": "Medium",
      "mapped_vuln_type": "integer_issues",
      "description": "SmartBillions.invest(address) (samples/ds/tier4/contracts/ds_t4_013.sol#339-376) performs a multiplication on the result of a division:\n\t- walletBalance += ((investing * 5) / 100) * 2 (samples/ds/tier4/contracts/ds_t4_013.sol#360)\n",
      "elements": [
        {
          "type": "function",
          "name": "invest",
          "line_start": 339,
          "line_end": 376,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "walletBalance += ((investing * 5) / 100) * 2",
          "line_start": 360,
          "line_end": 360,
          "function": "invest(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 5,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:ERC20Basic.transfer(address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#24)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "transfer",
          "line_start": 24,
          "line_end": 24,
          "contract": "ERC20Basic"
        }
      ]
    },
    {
      "original_index": 6,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:BasicToken.transfer(address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#50-62)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "transfer",
          "line_start": 50,
          "line_end": 62,
          "contract": "BasicToken"
        }
      ]
    },
    {
      "original_index": 7,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:StandardToken.approve(address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#86-90)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "approve",
          "line_start": 86,
          "line_end": 90,
          "contract": "StandardToken"
        }
      ]
    },
    {
      "original_index": 8,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:ERC20.approve(address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#36)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "approve",
          "line_start": 36,
          "line_end": 36,
          "contract": "ERC20"
        }
      ]
    },
    {
      "original_index": 9,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:StandardToken.transferFrom(address,address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#72-84)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "transferFrom",
          "line_start": 72,
          "line_end": 84,
          "contract": "StandardToken"
        }
      ]
    },
    {
      "original_index": 10,
      "check": "erc20-interface",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "interface_mismatch",
      "description": "SmartBillions (samples/ds/tier4/contracts/ds_t4_013.sol#100-675) has incorrect ERC20 function interface:ERC20.transferFrom(address,address,uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#34)\n",
      "elements": [
        {
          "type": "contract",
          "name": "SmartBillions",
          "line_start": 100,
          "line_end": 675
        },
        {
          "type": "function",
          "name": "transferFrom",
          "line_start": 34,
          "line_end": 34,
          "contract": "ERC20"
        }
      ]
    },
    {
      "original_index": 11,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.betPrize(SmartBillions.Bet,uint24) (samples/ds/tier4/contracts/ds_t4_013.sol#418-447) uses a dangerous strict equality:\n\t- (hit & 0xF00000) == 0 (samples/ds/tier4/contracts/ds_t4_013.sol#425-430)\n",
      "elements": [
        {
          "type": "function",
          "name": "betPrize",
          "line_start": 418,
          "line_end": 447,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "(hit & 0xF00000) == 0",
          "line_start": 425,
          "line_end": 430,
          "function": "betPrize(SmartBillions.Bet,uint24)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 12,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.won() (samples/ds/tier4/contracts/ds_t4_013.sol#474-524) uses a dangerous strict equality:\n\t- player.blockNum == 0 (samples/ds/tier4/contracts/ds_t4_013.sol#476)\n",
      "elements": [
        {
          "type": "function",
          "name": "won",
          "line_start": 474,
          "line_end": 524,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "player.blockNum == 0",
          "line_start": 476,
          "line_end": 476,
          "function": "won()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 13,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.betOf(address) (samples/ds/tier4/contracts/ds_t4_013.sol#449-472) uses a dangerous strict equality:\n\t- (player.value == 0) || (player.blockNum <= 1) || (block.number < player.blockNum) || (block.number >= player.blockNum + (10 * hashesSize)) (samples/ds/tier4/contracts/ds_t4_013.sol#452-455)\n",
      "elements": [
        {
          "type": "function",
          "name": "betOf",
          "line_start": 449,
          "line_end": 472,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "(player.value == 0) || (player.blockNum <= 1) || (block.number < player.blockNum) || (block.number >= player.blockNum + (10 * hashesSize))",
          "line_start": 452,
          "line_end": 455,
          "function": "betOf(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 14,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.betOf(address) (samples/ds/tier4/contracts/ds_t4_013.sol#449-472) uses a dangerous strict equality:\n\t- hash == 0x1000000 (samples/ds/tier4/contracts/ds_t4_013.sol#464)\n",
      "elements": [
        {
          "type": "function",
          "name": "betOf",
          "line_start": 449,
          "line_end": 472,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "hash == 0x1000000",
          "line_start": 464,
          "line_end": 464,
          "function": "betOf(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 15,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.won() (samples/ds/tier4/contracts/ds_t4_013.sol#474-524) uses a dangerous strict equality:\n\t- (player.value == 0) || (player.blockNum == 1) (samples/ds/tier4/contracts/ds_t4_013.sol#481)\n",
      "elements": [
        {
          "type": "function",
          "name": "won",
          "line_start": 474,
          "line_end": 524,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "(player.value == 0) || (player.blockNum == 1)",
          "line_start": 481,
          "line_end": 481,
          "function": "won()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 16,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.addHashes(uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#593-611) uses a dangerous strict equality:\n\t- require(bool)(hashFirst == 0 && _sadd > 0 && _sadd <= hashesSize) (samples/ds/tier4/contracts/ds_t4_013.sol#594)\n",
      "elements": [
        {
          "type": "function",
          "name": "addHashes",
          "line_start": 593,
          "line_end": 611,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "require(bool)(hashFirst == 0 && _sadd > 0 && _sadd <= hashesSize)",
          "line_start": 594,
          "line_end": 594,
          "function": "addHashes(uint256)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 17,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.putHash() (samples/ds/tier4/contracts/ds_t4_013.sol#644-665) uses a dangerous strict equality:\n\t- lastb == 0 || block.number <= lastb + 10 (samples/ds/tier4/contracts/ds_t4_013.sol#646)\n",
      "elements": [
        {
          "type": "function",
          "name": "putHash",
          "line_start": 644,
          "line_end": 665,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "lastb == 0 || block.number <= lastb + 10",
          "line_start": 646,
          "line_end": 646,
          "function": "putHash()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 18,
      "check": "incorrect-equality",
      "impact": "Medium",
      "confidence": "High",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.won() (samples/ds/tier4/contracts/ds_t4_013.sol#474-524) uses a dangerous strict equality:\n\t- hash == 0x1000000 (samples/ds/tier4/contracts/ds_t4_013.sol#501)\n",
      "elements": [
        {
          "type": "function",
          "name": "won",
          "line_start": 474,
          "line_end": 524,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "hash == 0x1000000",
          "line_start": 501,
          "line_end": 501,
          "function": "won()",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 19,
      "check": "shadowing-local",
      "impact": "Low",
      "confidence": "High",
      "mapped_vuln_type": "variable_shadowing",
      "description": "ERC20.allowance(address,address).owner (samples/ds/tier4/contracts/ds_t4_013.sol#32) shadows:\n\t- ERC20Basic.owner (samples/ds/tier4/contracts/ds_t4_013.sol#19) (state variable)\n",
      "elements": [
        {
          "type": "variable",
          "name": "owner",
          "line_start": 32,
          "line_end": 32,
          "function": "allowance(address,address)",
          "contract": "ERC20"
        },
        {
          "type": "variable",
          "name": "owner",
          "line_start": 19,
          "line_end": 19,
          "contract": "ERC20Basic"
        }
      ]
    },
    {
      "original_index": 20,
      "check": "events-access",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.changeOwner(address) (samples/ds/tier4/contracts/ds_t4_013.sol#228-233) should emit an event for: \n\t- owner = _who (samples/ds/tier4/contracts/ds_t4_013.sol#232) \n",
      "elements": [
        {
          "type": "function",
          "name": "changeOwner",
          "line_start": 228,
          "line_end": 233,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "owner = _who",
          "line_start": 232,
          "line_end": 232,
          "function": "changeOwner(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 21,
      "check": "events-access",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.changeAnimator(address) (samples/ds/tier4/contracts/ds_t4_013.sol#235-240) should emit an event for: \n\t- animator = _who (samples/ds/tier4/contracts/ds_t4_013.sol#239) \n",
      "elements": [
        {
          "type": "function",
          "name": "changeAnimator",
          "line_start": 235,
          "line_end": 240,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "animator = _who",
          "line_start": 239,
          "line_end": 239,
          "function": "changeAnimator(address)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 22,
      "check": "events-maths",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.setBetMax(uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#247-249) should emit an event for: \n\t- hashBetMax = _maxsum (samples/ds/tier4/contracts/ds_t4_013.sol#248) \n",
      "elements": [
        {
          "type": "function",
          "name": "setBetMax",
          "line_start": 247,
          "line_end": 249,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "hashBetMax = _maxsum",
          "line_start": 248,
          "line_end": 248,
          "function": "setBetMax(uint256)",
          "contract": "SmartBillions"
        }
      ]
    },
    {
      "original_index": 23,
      "check": "events-maths",
      "impact": "Low",
      "confidence": "Medium",
      "mapped_vuln_type": "logic_error",
      "description": "SmartBillions.setInvestStart(uint256) (samples/ds/tier4/contracts/ds_t4_013.sol#242-245) should emit an event for: \n\t- investStart = _when (samples/ds/tier4/contracts/ds_t4_013.sol#244) \n",
      "elements": [
        {
          "type": "function",
          "name": "setInvestStart",
          "line_start": 242,
          "line_end": 245,
          "contract": "SmartBillions"
        },
        {
          "type": "node",
          "name": "investStart = _when",
          "line_start": 244,
          "line_end": 244,
          "function": "setInvestStart(uint256)",
          "contract": "SmartBillions"
        }
      ]
    }
  ]
}