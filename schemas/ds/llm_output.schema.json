{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "llm_output.schema.json",
  "title": "DS LLM Output",
  "description": "Schema for raw LLM response when analyzing DS samples for vulnerabilities.",
  "type": "object",
  "required": ["verdict", "vulnerabilities"],
  "properties": {
    "verdict": {
      "type": "string",
      "enum": ["vulnerable", "safe"],
      "description": "Overall assessment of whether the contract is vulnerable or safe."
    },
    "confidence": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Model's confidence in its verdict (0.0 to 1.0)."
    },
    "vulnerabilities": {
      "type": "array",
      "description": "List of detected vulnerabilities. Empty array if verdict is 'safe'.",
      "items": {
        "type": "object",
        "required": ["type", "explanation"],
        "properties": {
          "type": {
            "type": "string",
            "description": "Vulnerability category (e.g., reentrancy, access_control, weak_randomness)."
          },
          "severity": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"],
            "description": "Severity level of the vulnerability."
          },
          "location": {
            "type": "string",
            "description": "Function name or code location where vulnerability exists."
          },
          "explanation": {
            "type": "string",
            "description": "Explanation of the vulnerability and why it is exploitable."
          },
          "attack_scenario": {
            "type": "string",
            "description": "Specific steps an attacker could take to exploit this vulnerability."
          },
          "suggested_fix": {
            "type": "string",
            "description": "Recommended code changes to remediate the vulnerability."
          }
        }
      }
    },
    "overall_explanation": {
      "type": "string",
      "description": "Summary of the overall security analysis."
    }
  },
  "additionalProperties": false
}
