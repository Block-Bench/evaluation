{
  "sample_id": "tr_tc_033",
  "exploit_name": "Prisma Finance Delegate Approval",
  "date": "",
  "amount_lost_usd": "",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "",
  "severity": "critical",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Prisma Finance suffered a $10M exploit through its MigrateTroveZap contract which accepted user-controlled account parameters. Attackers exploited delegate approvals to open troves and mint debt tokens on behalf of victims who had approved the zap contract, then received the minted tokens themselves.",
  "vulnerable_contract": "MigrateTroveZap",
  "vulnerable_function": "openTroveAndMigrate",
  "vulnerable_lines": [
    79,
    87
  ],
  "attack_scenario": "",
  "root_cause": "",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "cdp",
    "lending",
    "delegate_approval",
    "access_control",
    "migration",
    "zap_contract",
    "authorization_bypass",
    "trojan"
  ],
  "variant_type": "trojan",
  "variant_parent_id": "tc_033",
  "notes": "",
  "contract_file": "contracts/tr_tc_033.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "trojan",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_036.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_036.json",
    "script": "manual",
    "changes": [
      "Removed vulnerability documentation and comments",
      "Added distractor code (fake security metrics, config tracking)",
      "Added suspicious-named variables as red herrings",
      "Preserved original vulnerability",
      "Renamed contracts to generic names"
    ],
    "distractors": {
      "config_variables": 4,
      "score_variables": 25,
      "activity_variables": 0,
      "fake_functions": 2,
      "view_helpers": 4,
      "suspicious_names": 0
    },
    "contracts_renamed": [
      "MigrateTroveZap",
      "BorrowerOperations"
    ],
    "vulnerability_preserved": true,
    "documentation_removed": true,
    "created_date": "2025-12-30T01:40:33.673604",
    "sanitized": true,
    "sanitization_date": "2026-01-02T02:10:09.924295",
    "code_renames": {}
  }
}