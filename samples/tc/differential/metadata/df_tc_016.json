{
  "sample_id": "df_tc_016",
  "exploit_name": "Qubit Bridge Zero Address Bypass",
  "date": "2022-01-27",
  "amount_lost_usd": "80000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "validation_bypass",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": false,
  "temporal_category": "pre_cutoff",
  "description": "Fixed version with minimal changes to address the vulnerability",
  "vulnerable_contract": "CrossChainBridge",
  "vulnerable_function": "deposit",
  "vulnerable_lines": [],
  "attack_scenario": "1) Attacker identified or created a resourceID that mapped to address(0) in the bridge handler. 2) Called deposit() with this resourceID and large amount. 3) Handler attempted transferFrom on address(0), which succeeded without transferring anything. 4) Bridge emitted deposit event. 5) BSC handler received event and minted tokens to attacker. 6) Attacker repeated the exploit multiple times to extract $80M worth of tokens without providing any real collateral.",
  "root_cause": "The bridge handler did not validate that the token contract address was not zero. Calls to address(0) do not revert in the EVM, so the transferFrom call succeeded silently without moving any tokens. However, the deposit event was still emitted, causing the destination chain to mint unbacked tokens.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "validation",
    "zero_address",
    "cross_chain",
    "access_control",
    "ethereum",
    "bsc",
    "differential",
    "fixed"
  ],
  "variant_type": "differential",
  "variant_parent_id": "tc_016",
  "notes": "",
  "contract_file": "contracts/df_tc_016.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "differential",
    "strategy": "minimal_fix",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_016.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_016.json",
    "pair_metadata": "/Users/poamen/projects/grace/blockbench/base/data/manual_strategies/differential/metadata/df_pair_tc_016.json",
    "script": "manual",
    "is_fixed_version": true,
    "fix_type": "minimal_fix",
    "fix_description": "Minimal fix with 5 lines changed. Added: require(tokenContract != address(0), \"Invalid token\");; bool success = IERC20(tokenContract).transferFrom(depositer, address(this), amount);; require(success, \"Transfer failed\");",
    "exact_changes": [
      {
        "location": "Added line",
        "version_a": "require(tokenContract != address(0), \"Invalid token\");",
        "version_b": "// Not present in vulnerable version"
      },
      {
        "location": "Added line",
        "version_a": "bool success = IERC20(tokenContract).transferFrom(depositer, address(this), amount);",
        "version_b": "// Not present in vulnerable version"
      },
      {
        "location": "Added line",
        "version_a": "require(success, \"Transfer failed\");",
        "version_b": "// Not present in vulnerable version"
      },
      {
        "location": "Added line",
        "version_a": "require(tokenAddress != address(0), \"Invalid token\");",
        "version_b": "// Not present in vulnerable version"
      }
    ],
    "why_fix_works": "",
    "contracts_in_file": [
      "CrossChainBridge",
      "BridgeHandler"
    ],
    "created_date": "2025-12-30T02:02:17.934529"
  }
}
