{
  "sample_id": "df_tc_018",
  "exploit_name": "DODO Reinitialization",
  "date": "2021-03-09",
  "amount_lost_usd": "3800000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "reinitialization",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": false,
  "temporal_category": "pre_cutoff",
  "description": "Fixed version with minimal changes to address the vulnerability",
  "vulnerable_contract": "LiquidityPool",
  "vulnerable_function": "init",
  "vulnerable_lines": [],
  "attack_scenario": "1) Attacker identified DODO pool contracts without proper initialization locks. 2) Called init() with attacker-controlled parameters, setting maintainer address to attacker. 3) Since maintainer receives all swap fees, attacker could claim accumulated fees via claimFees(). 4) All future swap fees also redirected to attacker. 5) In some cases, could manipulate baseBalance/quoteBalance for profitable swaps. 6) Drained $3.8M from affected pools.",
  "root_cause": "The init() function lacked proper initialization protection (missing `require(!isInitialized)` check). This allowed attackers to call the initialization function again after deployment, overwriting critical parameters like the maintainer address and hijacking fee collection rights.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "initialization",
    "access_control",
    "dodo",
    "defi",
    "amm",
    "maintainer_hijack",
    "differential",
    "fixed"
  ],
  "variant_type": "differential",
  "variant_parent_id": "tc_018",
  "notes": "",
  "contract_file": "contracts/df_tc_018.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "differential",
    "strategy": "minimal_fix",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_018.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_018.json",
    "pair_metadata": "/Users/poamen/projects/grace/blockbench/base/data/manual_strategies/differential/metadata/df_pair_tc_018.json",
    "script": "manual",
    "is_fixed_version": true,
    "fix_type": "minimal_fix",
    "fix_description": "Minimal fix with 2 lines changed. Added: require(!isInitialized, \"Already initialized\");",
    "exact_changes": [
      {
        "location": "Added line",
        "version_a": "require(!isInitialized, \"Already initialized\");",
        "version_b": "// Not present in vulnerable version"
      }
    ],
    "why_fix_works": "",
    "contracts_in_file": [
      "LiquidityPool"
    ],
    "created_date": "2025-12-30T02:02:17.935692"
  }
}
