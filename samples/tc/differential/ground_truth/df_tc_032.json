{
  "is_vulnerable": false,
  "vulnerability_type": "arithmetic_error",
  "vulnerable_functions": [
    "depositExactAmount",
    "withdrawExactShares",
    "withdrawExactAmount"
  ],
  "severity": "high",
  "description": "Fixed version with minimal changes to address the vulnerability",
  "root_cause": "Integer division rounding errors with manipulable pool state ratios\n\nKey Weaknesses: No minimum pool size enforcement; Unbounded share:pool ratio manipulation; Integer division without rounding protection",
  "attack_scenario": "Manipulate pool to extreme share:pool ratio, then exploit rounding in deposit/withdrawal calculations\n\nAttack Flow: Create position NFT and make small initial deposits \u2192 Withdraw most shares to manipulate pool state to extreme ratio \u2192 Set pseudoTotalPool = 2 wei, totalDepositShares = 1 wei (2:1 ratio) \u2192 Transfer manipulated position NFT to exploit contract \u2192 Deposit large amount (520 Pendle LP tokens) into Wise Lending \u2192 Share calculation rounds down: 520 tokens \u2192 260 shares (should be 520) \u2192 Immediately withdraw: 260 shares \u00d7 (2/1 ratio) \u2192 520+ tokens back \u2192 Repeat exploit with helper contracts to compound effect \u2192 Each iteration extracts value through rounding asymmetry \u2192 Extract total profit of $460K through repeated cycles",
  "fix_description": "Enforce minimum pool size (e.g., 1e18 wei minimum pseudoTotalPool); Add invariant checks: withdrawAmount must not exceed depositAmount per user; Implement bounds checking on share:pool ratio (e.g., max 1000:1)",
  "language": "solidity",
  "vulnerable_lines": [],
  "sub_category": ""
}