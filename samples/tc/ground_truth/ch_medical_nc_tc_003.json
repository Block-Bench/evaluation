{
  "id": "ch_medical_nc_tc_003",
  "contract_file": "contracts/ch_medical_nc_tc_003.sol",
  "subset": "chameleon_medical",
  "ground_truth": {
    "is_vulnerable": true,
    "vulnerability_type": "access_control",
    "severity": "critical",
    "vulnerable_location": {
      "contract_name": "WalletLibrary",
      "function_name": "initializesystemWallet",
      "line_numbers": [
        27,
        28,
        29,
        30,
        31,
        38,
        39,
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        49,
        50,
        66,
        67,
        71
      ]
    },
    "root_cause": "The library contract's initWallet() function had no access control preventing direct calls. In the proxy pattern, libraries should never have initialization functions that can be called directly. Combined with a kill() function containing selfdestruct, this allowed anyone to destroy the shared library that all wallets depended on.",
    "attack_vector": "User calls initWallet() directly on the WalletLibrary contract (not via delegatecall from a proxy), becoming the owner of the library itself. User then calls kill() function which executes selfdestruct, destroying the library contract. All 587 wallet proxies that delegatecall to this library are now permanently frozen with no way to access funds.",
    "impact": "Funds lost: $150,000,000",
    "correct_fix": "Library contracts should not have initialization functions callable directly (only via delegatecall). Remove selfdestruct from library contracts entirely. Use Solidity's 'library' keyword instead of 'contract' for shared logic. Add explicit access controls checking deployment context. Use modern upgradeable proxy patterns (EIP-1967) with proper initialization guards. Separate proxy storage from library logic clearly."
  },
  "provenance": {
    "source": "rekt_news",
    "original_id": "temporal_parity_001",
    "url": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2017-11/Parity_kill_exp.sol",
    "date_discovered": "2017-11-06",
    "date_added": "2025-12-16",
    "added_by": "benchmark_team"
  },
  "code_metadata": {
    "solidity_version": "^0.8.0",
    "num_lines": 118,
    "num_contracts": 4,
    "contract_names": [
      "for",
      "WalletLibrary",
      "that",
      "WalletProxy"
    ],
    "num_functions": 0,
    "has_imports": false,
    "imports": [],
    "has_inheritance": false,
    "inherits_from": [],
    "has_modifiers": false,
    "has_events": true,
    "has_assembly": false,
    "compilation_verified": false,
    "compiler_version_used": null
  },
  "tags": [
    "delegatecall",
    "selfdestruct",
    "proxy_pattern",
    "library",
    "initialization",
    "access_control",
    "historical"
  ],
  "notes": "Historic Ethereum bug from 2017. Funds remain frozen to this day. Triggered accidentally by a user testing functions, not by a malicious attacker. Demonstrated the extreme danger of selfdestruct in shared library contracts. Led to significant changes in how proxy patterns are implemented.",
  "temporal_fields": {
    "temporal_split": {
      "split": "pre_cutoff",
      "cutoff_date": "2025-03-01",
      "days_from_cutoff": null,
      "model_cutoffs": {
        "claude_sonnet_4": "2025-03-01",
        "gpt4_turbo": "2024-12-01",
        "gpt4o": "2024-10-01"
      }
    },
    "exploit_info": {
      "exploit_date": "2017-11-06",
      "protocol_name": "Parity Wallet",
      "chain": "ethereum",
      "funds_lost_usd": 150000000,
      "rekt_news_url": null,
      "transaction_hash": null,
      "attacker_address": null
    },
    "public_exposure": {
      "news_coverage": true,
      "twitter_viral": true,
      "likely_in_training": true,
      "exposure_notes": "Famous Parity Wallet exploit"
    }
  },
  "evaluation_support": {
    "annotated_contract": "labelled_data/temporal_contamination/contracts/tc_003.sol",
    "detailed_metadata": "labelled_data/temporal_contamination/metadata/tc_003.json",
    "original_exploit_name": "Parity Wallet"
  },
  "original_subset": "temporal_contamination",
  "original_contract_file": "base/contracts/tc_003.sol",
  "sanitized_from": "tc_003",
  "derived_from": "sn_tc_003",
  "original_id": "tc_003",
  "identifier_mappings": {
    "isOwner": "isCustodian",
    "initialized": "systemActivated",
    "OwnerAdded": "CustodianAdded",
    "initWallet": "initializesystemWallet",
    "length": "extent",
    "isOwnerAddress": "isCustodianFacility",
    "kill": "deactivateSystem",
    "sender": "requestor",
    "execute": "implementDecision",
    "value": "measurement",
    "data": "info",
    "success": "improvement",
    "libraryAddress": "libraryWard",
    "result": "outcome"
  },
  "transformation": {
    "strategy": "chameleon",
    "theme": "medical",
    "source": "nocomments",
    "seed": 3505702269,
    "coverage": {
      "total_identifiers": 42,
      "transformed": 14,
      "untransformed": 28,
      "skipped_reserved": 35,
      "skipped_interface": 0,
      "coverage_percent": 33.33,
      "untransformed_details": [
        {
          "name": "WalletLibrary",
          "reason": "no synonym found"
        },
        {
          "name": "owners",
          "reason": "no synonym found"
        },
        {
          "name": "required",
          "reason": "no synonym found"
        },
        {
          "name": "WalletDestroyed",
          "reason": "no synonym found"
        },
        {
          "name": "destroyer",
          "reason": "no synonym found"
        },
        {
          "name": "_owners",
          "reason": "no synonym found"
        },
        {
          "name": "_required",
          "reason": "no synonym found"
        },
        {
          "name": "_daylimit",
          "reason": "no synonym found"
        },
        {
          "name": "Invalid",
          "reason": "no synonym found"
        },
        {
          "name": "Duplicate",
          "reason": "no synonym found"
        },
        {
          "name": "push",
          "reason": "no synonym found"
        },
        {
          "name": "_addr",
          "reason": "no synonym found"
        },
        {
          "name": "_to",
          "reason": "no synonym found"
        },
        {
          "name": "Not",
          "reason": "no synonym found"
        },
        {
          "name": "Execution",
          "reason": "no synonym found"
        },
        {
          "name": "failed",
          "reason": "no synonym found"
        },
        {
          "name": "WalletProxy",
          "reason": "no synonym found"
        },
        {
          "name": "_library",
          "reason": "no synonym found"
        },
        {
          "name": "lib",
          "reason": "no synonym found"
        },
        {
          "name": "calldatacopy",
          "reason": "no synonym found"
        },
        {
          "name": "calldatasize",
          "reason": "no synonym found"
        },
        {
          "name": "let",
          "reason": "no synonym found"
        },
        {
          "name": "gas",
          "reason": "no synonym found"
        },
        {
          "name": "returndatacopy",
          "reason": "no synonym found"
        },
        {
          "name": "returndatasize",
          "reason": "no synonym found"
        },
        {
          "name": "switch",
          "reason": "no synonym found"
        },
        {
          "name": "case",
          "reason": "no synonym found"
        },
        {
          "name": "default",
          "reason": "no synonym found"
        }
      ],
      "meets_threshold": false
    },
    "rename_map": {
      "isOwner": "isCustodian",
      "initialized": "systemActivated",
      "OwnerAdded": "CustodianAdded",
      "initWallet": "initializesystemWallet",
      "length": "extent",
      "isOwnerAddress": "isCustodianFacility",
      "kill": "deactivateSystem",
      "sender": "requestor",
      "execute": "implementDecision",
      "value": "measurement",
      "data": "info",
      "success": "improvement",
      "libraryAddress": "libraryWard",
      "result": "outcome"
    }
  }
}