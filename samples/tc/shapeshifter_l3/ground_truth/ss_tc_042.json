{
  "is_vulnerable": true,
  "vulnerability_type": "reentrancy",
  "vulnerable_functions": [
    "_0x7d6277",
    "_0x7248ad",
    "_0x1045d1"
  ],
  "severity": "critical",
  "description": "Penpie, a Pendle yield optimizer, was exploited for $27M when attackers registered a fake Pendle market and exploited reentrancy in reward claiming. The fake market's claimRewards() callback reentered Penpie to manipulate balances, allowing withdrawal of real assets far exceeding deposits.",
  "root_cause": "Reentrancy vulnerability in claimRewards() combined with insufficient market validation on registration\n\nKey Weaknesses: Missing reentrancy guards; External calls before state updates (CEI violated); No validation markets from official factory",
  "attack_scenario": "Register fake Pendle market, exploit reentrancy during reward claim to inflate balances, withdraw real assets\n\nAttack Flow: Create fake Pendle market contract implementing IPendleMarket \u2192 Fake market's getRewardTokens() returns real Pendle LPTs \u2192 Fake market's claimRewards() triggers reentrancy attack \u2192 Call registerMarket(fakeMarketAddress) on Penpie \u2192 Penpie accepts without validating market origin \u2192 Deposit small amount into fake market via Penpie \u2192 Call Penpie.claimRewards(fakeMarket, attacker) \u2192 Penpie calls fakeMarket.claimRewards(attacker) \u2192 Fake market reenters Penpie.deposit() during callback \u2192 Reentrancy manipulates userBalances before state update \u2192 Internal balance inflated to large amount \u2192 Call withdraw() with inflated balance \u2192 Penpie transfers real Pendle LPTs based on manipulated balance \u2192 Convert Pendle LPTs to ETH via DEX \u2192 Total profit: $27M",
  "fix_description": "Add reentrancy guards (OpenZeppelin ReentrancyGuard); Follow checks-effects-interactions pattern strictly; Update state before making external calls",
  "language": "solidity",
  "vulnerable_lines": [
    26,
    43
  ],
  "sub_category": "fake_market_registration"
}