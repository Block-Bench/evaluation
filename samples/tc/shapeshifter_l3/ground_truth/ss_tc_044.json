{
  "is_vulnerable": true,
  "vulnerability_type": "oracle_manipulation",
  "vulnerable_functions": [
    "_0x477183",
    "_0xd860ea",
    "_0xe5feba",
    "_0x0cce35"
  ],
  "severity": "critical",
  "description": "Sonne Finance, a Compound V2 fork on Optimism, lost $20M through a donation attack on a low-liquidity market. The attacker deposited minimal tokens, donated large amounts directly to inflate the exchange rate, then used the inflated collateral value to borrow assets far exceeding actual collateral.",
  "root_cause": "Exchange rate calculation vulnerable when totalSupply is very small, allowing donation to manipulate underlying/supply ratio\n\nKey Weaknesses: Exchange rate uses balanceOf including donations; No minimum liquidity requirement; Tiny totalSupply allows massive rate manipulation",
  "attack_scenario": "Mint minimal cTokens, donate underlying to contract, exchange rate inflates, use as over-valued collateral\n\nAttack Flow: Sonne deploys new soWETH market with low initial liquidity \u2192 Attacker mints minimal amount: mint(1 wei WETH) \u2192 Receives 1 soWETH token (totalSupply: 1, underlying: 1) \u2192 Attacker donates: WETH.transfer(soWETH_contract, 200 WETH) \u2192 Exchange rate inflates: (200e18 + 1) / 1 = 200e18 (should be 1e18) \u2192 Attacker's 1 soWETH now valued at 200 WETH in collateral calc \u2192 Use inflated collateral to borrow from multiple markets \u2192 Borrow $7M USDC, $5M DAI, $8M WETH against ~$1 real collateral \u2192 Transfer borrowed assets to external wallet \u2192 Abandon manipulated position, total profit: $20M",
  "fix_description": "Burn first 1000 tokens permanently (minimum liquidity lock); Implement virtual reserves (Uniswap V2 style); Add exchange rate sanity checks (max 10% change per block)",
  "language": "solidity",
  "vulnerable_lines": [
    29,
    31
  ],
  "sub_category": "donation_attack"
}