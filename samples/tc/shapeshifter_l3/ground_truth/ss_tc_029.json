{
  "is_vulnerable": true,
  "vulnerability_type": "arithmetic_manipulation",
  "vulnerable_functions": [
    "_0xd6cb4d",
    "_0xae3550",
    "_0x8e6f03",
    "_0xac561e"
  ],
  "severity": "high",
  "description": "Radiant Capital (Aave V2 fork on Arbitrum) was exploited for $4.5M through manipulation of the liquidityIndex via repeated flashloan cycles. The attacker executed 151 nested flashloans to inflate the liquidityIndex to extreme values, causing rounding errors in the rayDiv function that allowed extracting more funds than deposited.",
  "root_cause": "Unbounded liquidityIndex growth combined with fixed-point arithmetic rounding errors\n\nKey Weaknesses: No flashloan recursion limits; Unbounded liquidityIndex growth; Significant rounding errors at extreme values",
  "attack_scenario": "Repeated flashloan deposit/withdrawal cycles to manipulate liquidityIndex, then exploit rounding in withdrawal calculations\n\nAttack Flow: Borrow 3M USDC from Aave V3 via flashloan \u2192 Deposit 2M USDC into Radiant pool, receive rUSDC tokens \u2192 Execute 151 nested Radiant flashloans (2M USDC each) \u2192 In each flashloan callback: deposit borrowed USDC, then immediately withdraw \u2192 Each cycle slightly increases liquidityIndex due to interest calculations \u2192 After 151 iterations, liquidityIndex reaches astronomical value \u2192 Transfer rUSDC to helper contract \u2192 Withdraw USDC: rayDiv rounding errors return more USDC than deserved \u2192 Borrow WETH against manipulated collateral \u2192 Swap tokens and profit $4.5M",
  "fix_description": "Implement reentrancy guards on flashloan functions; Add maximum recursion depth limits for flashloans; Implement bounds checking on liquidityIndex values",
  "language": "solidity",
  "vulnerable_lines": [
    41,
    103
  ],
  "sub_category": "rounding_error"
}