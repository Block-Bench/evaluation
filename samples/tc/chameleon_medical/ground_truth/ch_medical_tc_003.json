{
  "is_vulnerable": true,
  "vulnerability_type": "access_control",
  "vulnerable_functions": [
    "deactivateSystem"
  ],
  "severity": "critical",
  "description": "Parity multi-sig wallet library vulnerability where anyone could call initWallet() on the shared library contract to become owner, then call kill() to selfdestruct it. This permanently froze $150M+ across 587 wallet contracts that relied on the destroyed library. The bug was accidentally triggered by a user, not a malicious attacker.",
  "root_cause": "The library contract's initWallet() function had no access control preventing direct calls. In the proxy pattern, libraries should never have initialization functions that can be called directly. Combined with a kill() function containing selfdestruct, this allowed anyone to destroy the shared library that all wallets depended on.",
  "attack_scenario": "User calls initWallet() directly on the WalletLibrary contract (not via delegatecall from a proxy), becoming the owner of the library itself. User then calls kill() function which executes selfdestruct, destroying the library contract. All 587 wallet proxies that delegatecall to this library are now permanently frozen with no way to access funds.",
  "fix_description": "Library contracts should not have initialization functions callable directly (only via delegatecall). Remove selfdestruct from library contracts entirely. Use Solidity's 'library' keyword instead of 'contract' for shared logic. Add explicit access controls checking deployment context. Use modern upgradeable proxy patterns (EIP-1967) with proper initialization guards. Separate proxy storage from library logic clearly.",
  "language": "solidity"
}