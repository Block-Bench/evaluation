{
  "is_vulnerable": true,
  "vulnerability_type": "price_oracle_manipulation",
  "vulnerable_functions": [
    "deposit"
  ],
  "severity": "",
  "description": "Belt Finance vault strategies used manipulatable price oracles for calculating share values. Attackers flash-loaned to manipulate oracle prices, deposited when price was low (getting more shares), then withdrew after price recovered, extracting more value than deposited.",
  "root_cause": "Vault share pricing relied on oracle that could be manipulated within single transaction. No TWAP or manipulation resistance. Share calculations used instantaneous price values vulnerable to flash loan attacks.",
  "attack_scenario": "1) Flash loan large amounts to manipulate price oracle down. 2) Deposit to vault when price is artificially low. 3) Share calculation: sharesAdded = (amount * totalShares) / (pool * price), so low price = more shares. 4) Release flash loan, price recovers. 5) Withdraw with inflated share count. 6) Withdrawal amount = (shares * pool * price) / totalShares, high price = more tokens. 7) Profit $6.2M from price manipulation cycle.",
  "fix_description": "Use TWAP oracles resistant to single-block manipulation. Implement share price manipulation checks. Add deposit/withdraw delays. Use multiple independent oracle sources. Cap maximum share price changes per block.",
  "language": "solidity",
  "vulnerable_lines": [
    31,
    45
  ],
  "sub_category": ""
}