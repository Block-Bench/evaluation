{
  "is_vulnerable": true,
  "vulnerability_type": "price_manipulation",
  "vulnerable_functions": [
    "deposit",
    "withdraw",
    "rebalance"
  ],
  "severity": "high",
  "description": "Gamma Strategies managed liquidity positions on Uniswap V3/Algebra pools. Attackers used flashloans to manipulate pool prices, then exploited the vault's deposit/withdrawal and rebalancing mechanisms during price manipulation to extract $6.1M.",
  "root_cause": "Lack of slippage protection and oracle usage in deposit/withdrawal share calculations\n\nKey Weaknesses: No TWAP or external oracle for price validation; Share calculation based on manipulable spot price; No slippage limits on deposits/withdrawals",
  "attack_scenario": "Flashloan price manipulation combined with vault interaction during manipulated state\n\nAttack Flow: Obtain large flashloans: 3000 USDT from Uniswap V3, 2000 USDCe from Balancer \u2192 Execute 15 iterations of large swaps through Algebra pool to manipulate price \u2192 During manipulated price state, interact with Gamma Hypervisor \u2192 Deposit tokens at manipulated price, receive inflated share amounts \u2192 Trigger vault rebalance operations during manipulation to lock in bad state \u2192 Perform reverse swaps to restore pool price to normal \u2192 Withdraw from Gamma at corrected price with inflated shares \u2192 Profit from share valuation discrepancy: $6.1M \u2192 Repay flashloans and extract profit in ETH",
  "fix_description": "Implement TWAP oracles for price validation; Use Chainlink or other external price oracles; Add slippage limits on all deposits/withdrawals",
  "language": "solidity",
  "vulnerable_lines": [
    77
  ],
  "sub_category": ""
}