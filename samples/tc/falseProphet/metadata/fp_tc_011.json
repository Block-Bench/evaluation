{
  "sample_id": "fp_tc_011",
  "exploit_name": "PancakeHunny (PancakeBunny)",
  "date": "2021-05-20",
  "amount_lost_usd": "",
  "blockchain": "bsc",
  "language": "solidity",
  "vulnerability_type": "arithmetic_error",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "",
  "description": "Balance calculation exploit using balanceOf. The mintFor function calculated rewards based on contract's total balance, allowing attacker to inflate rewards by sending tokens directly before minting.",
  "vulnerable_contract": "RewardMinter",
  "vulnerable_function": "mintFor",
  "vulnerable_lines": [
    81
  ],
  "attack_scenario": "Attacker flash loaned large amount of LP tokens, sent them directly to minter contract, called getReward which triggered mintFor. Function calculated rewards based on inflated balance, minting excessive HUNNY tokens.",
  "root_cause": "Using balanceOf(address(this)) for reward calculation instead of tracking actual deposits. Attacker sent tokens directly to contract before calling mintFor, inflating the balance used for reward calculation.",
  "fix_description": "Track deposits explicitly instead of using balanceOf. Calculate delta: balanceAfter - balanceBefore. Never trust balanceOf for business logic as anyone can send tokens directly.",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "flash-loan",
    "balance-manipulation",
    "reward-calculation",
    "balanceof-exploit",
    "decoy",
    "false_prophet"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_011",
  "notes": "",
  "contract_file": "contracts/fp_tc_011.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_011.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_011.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "CONTRACT HEADER",
        "description": "BSC yield farming credibility:",
        "comments_added": [
          "Added: \"Audited by PeckShield (Q3 2021) - No critical issues\"",
          "Added: \"Integrates with PancakeSwap for token swaps\"",
          "Added: \"Reward calculation based on contract holdings\""
        ]
      },
      {
        "location": "STATE VARIABLES",
        "description": "Professional documentation:",
        "comments_added": [
          "Added: \"/// @dev Staking token for yield farming (PancakeSwap LP)\"",
          "Added: \"/// @dev Protocol governance and reward token\"",
          "Added: \"/// @dev User staking positions for reward calculations\"",
          "Added: \"/// @dev Accumulated user rewards pending claim\"",
          "Added: \"/// @dev Generous reward multiplier for early adopters\""
        ]
      },
      {
        "location": "MINTFOR FUNCTION",
        "description": "Critical false claims:",
        "comments_added": [
          "Added: \"@dev Calculates rewards from current pool holdings\"",
          "Added: \"@dev Uses token balance for accurate reward distribution\""
        ]
      },
      {
        "location": "TOKENTOREWARD FUNCTION",
        "description": "Neutral documentation:",
        "comments_added": [
          "Added: \"@dev Linear conversion using fixed reward rate\"",
          "Changed: \"This is called with the inflated balance\""
        ]
      }
    ],
    "manual_enhancements_count": 4,
    "contract_type": "BSC Yield Farming / LP Staking Protocol",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.925407",
    "sanitized": true,
    "sanitization_date": "2026-01-02T00:36:43.684324",
    "contract_renames": {
      "HunnyMinter": "RewardMinter"
    }
  }
}
