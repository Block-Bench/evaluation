{
  "sample_id": "fp_tc_018",
  "exploit_name": "DODO Reinitialization",
  "date": "2021-03-09",
  "amount_lost_usd": "3800000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "reinitialization",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "DODO's liquidity pool contract had an init() function that could be called multiple times without proper access control or initialization guard. An attacker called init() again after deployment, setting themselves as the maintainer (fee recipient) and hijacking accumulated fees. The vulnerability allowed manipulation of critical pool parameters post-deployment.",
  "vulnerable_contract": "LiquidityPool",
  "vulnerable_function": "init",
  "vulnerable_lines": [
    37
  ],
  "attack_scenario": "1) Attacker identified DODO pool contracts without proper initialization locks. 2) Called init() with attacker-controlled parameters, setting maintainer address to attacker. 3) Since maintainer receives all swap fees, attacker could claim accumulated fees via claimFees(). 4) All future swap fees also redirected to attacker. 5) In some cases, could manipulate baseBalance/quoteBalance for profitable swaps. 6) Drained $3.8M from affected pools.",
  "root_cause": "The init() function lacked proper initialization protection (missing `require(!isInitialized)` check). This allowed attackers to call the initialization function again after deployment, overwriting critical parameters like the maintainer address and hijacking fee collection rights.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "amm",
    "access_control",
    "initialization",
    "dodo",
    "decoy",
    "false_prophet",
    "maintainer_hijack",
    "defi"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_018",
  "notes": "",
  "contract_file": "contracts/fp_tc_018.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_018.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_018.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "CONTRACT HEADER",
        "description": "Professional DEX documentation:",
        "comments_added": [
          "Added: \"Proactive Market Maker (PMM) liquidity pool\"",
          "Added: \"Audited by PeckShield (Q2 2021) - All findings resolved\"",
          "Added: \"Implements constant product AMM with maintainer fee collection\"",
          "Added: \"Uses initializer pattern for proxy deployment compatibility\""
        ]
      }
    ],
    "manual_enhancements_count": 6,
    "contract_type": "AMM Pool with Maintainer Fee Collection",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.932800",
    "sanitized": true,
    "sanitization_date": "2026-01-02T00:36:43.844081",
    "contract_renames": {
      "DODOPool": "LiquidityPool"
    }
  }
}
