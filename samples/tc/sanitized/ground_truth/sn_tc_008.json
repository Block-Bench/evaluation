{
  "is_vulnerable": true,
  "vulnerability_type": "reentrancy",
  "vulnerable_functions": [
    "withdrawAll"
  ],
  "severity": "unknown",
  "description": "Classic reentrancy attack that drained 3.6M ETH from The DAO. The withdrawAll function sent ETH before updating balances, allowing attackers to recursively call the function and drain funds.",
  "root_cause": "External call to msg.sender before updating internal state (credit balance). Violation of checks-effects-interactions pattern.",
  "attack_scenario": "Attacker deposited ETH, then called withdrawAll from a malicious contract with a fallback function that re-entered withdrawAll, draining funds before balance was updated.",
  "fix_description": "Move credit[msg.sender] = 0 before the external call, or use ReentrancyGuard modifier. Follow checks-effects-interactions pattern.",
  "language": "solidity",
  "vulnerable_lines": [
    31,
    33
  ],
  "sub_category": ""
}