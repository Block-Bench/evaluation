{
  "is_vulnerable": true,
  "vulnerability_type": "price_oracle_manipulation",
  "vulnerable_functions": [
    "mint",
    "borrow",
    "getPrice"
  ],
  "severity": "high",
  "description": "Blueberry Protocol, a leveraged yield farming platform, was exploited for $1.4M through oracle price manipulation. Attackers used flashloans to manipulate low-liquidity DEX token prices (specifically OHM), then deposited the inflated collateral and borrowed maximum assets from lending pools.",
  "root_cause": "Oracle reliance on low-liquidity DEX spot prices without TWAP or external validation\n\nKey Weaknesses: Price derived from manipulable low-liquidity DEX pools; No TWAP implementation; Missing external price feed validation",
  "attack_scenario": "Use flashloan to pump low-liquidity token price, mint collateral at inflated price, borrow maximum assets\n\nAttack Flow: Obtain 1000 WETH flashloan from Balancer \u2192 Execute large buy of OHM using flashloaned WETH on low-liquidity DEX \u2192 OHM price artificially inflated 2-3x on DEX \u2192 Blueberry oracle queries DEX and reports inflated OHM price \u2192 Mint bOHM (Blueberry OHM) collateral tokens \u2192 Small OHM amount now worth much more due to manipulation \u2192 Enter markets to use bOHM as collateral \u2192 Borrow WETH, USDC, WBTC against inflated collateral value \u2192 Extract $1.4M from lending pools \u2192 Sell OHM back for WETH to restore price \u2192 Repay Balancer flashloan \u2192 Keep borrowed assets as profit",
  "fix_description": "Implement TWAP oracles with multi-block averaging; Use Chainlink or external price feeds as primary source; Add minimum liquidity requirements for pricing DEX pools",
  "language": "solidity",
  "vulnerable_lines": [
    56,
    73
  ],
  "sub_category": "dex_price_manipulation"
}