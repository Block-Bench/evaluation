{
  "is_vulnerable": true,
  "vulnerability_type": "access_control",
  "vulnerable_functions": [
    "executeRoute",
    "performAction"
  ],
  "severity": "critical",
  "description": "Socket Gateway, a cross-chain bridge aggregator, was exploited for $3.3M when attackers discovered route 406 accepted arbitrary user-controlled calldata. By injecting transferFrom calls into swapExtraData, attackers drained tokens from any user who had approved the Socket Gateway contract.",
  "root_cause": "User-controlled calldata executed without validation in route contract\n\nKey Weaknesses: Arbitrary external calls with user data; No calldata validation or function selector whitelisting; Unlimited token approvals from users",
  "attack_scenario": "Inject IERC20.transferFrom() calls via swapExtraData parameter to drain approved tokens from victims\n\nAttack Flow: Attacker identifies vulnerable route ID 406 in Socket Gateway \u2192 Route's performAction() accepts arbitrary swapExtraData parameter \u2192 Attacker finds victims with USDC approval to Socket Gateway \u2192 Craft malicious calldata: IERC20.transferFrom(victim, attacker, balance) \u2192 Encode malicious calldata into swapExtraData parameter \u2192 Call executeRoute(406, encodedPayload) on Socket Gateway \u2192 Gateway forwards call to vulnerable route contract \u2192 Route executes token.call(swapExtraData) with malicious data \u2192 transferFrom succeeds because victim approved Gateway \u2192 Drain $3.3M USDC from multiple victims with approvals",
  "fix_description": "Whitelist allowed function selectors for external calls; Validate all user-controlled calldata before execution; Never execute arbitrary calls with user-provided data",
  "language": "solidity",
  "vulnerable_lines": [
    37,
    69
  ],
  "sub_category": "arbitrary_call"
}