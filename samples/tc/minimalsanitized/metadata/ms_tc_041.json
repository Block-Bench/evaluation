{
  "sample_id": "ms_tc_041",
  "exploit_name": "DeltaPrime",
  "timestamp": "2024-11",
  "loss_amount_usd": 4750000,
  "blockchain": "arbitrum",
  "vulnerability_type": "access_control",
  "sub_category": "private_key_compromise",
  "severity": "critical",
  "tags": [
    "lending",
    "private_key_compromise",
    "proxy_upgrade",
    "malicious_upgrade",
    "timelock",
    "multi_sig"
  ],
  "difficulty": "advanced",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-11",
  "description": "DeltaPrime suffered a $4.75M exploit when attackers compromised an admin private key with upgrade privileges. They upgraded a pool contract to inject malicious code, then exploited the backdoored contract to drain funds through fake pair contracts and balance manipulation.",
  "vulnerable_lines": [
    49,
    82
  ],
  "vulnerability_details": {
    "root_cause": "Single private key compromise allowed arbitrary contract upgrades without timelock or multi-sig",
    "attack_vector": "Compromise admin key, upgrade pool to malicious implementation, exploit backdoor to drain funds",
    "vulnerable_functions": [
      "upgradePool()",
      "claimReward()",
      "swapDebtParaSwap()"
    ],
    "key_weakness": [
      "Single private key controls upgrades",
      "No multi-sig requirement",
      "Missing timelock delay",
      "No upgrade validation",
      "User-controlled pair addresses",
      "Arbitrary external calls without validation",
      "Insufficient monitoring"
    ]
  },
  "attack_flow": [
    "Compromise admin private key via phishing/malware",
    "Prepare malicious pool implementation with backdoors",
    "Use compromised key to call upgradePool()",
    "Upgrade pool proxy to malicious implementation",
    "No timelock allows immediate execution",
    "Create smart loan position via createLoan()",
    "Obtain massive WETH flashloan from Balancer",
    "Wrap ETH and deposit into manipulated pool",
    "Call malicious swapDebtParaSwap() to manipulate balances",
    "Call claimReward() with fake pair contract",
    "Fake pair's claimRewards() inflates attacker balance",
    "Withdraw inflated balance in real WETH",
    "Extract $4.75M, repay flashloan, keep profit"
  ],
  "mitigation": [
    "Implement multi-sig for all admin functions (3-of-5 minimum)",
    "Add timelock delay (24-48 hours) for upgrades",
    "Use hardware security modules (HSMs) for keys",
    "Implement upgrade validation process",
    "Whitelist allowed pair contract addresses",
    "Add circuit breakers for unusual transactions",
    "Monitor upgrade transactions and auto-pause",
    "Use decentralized governance for upgrades",
    "Regular key rotation and security audits"
  ],
  "references": [
    "https://arbiscan.io/tx/0x6a2f989b5493b52ffc078d0a59a3bf9727d134b403aa6e0bf309fd513a728f7f",
    "https://arbiscan.io/address/0x62cf82fb0484af382714cd09296260edc1dc0c6c"
  ],
  "contract_file": "contracts/ms_tc_041.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "minimalsanitized",
  "variant_parent_id": "tc_041",
  "transformation": {
    "type": "minimal_sanitization",
    "source_dir": "dataset/temporal_contamination/original",
    "source_contract": "dataset/temporal_contamination/original/contracts/tc_044.sol",
    "source_metadata": "dataset/temporal_contamination/original/metadata/tc_044.json",
    "script": "strategies/sanitize/minimal_sanitize.py",
    "changes": [
      "Removed 4 vulnerability comment block(s)",
      "Removed 10 vulnerability hint line(s)"
    ],
    "contract_renames": {},
    "created_date": "2025-12-29T22:32:44.562543"
  },
  "vulnerable_contract": "SmartLoansFactory",
  "vulnerable_function": "upgradePool"
}