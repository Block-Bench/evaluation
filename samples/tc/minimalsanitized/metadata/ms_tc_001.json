{
  "sample_id": "ms_tc_001",
  "exploit_name": "Nomad Bridge",
  "date": "2022-08-01",
  "amount_lost_usd": "190000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "improper_initialization",
  "vulnerability_subtype": "message_validation_bypass",
  "severity": "critical",
  "difficulty_tier": 4,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Nomad Bridge hack exploiting improper initialization of message validation. After a contract upgrade, the acceptedRoot was mistakenly set to 0x00...00, allowing attackers to craft messages that bypassed validation and drain $190M across 41 different tokens.",
  "vulnerable_contract": "NomadReplica",
  "vulnerable_function": "process",
  "vulnerable_lines": [
    18,
    53
  ],
  "attack_scenario": "Attacker crafts cross-chain messages with zero hash or matching the uninitialized acceptedRoot (0x00...00), bypassing proper merkle proof validation. The process() function incorrectly accepts these messages, triggering token transfers without corresponding deposits on the source chain.",
  "root_cause": "After contract upgrade, the acceptedRoot storage variable was not properly initialized and remained at 0x00...00. The message validation logic checked if message roots matched acceptedRoot, but with acceptedRoot being zero, attackers could craft messages to pass validation.",
  "fix_description": "Proper initialization of acceptedRoot after contract upgrades. Implement strict validation that acceptedRoot can never be 0x00...00. Add additional checks to ensure messages are properly committed to a merkle tree before processing. Implement emergency pause mechanisms.",
  "source_reference": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2022-08/NomadBridge_exp.sol",
  "external_references": [
    "https://twitter.com/samczsun/status/1554252024723546112",
    "https://www.certik.com/resources/blog/28fMavD63CpZJOKOjb9DX3-nomad-bridge-exploit-incident-analysis",
    "https://etherscan.io/address/0xb92336759618f55bd0f8313bd843604592e27bd8"
  ],
  "tags": [
    "bridge",
    "cross-chain",
    "initialization",
    "message_validation",
    "upgrade",
    "historical",
    "mega_hack"
  ],
  "variant_type": "minimalsanitized",
  "variant_parent_id": "tc_001",
  "notes": "One of the largest bridge hacks in history. Hundreds of copycat attackers repeated the exploit within hours once the vulnerability was discovered. The hack demonstrated the critical importance of proper state initialization during contract upgrades.",
  "contract_file": "contracts/ms_tc_001.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "minimal_sanitization",
    "source_dir": "dataset/temporal_contamination/original",
    "source_contract": "dataset/temporal_contamination/original/contracts/tc_001.sol",
    "source_metadata": "dataset/temporal_contamination/original/metadata/tc_001.json",
    "script": "strategies/sanitize/minimal_sanitize.py",
    "changes": [
      "Renamed contract: VulnerableNomadReplica -> NomadReplica",
      "Removed 3 vulnerability comment block(s)",
      "Removed 5 vulnerability hint line(s)"
    ],
    "contract_renames": {
      "VulnerableNomadReplica": "NomadReplica"
    },
    "created_date": "2025-12-29T22:32:44.502869"
  }
}