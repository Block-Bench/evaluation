{
  "is_vulnerable": true,
  "vulnerability_type": "access_control",
  "vulnerable_functions": [
    "performOperations"
  ],
  "severity": "critical",
  "description": "Seneca Protocol's Chamber contract was exploited for $6.4M through its performOperations() function. The function accepted user-controlled target addresses and calldata, allowing attackers to call transferFrom() on tokens where victims had given approvals to Chamber.",
  "root_cause": "User-controlled target address and calldata in performOperations allowing arbitrary external calls\n\nKey Weaknesses: User-controlled target address; User-controlled calldata without validation; No whitelist of approved targets",
  "attack_scenario": "Craft operation with transferFrom calldata targeting victim tokens, execute via performOperations\n\nAttack Flow: Identify victim with Pendle Principal Token approval to Chamber \u2192 Craft malicious operation data with OPERATION_CALL action \u2192 Set target = PendlePrincipalToken contract address \u2192 Set callData = transferFrom(victim, attacker, victimBalance) \u2192 Encode data = abi.encode(target, callData, 0, 0, 0) \u2192 Call chamber.performOperations(actions, values, datas) \u2192 Chamber decodes target and callData from user input \u2192 Chamber executes: target.call(callData) \u2192 Token contract processes transferFrom with Chamber as msg.sender \u2192 Transfer succeeds because victim approved Chamber \u2192 Attacker receives victim's entire token balance \u2192 Repeat for multiple victims with approvals \u2192 Total stolen: $6.4M in Pendle tokens",
  "fix_description": "Whitelist allowed target contract addresses; Whitelist allowed function selectors; Never allow transferFrom calls on arbitrary tokens",
  "language": "solidity",
  "vulnerable_lines": [
    45
  ],
  "sub_category": "arbitrary_call"
}