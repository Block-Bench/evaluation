{
  "is_vulnerable": true,
  "vulnerability_type": "access_control",
  "vulnerable_functions": [
    "createLockedCampaign"
  ],
  "severity": "critical",
  "description": "Hedgey Finance, a token vesting platform, was exploited for $44.7M when attackers provided a malicious tokenLocker address in createLockedCampaign(). The contract made an arbitrary external call to this address, allowing attackers to steal tokens from any user who had approved Hedgey.",
  "root_cause": "User-controlled tokenLocker address used in arbitrary external call without validation\n\nKey Weaknesses: User-controlled address in external call; No whitelist of approved tokenLocker contracts; Arbitrary external call without validation",
  "attack_scenario": "Provide malicious contract as tokenLocker, use external call to invoke transferFrom on victim tokens\n\nAttack Flow: Create malicious tokenLocker contract implementing createTokenLock() \u2192 Malicious contract calls transferFrom() on victims instead of locking \u2192 Identify victims with USDC approvals to Hedgey \u2192 Obtain 1.305M USDC flashloan from Balancer \u2192 Call createLockedCampaign() with malicious tokenLocker address \u2192 Hedgey calls attackerContract.createTokenLock() \u2192 Malicious contract executes: USDC.transferFrom(victim, attacker, balance) \u2192 Transfer succeeds because victim approved Hedgey contract \u2192 Repeat for multiple victims across various tokens \u2192 Drain total of $44.7M from approved users \u2192 Repay flashloan and keep stolen funds",
  "fix_description": "Whitelist approved tokenLocker contract addresses; Never make external calls to user-provided addresses; Implement contract code verification before allowing",
  "language": "solidity",
  "vulnerable_lines": [
    66
  ],
  "sub_category": "arbitrary_external_call"
}