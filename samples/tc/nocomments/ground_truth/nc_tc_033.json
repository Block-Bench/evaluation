{
  "is_vulnerable": true,
  "vulnerability_type": "access_control",
  "vulnerable_functions": [
    "openTroveAndMigrate",
    "closeTroveFor",
    "openTrove"
  ],
  "severity": "critical",
  "description": "Prisma Finance suffered a $10M exploit through its MigrateTroveZap contract which accepted user-controlled account parameters. Attackers exploited delegate approvals to open troves and mint debt tokens on behalf of victims who had approved the zap contract, then received the minted tokens themselves.",
  "root_cause": "User-controlled account parameter in zap contract combined with overly permissive delegate approval system\n\nKey Weaknesses: User-controlled account parameter; Overly permissive delegate approvals; No distinction between delegation types",
  "attack_scenario": "Use delegate approval to open troves on victim accounts with attacker's collateral, mint debt to attacker, victim gets debt obligation\n\nAttack Flow: Identify victims who approved MigrateTroveZap as delegate \u2192 Obtain flashloan of ~1800 wstETH collateral \u2192 Call openTroveAndMigrate() with victim's address as account parameter \u2192 Zap contract uses delegate approval to authorize operation \u2192 Opens trove using attacker's collateral on victim's account \u2192 Mints maximum debt (mkUSD) and sends to attacker \u2192 Victim's account now has debt obligation, attacker has debt tokens \u2192 Repeat for multiple victims to drain $10M \u2192 Close positions and repay flashloan with profits",
  "fix_description": "Validate account == msg.sender for critical operations; Implement granular permission system for specific operations; Add time-bounded approvals with expiration",
  "language": "solidity",
  "vulnerable_lines": [
    74,
    82
  ],
  "sub_category": "delegate_approval"
}