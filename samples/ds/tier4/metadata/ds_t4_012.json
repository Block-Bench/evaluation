{
  "id": "ds_t4_012",
  "original_id": "smartbugs_bad_randomness_blackjack",
  "source_dataset": "smartbugs-curated",
  "language": "solidity",
  "chain": "evm",
  "file_name": "blackjack.sol",
  "vulnerable_function": "deal",
  "vulnerable_lines": [],
  "vulnerability_type": "weak_randomness",
  "original_category": "bad_randomness",
  "severity": "medium",
  "difficulty_tier": 4,
  "description": "Weak randomness in the deal function. The random number generation uses block.number and blockhash which are predictable by miners and can be manipulated. This allows predicting or influencing the outcome of the card dealing mechanism.",
  "fix_description": "Use Chainlink VRF or commit-reveal scheme for randomness",
  "is_vulnerable": true,
  "context_level": "single_file",
  "original_source_path": "dataset/bad_randomness/blackjack.sol",
  "source_url": "https://etherscan.io/address/0xa65d59708838581520511d98fb8b5d1f76a96cad#code",
  "references": [],
  "framework": null,
  "contract_file": "contracts/ds_t4_012.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_233",
  "sanitized_from": "ds_233",
  "sanitized_id": "sn_ds_233",
  "vulnerable_functions": [
    "deal"
  ]
}
