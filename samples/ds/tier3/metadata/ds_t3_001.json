{
  "id": "ds_t3_001",
  "original_id": "defivulnlabs_sensefinance_exp",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "SenseFinance_exp.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "logic_error",
  "original_category": null,
  "severity": "medium",
  "difficulty_tier": 3,
  "description": "The onSwap() function in the Space contract calculates swap amounts based on provided reserve values. This function can be called directly with manipulated reserve values to obtain significantly different swap calculations than intended, potentially taking advantage of price discrepancies.",
  "fix_description": "Ensure onSwap can only be called by authorized pool contracts. Validate reserve inputs against actual pool state or use internal reserve tracking.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/SenseFinance_exp.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_001.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_181",
  "sanitized_from": "ds_181",
  "sanitized_id": "sn_ds_181",
  "identifier_mappings": {
    "testExploit": "testOperation"
  },
  "vulnerable_functions": [
    "onSwap"
  ]
}
