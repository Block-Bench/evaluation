{
  "id": "ds_t3_012",
  "original_id": "defivulnlabs_delegatecall",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Delegatecall.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "delegatecall_injection",
  "original_category": null,
  "severity": "critical",
  "difficulty_tier": 3,
  "description": "The Proxy Contract Owner Manipulation issue is a flaw in the smart contract design that allows manipulation of the owner of the Proxy contract, which is hardcoded as 0xdeadbeef. The issue arises due to the use of delegatecall in the fallback function of the Proxy contract. delegatecall allows invoking the execute() function from the Delegate contract within the context of the Proxy contract, thereby changing the value of the owner state variable of the Proxy contract. This allows a smart contract to dynamically load code from a different address at runtime.",
  "fix_description": "To mitigate the Proxy Contract Owner Manipulation Vulnerability, \navoid using delegatecall unless it is explicitly required, and ensure that the delegatecall is used securely. \nIf the delegatecall is necessary for the contract's functionality, make sure to validate and \nsanitize inputs to avoid unexpected behaviors.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/Delegatecall.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_012.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_194",
  "sanitized_from": "ds_194",
  "sanitized_id": "sn_ds_194",
  "identifier_mappings": {
    "Exploit": "operate",
    "pwn": "execute"
  },
  "vulnerable_functions": [
    "fallback",
    "execute"
  ]
}
