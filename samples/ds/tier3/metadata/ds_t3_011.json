{
  "id": "ds_t3_011",
  "original_id": "defivulnlabs_nft-transfer",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "NFT-transfer.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "logic_error",
  "original_category": null,
  "severity": "medium",
  "difficulty_tier": 3,
  "description": "Custom transferFrom function in the ERC721 contract does not properly check if msg.sender is the current owner of the token or an approved address. As a result, any address can call the transferFrom function to transfer any token, regardless of who the current owner is. This allows unauthorized users to transfer tokens they do not own, leading to potential theft of assets.",
  "fix_description": "To ensure that msg.sender is the current owner of the token or an approved address.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/NFT-transfer.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_011.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_191",
  "sanitized_from": "ds_191",
  "sanitized_id": "sn_ds_191",
  "identifier_mappings": {
    "VulnerableERC721": "BasicERC721",
    "FixedERC721": "ERC721B",
    "VulnerableERC721Contract": "BasicERC721Contract",
    "testVulnerableERC721": "testBasicERC721",
    "ERC721V2": "ERC721B",
    "FixedERC721Contract": "ERC721ContractB",
    "testFixedERC721": "testERC721B"
  },
  "vulnerable_functions": [
    "transferFrom"
  ]
}
