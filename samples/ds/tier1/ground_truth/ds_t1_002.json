{
  "is_vulnerable": true,
  "vulnerability_type": "reentrancy",
  "vulnerable_functions": [
    "withdrawBalance"
  ],
  "severity": "high",
  "description": "The withdrawBalance() function makes an external call using call.value() before updating the user's balance to zero. An attacker can exploit this by deploying a contract with a fallback function that recursively calls withdrawBalance(), draining the contract's funds.",
  "fix_description": "Apply the checks-effects-interactions pattern: update userBalance[msg.sender] = 0 before making the external call. Alternatively, use a ReentrancyGuard mutex or transfer()/send() instead of call.value().",
  "language": "solidity"
}