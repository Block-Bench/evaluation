{
  "id": "gs_001",
  "is_vulnerable": true,
  "vulnerability_type": "logic_error",
  "severity": "high",
  "vulnerable_contract": "GovernanceHYBR",
  "vulnerable_function": "deposit",
  "vulnerable_lines": [137, 138, 139, 140, 141, 142, 143, 144],
  "description": "The deposit logic updates totalAssets before share calculation, causing depositors to receive fewer shares than expected based on the pre-deposit ratio.",
  "root_cause": "The GovernanceHYBR::deposit function first deposits HYBR into votingEscrow before calculating shares. This increases totalAssets() first, and the new totalAssets() is used in calculateShares(amount). Users' deposits are treated as rewards and they receive shares at a worse rate, suffering slippage from their own tokens.",
  "attack_scenario": "1. Bob deposits 100 HYBR, gets 100 gHYBR (1:1 ratio). 2. Alice deposits 100 HYBR expecting 100 gHYBR. 3. Due to order-of-operations bug, Alice only gets 50 gHYBR because her deposit increases totalAssets before share calculation.",
  "fix_description": "Calculate shares BEFORE depositing to votingEscrow: move 'uint256 shares = calculateShares(amount)' before the IVotingEscrow.deposit_for() call.",
  "difficulty_tier": 2,
  "original_subset": "gold_standard",
  "tags": ["logic_error", "code4rena", "gold_standard", "audit_finding"]
}
