{
  "sample_id": "gs_c4_2025-10-sequence_H02",
  "exploit_name": "Partial signature replay/frontrunning attack on session calls",
  "date": "2025-10-07",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "signature_replay",
  "vulnerability_subtype": "H-02",
  "severity": "high",
  "difficulty_tier": 3,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "When a session call with BEHAVIOR_REVERT_ON_ERROR fails, the transaction reverts but nonce is not consumed. The signature remains valid and can be replayed for partial calls. Session signatures are validated per-call using individual call hashes, enabling partial replay. Frontrunners can execute subsets of calls to grief or cause financial loss.",
  "vulnerable_contract": "Calls",
  "vulnerable_function": "execute",
  "vulnerable_lines": [],
  "attack_scenario": "Original payload: Calls [A, B, C] with signatures [SigA, SigB, SigC]. Execution: [A succeed, B succeed, C revert]. Result: Revert, nonce unused. Attack: Replay [A, B] with [SigA, SigB]. PoC: File POC.t.sol with test testSubmissionValidity. It builds a 2-call payload, expects revert on second call, then replays partial payload successfully.",
  "root_cause": "When a session call with BEHAVIOR_REVERT_ON_ERROR fails, the transaction reverts but nonce is not consumed. The signature remains valid and can be replayed for partial calls. Session signatures are validated per-call using individual call hashes, enabling partial replay. Frontrunners can execute subsets of calls to grief or cause financial loss.",
  "fix_description": "Bind session call signatures to the complete payload hash to prevent partial signature replay.",
  "source_reference": "https://code4rena.com/reports/2025-10-sequence",
  "external_references": [
    "https://github.com/code-423n4/2025-10-sequence"
  ],
  "tags": [
    "signature_replay",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "cleaned",
  "variant_parent_id": "gs_c4_2025-10-sequence_H02",
  "notes": "Session signatures are per-call, and failed batches preserve nonce, allowing replay of successful subsets for griefing or frontrunning.",
  "contract_file": "contracts/gs_029.sol",
  "subset": "annotated",
  "original_subset": "gold_standard",
  "transformation": {
    "type": "minimal_sanitization",
    "source": "gold_standard/original",
    "changes": [
      "Removed vulnerability header block (lines 4-33)",
      "Removed 49 '^^^ VULNERABLE LINE ^^^' markers"
    ],
    "script": "strategies/sanitize/sanitize_gold_standard.py",
    "created_date": "2026-01-04T14:15:44.595570"
  }
}