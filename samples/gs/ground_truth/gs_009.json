{
  "is_vulnerable": true,
  "vulnerability_type": "logic_error",
  "vulnerable_functions": [
    "_checkpoint"
  ],
  "severity": "medium",
  "description": "`_checkpoint` creates a new epoch with the same timestamp for `increase_amount`, ignoring the new lock in `balanceOfNFT`, reducing voting power.",
  "root_cause": "`_checkpoint` creates a new epoch with the same timestamp for `increase_amount`, ignoring the new lock in `balanceOfNFT`, reducing voting power.",
  "attack_scenario": "A test locks 500e18, increases by 500e18 in one tx, and shows reduced bribe rewards compared to separate locks.",
  "fix_description": "In `_checkpoint`, overwrite the latest point if timestamps match, else append a new one. Status: Mitigation confirmed.",
  "language": "solidity"
}