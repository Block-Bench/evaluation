{
  "is_vulnerable": true,
  "vulnerability_type": "logic_error",
  "vulnerable_functions": [
    "recoverSapientSignature"
  ],
  "severity": "medium",
  "description": "BaseAuth.recoverSapientSignature returns bytes32(uint256(1)) instead of actual signer imageHash, violating ISapient interface. Breaks Merkle leaf construction in BaseSig.recoverBranch.",
  "root_cause": "BaseAuth.recoverSapientSignature returns bytes32(uint256(1)) instead of actual signer imageHash, violating ISapient interface. Breaks Merkle leaf construction in BaseSig.recoverBranch.",
  "attack_scenario": "Wallet uses another wallet as sapient signer \u2192 signature validation fails due to incorrect image hash. PoC: Add test to test/modules/BaseSig.t.sol: test_BaseAuth_recoverSapientSignature_ReturnsConstant. Deploys MinimalSapient, crafts signature, asserts constant return.",
  "fix_description": "Return actual image hash from recoverSapientSignature. Extend signatureValidation to return imageHash or call BaseSig.recover.",
  "language": "solidity"
}