{
  "sample_id": "gs_c4_2025-10-hybra-finance_M08",
  "exploit_name": "Incorrect voting power calculation when create_lock and increase_amount are called in the same transaction",
  "date": "2025-10-06",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "logic_error",
  "vulnerability_subtype": "M-08",
  "severity": "medium",
  "difficulty_tier": 3,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "`_checkpoint` creates a new epoch with the same timestamp for `increase_amount`, ignoring the new lock in `balanceOfNFT`, reducing voting power.",
  "vulnerable_contract": "VotingEscrow",
  "vulnerable_function": "_checkpoint",
  "vulnerable_lines": [
    760
  ],
  "attack_scenario": "A test locks 500e18, increases by 500e18 in one tx, and shows reduced bribe rewards compared to separate locks.",
  "root_cause": "`_checkpoint` creates a new epoch with the same timestamp for `increase_amount`, ignoring the new lock in `balanceOfNFT`, reducing voting power.",
  "fix_description": "In `_checkpoint`, overwrite the latest point if timestamps match, else append a new one. Status: Mitigation confirmed.",
  "source_reference": "https://code4rena.com/reports/2025-10-hybra-finance",
  "external_references": [
    "https://github.com/code-423n4/2025-10-hybra-finance"
  ],
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "original",
  "variant_parent_id": null,
  "notes": "Same-tx lock increase creates duplicate checkpoint timestamp, undercalculating voting power.",
  "contract_file": "contracts/gs_009.sol",
  "subset": "annotated",
  "original_subset": "gold_standard"
}