{
  "sample_id": "gs_c4_2025-10-hybra-finance_M07",
  "exploit_name": "Claiming rewards in GovernanceHYBR will always revert",
  "date": "2025-10-06",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "logic_error",
  "vulnerability_subtype": "M-07",
  "severity": "medium",
  "difficulty_tier": 1,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
  "vulnerable_contract": "GrowthHYBR",
  "vulnerable_function": "claimRewards",
  "vulnerable_lines": [
    392,
    393,
    394,
    395,
    396,
    397,
    398,
    399,
    400,
    401,
    402,
    403,
    404,
    405,
    406,
    407,
    408,
    409,
    410,
    411,
    412,
    413,
    414,
    415,
    416,
    417,
    418,
    419,
    420,
    421,
    422,
    423,
    424,
    425,
    426,
    427,
    428,
    429,
    430,
    431,
    432,
    433,
    434,
    435,
    436,
    437,
    438,
    439,
    440,
    441,
    442,
    443,
    444,
    445
  ],
  "attack_scenario": "A test votes on pools, warps time, and `claimRewards()` reverts due to invalid getter call.",
  "root_cause": "`claimRewards()` uses `IVoter.poolVote(veTokenId)` incorrectly; `poolVote` is a mapping, not a function returning an array, causing a revert.",
  "fix_description": "Add `getPoolVote(veTokenId)` in `VoterV3.sol` to return the array. Status: Mitigation confirmed.",
  "source_reference": "https://code4rena.com/reports/2025-10-hybra-finance",
  "external_references": [
    "https://github.com/code-423n4/2025-10-hybra-finance"
  ],
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "original",
  "variant_parent_id": null,
  "notes": "Incorrect interface usage treats mapping as function, causing revert on reward claims.",
  "contract_file": "contracts/gs_008.sol",
  "subset": "annotated",
  "original_subset": "gold_standard"
}