{
  "id": "ds_t4_001",
  "original_id": "defivulnlabs_erc777-reentrancy",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "ERC777-reentrancy.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "reentrancy",
  "original_category": null,
  "severity": "critical",
  "difficulty_tier": 4,
  "description": "ERC777 tokens allow arbitrary callbacks via hooks that are called during token transfers. Certain contract addresses may cause reentrancy on such callbacks if reentrancy guards are not used.",
  "fix_description": "Follow check-effect-interaction and use OpenZeppelin Reentrancy Guard.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/ERC777-reentrancy.sol",
  "source_url": null,
  "references": [
    "https://medium.com/cream-finance/c-r-e-a-m-finance-post-mortem-amp-exploit-6ceb20a630c5"
  ],
  "framework": "foundry",
  "contract_file": "contracts/ds_t4_001.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_221",
  "sanitized_from": "ds_221",
  "sanitized_id": "sn_ds_221",
  "identifier_mappings": {
    "testERC777Reentrancy": "testERC777Callback"
  },
  "vulnerable_functions": [
    "claim"
  ]
}
