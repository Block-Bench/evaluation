{
  "id": "ds_t1_013",
  "original_id": "smartbugs_access_control_wallet_02_refund_nosub",
  "source_dataset": "smartbugs-curated",
  "language": "solidity",
  "chain": "evm",
  "file_name": "wallet_02_refund_nosub.sol",
  "vulnerable_function": "refund",
  "vulnerable_lines": [],
  "vulnerability_type": "access_control",
  "original_category": "access_control",
  "severity": "high",
  "difficulty_tier": 1,
  "description": "The refund() function transfers the caller's balance without subtracting it from their recorded balance. An attacker can call refund() multiple times to drain the contract, as their balance is never decremented.",
  "fix_description": "Add proper access control modifiers (onlyOwner, require statements) or avoid tx.origin",
  "is_vulnerable": true,
  "context_level": "single_file",
  "original_source_path": "dataset/access_control/wallet_02_refund_nosub.sol",
  "source_url": "https://smartcontractsecurity.github.io/SWC-registry/docs/SWC-105#wallet-02-refund-nosubsol",
  "references": [],
  "framework": null,
  "contract_file": "contracts/ds_t1_013.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_014",
  "sanitized_from": "ds_014",
  "sanitized_id": "sn_ds_014",
  "vulnerable_functions": [
    "refund"
  ]
}
