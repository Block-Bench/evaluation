{
  "sample_id": "gs_c4_2025-10-hybra-finance_M05",
  "exploit_name": "Rollover rewards are permanently lost due to flawed rewardRate calculation",
  "date": "2025-10-06",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "logic_error",
  "vulnerability_subtype": "M-05",
  "severity": "medium",
  "difficulty_tier": 2,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "The `notifyRewardAmount()` function miscalculates the `rewardRate` when a new epoch begins, causing `rollover` rewards from previous epochs to be permanently lost. When `block.timestamp >= _periodFinish`, the function adds both the new `rewardAmount` and the previous epoch\u2019s `clPool.rollover()` to form the `totalRewardAmount`. However, the `rewardRate` is derived only from `rewardAmount`, ignoring the rollover portion: // @audit The total amount to be reserved includes rollover... uint256 totalRewardAmount = rewardAmount + clPool.rollover(); // @audit but the rate calculation completely ignores the rollover. rewardRate = rewardAmount / epochTimeRemaining; // @audit The pool is synced with a CORRECT",
  "vulnerable_contract": "GaugeCL",
  "vulnerable_function": "notifyRewardAmount",
  "vulnerable_lines": [],
  "attack_scenario": "Refer to original submission for PoC (not detailed here).",
  "root_cause": "The `notifyRewardAmount()` function miscalculates the `rewardRate` when a new epoch begins, causing `rollover` rewards from previous epochs to be permanently lost. When `block.timestamp >= _periodFinish`, the function adds both the new `rewardAmount` and the previous epoch\u2019s `clPool.rollover()` to form the `totalRewardAmount`. However, the `rewardRate` is derived only from `rewardAmount`, ignoring the rollover portion: // @audit The total amount to be reserved includes rollover... uint256 totalRewardAmount = rewardAmount + clPool.rollover(); // @audit but the rate calculation completely ignores the rollover. rewardRate = rewardAmount / epochTimeRemaining; // @audit The pool is synced with a CORRECT",
  "fix_description": "Use `totalRewardAmount = rewardAmount + clPool.rollover()` for `rewardRate = totalRewardAmount / epochTimeRemaining`. Status: Mitigation confirmed.",
  "source_reference": "https://code4rena.com/reports/2025-10-hybra-finance",
  "external_references": [
    "https://github.com/code-423n4/2025-10-hybra-finance"
  ],
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "cleaned",
  "variant_parent_id": "gs_c4_2025-10-hybra-finance_M05",
  "notes": "Reward rate calculation excludes rollover amounts, leading to permanent loss of carried-over rewards in new epochs.",
  "contract_file": "contracts/gs_006.sol",
  "subset": "annotated",
  "original_subset": "gold_standard",
  "transformation": {
    "type": "minimal_sanitization",
    "source": "gold_standard/original",
    "changes": [
      "Removed vulnerability header block (lines 3-37)",
      "Removed 1 '^^^ VULNERABLE LINE ^^^' markers",
      "Removed 1 '@audit-issue' comments"
    ],
    "script": "strategies/sanitize/sanitize_gold_standard.py",
    "created_date": "2026-01-04T14:15:44.575700"
  }
}