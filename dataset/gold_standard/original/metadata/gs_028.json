{
  "sample_id": "gs_c4_2025-10-sequence_H01",
  "exploit_name": "Chained signature with checkpoint usage disabled can bypass all checkpointer validation",
  "date": "2025-10-07",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "H-01",
  "severity": "high",
  "difficulty_tier": 3,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "When a wallet is behind a checkpointer and a chained signature is used with bit 6 (checkpointer usage flag) set to zero, BaseSig.recover skips the checkpointer validation block (BaseSig.sol:88-106). This leaves _checkpointer and snapshot unset (zero-valued). In recoverChained, the checkpointer is ignored, and the signature validation passes even if the checkpointer should be enforced. The final validation succeeds because snapshot.imageHash == bytes32(0) as the checkpointer is ignored.",
  "vulnerable_contract": "BaseSig",
  "vulnerable_function": "recover",
  "vulnerable_lines": [
    116,
    196
  ],
  "attack_scenario": "An evicted signer can sign a payload valid under stale wallet configuration and bypass checkpointer validation. PoC: Add test case to BaseSigTest and run forge test --match-test test_PoC_checkpointer_bypass. The test constructs a chained signature with checkpointer disabled, mocks the checkpointer response, and asserts successful recovery with correct image hash.",
  "root_cause": "When a wallet is behind a checkpointer and a chained signature is used with bit 6 (checkpointer usage flag) set to zero, BaseSig.recover skips the checkpointer validation block (BaseSig.sol:88-106). This leaves _checkpointer and snapshot unset (zero-valued). In recoverChained, the checkpointer is ignored, and the signature validation passes even if the checkpointer should be enforced. The final validation succeeds because snapshot.imageHash == bytes32(0) as the checkpointer is ignored.",
  "fix_description": "Do not permit checkpointer to be disabled (bit 6 unset) if chained signature is used. Revert in this case with custom error. Example fix in BaseSig.sol:\nif (signatureFlag & 0x40 == 0) {\n    revert MissingCheckpointer();\n}",
  "source_reference": "https://code4rena.com/reports/2025-10-sequence",
  "external_references": [
    "https://github.com/code-423n4/2025-10-sequence"
  ],
  "tags": [
    "access_control",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "original",
  "variant_parent_id": null,
  "notes": "Chained signatures can disable checkpointer enforcement via flag, allowing bypass of intended validation and use of evicted/stale signers.",
  "contract_file": "contracts/gs_028.sol",
  "subset": "annotated",
  "original_subset": "gold_standard"
}