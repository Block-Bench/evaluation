{
  "sample_id": "gs_c4_2025-10-sequence_M04",
  "exploit_name": "Factory deploy reverts instead of returning address when account already exists",
  "date": "2025-10-07",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "dos",
  "vulnerability_subtype": "M-04",
  "severity": "medium",
  "difficulty_tier": 2,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "Factory.deploy uses create2 but reverts with CreateCollision if address exists, violating ERC-4337 expectation to return address. Breaks simulations and bundler logic.",
  "vulnerable_contract": "Factory",
  "vulnerable_function": "deploy",
  "vulnerable_lines": [
    48,
    49,
    50,
    51,
    52,
    53,
    54,
    55,
    56
  ],
  "attack_scenario": "Deploy wallet once, call deploy again \u2192 reverts. Attacker can front-run to cause DoS. PoC: test_factory_double_deploy_PoC in AuditPoC.sol. Shows first deploy succeeds, second reverts.",
  "root_cause": "Factory.deploy uses create2 but reverts with CreateCollision if address exists, violating ERC-4337 expectation to return address. Breaks simulations and bundler logic.",
  "fix_description": "Check if address exists via predicted.code.length, return it if so.",
  "source_reference": "https://code4rena.com/reports/2025-10-sequence",
  "external_references": [
    "https://github.com/code-423n4/2025-10-sequence"
  ],
  "tags": [
    "dos",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "original",
  "variant_parent_id": null,
  "notes": "Factory reverts on redeploy attempt instead of returning existing address, breaking ERC-4337 compatibility and enabling DoS.",
  "contract_file": "contracts/gs_033.sol",
  "subset": "annotated",
  "original_subset": "gold_standard"
}