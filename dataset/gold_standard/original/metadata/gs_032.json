{
  "sample_id": "gs_c4_2025-10-sequence_M03",
  "exploit_name": "BaseAuth.recoverSapientSignature returns a constant instead of signer image hash, breaking sapient signer flows",
  "date": "2025-10-07",
  "amount_lost_usd": null,
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "logic_error",
  "vulnerability_subtype": "M-03",
  "severity": "medium",
  "difficulty_tier": 2,
  "is_vulnerable": true,
  "temporal_category": "post_cutoff",
  "description": "BaseAuth.recoverSapientSignature returns bytes32(uint256(1)) instead of actual signer imageHash, violating ISapient interface. Breaks Merkle leaf construction in BaseSig.recoverBranch.",
  "vulnerable_contract": "BaseAuth",
  "vulnerable_function": "recoverSapientSignature",
  "vulnerable_lines": [
    164,
    184
  ],
  "attack_scenario": "Wallet uses another wallet as sapient signer \u2192 signature validation fails due to incorrect image hash. PoC: Add test to test/modules/BaseSig.t.sol: test_BaseAuth_recoverSapientSignature_ReturnsConstant. Deploys MinimalSapient, crafts signature, asserts constant return.",
  "root_cause": "BaseAuth.recoverSapientSignature returns bytes32(uint256(1)) instead of actual signer imageHash, violating ISapient interface. Breaks Merkle leaf construction in BaseSig.recoverBranch.",
  "fix_description": "Return actual image hash from recoverSapientSignature. Extend signatureValidation to return imageHash or call BaseSig.recover.",
  "source_reference": "https://code4rena.com/reports/2025-10-sequence",
  "external_references": [
    "https://github.com/code-423n4/2025-10-sequence"
  ],
  "tags": [
    "logic_error",
    "code4rena",
    "gold_standard",
    "audit_finding"
  ],
  "variant_type": "original",
  "variant_parent_id": null,
  "notes": "Sapient signer recovery returns hardcoded constant instead of actual image hash, breaking nested/sapient signer configurations.",
  "contract_file": "contracts/gs_032.sol",
  "subset": "annotated",
  "original_subset": "gold_standard"
}