{
  "sample_id": "tr_tc_023",
  "exploit_name": "Alpha Homora Credit Account Manipulation",
  "date": "2021-02-13",
  "amount_lost_usd": "37000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "accounting_manipulation",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Alpha Homora V2 integrated with Cream's Iron Bank for leveraged yield farming. The vulnerability was in how debt shares were calculated when totalDebt could be manipulated through external pool state changes. Attackers borrowed funds and manipulated pool reserves to skew the share-to-amount conversion, allowing them to receive far more value than their debt obligations reflected.",
  "vulnerable_contract": "LeveragedVault",
  "vulnerable_function": "",
  "vulnerable_lines": [],
  "attack_scenario": "1) Attacker opened leveraged position and borrowed initial funds from Iron Bank. 2) Used flash loans to manipulate sUSD/USDC pool reserves. 3) Pool manipulation caused totalDebt calculations to become stale/incorrect. 4) Opened second position with manipulated totalDebt value. 5) Debt share calculation: (borrowAmount * totalDebtShare) / inflatedTotalDebt resulted in fewer shares than deserved. 6) When converting back, attacker's debt appeared much smaller than actual borrowed amount. 7) Repaid calculated debt and withdrew collateral, keeping difference. 8) Repeated to drain $37M.",
  "root_cause": "Debt share calculation depended on totalDebt value that could be manipulated via external pool state changes. The share-to-amount conversion (amount * totalDebtShare / totalDebt) was vulnerable when totalDebt was artificially inflated through pool manipulation, resulting in attackers receiving fewer debt shares than they should for borrowed amounts.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "leverage",
    "iron_bank",
    "cream_finance",
    "debt_accounting",
    "share_calculation",
    "flash_loan",
    "trojan"
  ],
  "variant_type": "trojan",
  "variant_parent_id": "tc_023",
  "notes": "",
  "contract_file": "contracts/tr_tc_023.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "trojan",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_023.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_023.json",
    "script": "manual",
    "changes": [
      "Removed vulnerability documentation and comments",
      "Added distractor code (fake security metrics, config tracking)",
      "Added suspicious-named variables as red herrings",
      "Preserved original vulnerability",
      "Renamed contracts to generic names"
    ],
    "distractors": {
      "config_variables": 2,
      "score_variables": 25,
      "activity_variables": 0,
      "fake_functions": 4,
      "view_helpers": 2,
      "suspicious_names": 18
    },
    "contracts_renamed": [
      "LeveragedVault"
    ],
    "vulnerability_preserved": true,
    "documentation_removed": true,
    "created_date": "2025-12-30T01:40:33.662319"
  }
}