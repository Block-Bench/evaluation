{
  "sample_id": "tr_tc_025",
  "exploit_name": "Hundred Finance Reentrancy",
  "date": "2022-03-15",
  "amount_lost_usd": "6000000",
  "blockchain": "gnosis",
  "language": "solidity",
  "vulnerability_type": "reentrancy",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Hundred Finance (Compound fork) was exploited via ERC667 token hooks reentrancy. ERC667 tokens call recipient contracts during transfers. The borrow function transferred tokens before fully updating state, allowing attackers to re-enter and borrow multiple times with the same collateral.",
  "vulnerable_contract": "LendingMarket",
  "vulnerable_function": "",
  "vulnerable_lines": [],
  "attack_scenario": "1) Flash loan ERC667 tokens. 2) Call borrow() to initiate loan. 3) During token transfer, ERC667 hook calls back to attacker contract. 4) Attacker re-enters borrow() before first borrow state update completes. 5) Multiple borrows executed with same collateral. 6) Drained $6M from multiple markets on Gnosis chain.",
  "root_cause": "Compound fork didn't account for ERC667 token hooks that allow reentrancy during transfers. The borrow function violated checks-effects-interactions by transferring tokens before completing state updates, enabling multiple borrows within one transaction.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "reentrancy",
    "erc667",
    "compound_fork",
    "token_hooks",
    "gnosis",
    "trojan"
  ],
  "variant_type": "trojan",
  "variant_parent_id": "tc_025",
  "notes": "",
  "contract_file": "contracts/tr_tc_025.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "trojan",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_025.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_025.json",
    "script": "manual",
    "changes": [
      "Removed vulnerability documentation and comments",
      "Added distractor code (fake security metrics, config tracking)",
      "Added suspicious-named variables as red herrings",
      "Preserved original vulnerability",
      "Renamed contracts to generic names"
    ],
    "distractors": {
      "config_variables": 2,
      "score_variables": 18,
      "activity_variables": 0,
      "fake_functions": 3,
      "view_helpers": 2,
      "suspicious_names": 15
    },
    "contracts_renamed": [
      "LendingMarket"
    ],
    "vulnerability_preserved": true,
    "documentation_removed": true,
    "created_date": "2025-12-30T01:40:33.664034"
  }
}