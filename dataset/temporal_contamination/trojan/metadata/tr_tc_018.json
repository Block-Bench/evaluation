{
  "sample_id": "tr_tc_018",
  "exploit_name": "DODO Reinitialization",
  "date": "2021-03-09",
  "amount_lost_usd": "3800000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "reinitialization",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "DODO's liquidity pool contract had an init() function that could be called multiple times without proper access control or initialization guard. An attacker called init() again after deployment, setting themselves as the maintainer (fee recipient) and hijacking accumulated fees. The vulnerability allowed manipulation of critical pool parameters post-deployment.",
  "vulnerable_contract": "LiquidityPool",
  "vulnerable_function": "init",
  "vulnerable_lines": [
    37
  ],
  "attack_scenario": "1) Attacker identified DODO pool contracts without proper initialization locks. 2) Called init() with attacker-controlled parameters, setting maintainer address to attacker. 3) Since maintainer receives all swap fees, attacker could claim accumulated fees via claimFees(). 4) All future swap fees also redirected to attacker. 5) In some cases, could manipulate baseBalance/quoteBalance for profitable swaps. 6) Drained $3.8M from affected pools.",
  "root_cause": "The init() function lacked proper initialization protection (missing `require(!isInitialized)` check). This allowed attackers to call the initialization function again after deployment, overwriting critical parameters like the maintainer address and hijacking fee collection rights.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "initialization",
    "access_control",
    "dodo",
    "defi",
    "amm",
    "maintainer_hijack",
    "trojan"
  ],
  "variant_type": "trojan",
  "variant_parent_id": "tc_018",
  "notes": "",
  "contract_file": "contracts/tr_tc_018.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "trojan",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_021.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_021.json",
    "script": "manual",
    "changes": [
      "Removed vulnerability documentation and comments",
      "Added distractor code (fake security metrics, config tracking)",
      "Added suspicious-named variables as red herrings",
      "Preserved original vulnerability",
      "Renamed contracts to generic names"
    ],
    "distractors": {
      "config_variables": 2,
      "score_variables": 15,
      "activity_variables": 0,
      "fake_functions": 3,
      "view_helpers": 1,
      "suspicious_names": 10
    },
    "contracts_renamed": [
      "LiquidityPool"
    ],
    "vulnerability_preserved": true,
    "documentation_removed": true,
    "created_date": "2025-12-30T01:40:33.660475",
    "sanitized": true,
    "sanitization_date": "2026-01-02T02:10:09.763047",
    "code_renames": {}
  }
}