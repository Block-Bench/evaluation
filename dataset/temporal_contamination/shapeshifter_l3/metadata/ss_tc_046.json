{
  "sample_id": "ss_tc_046",
  "exploit_name": "FixedFloat",
  "timestamp": "2024-02",
  "loss_amount_usd": 26000000,
  "blockchain": "ethereum",
  "vulnerability_type": "access_control",
  "sub_category": "private_key_compromise",
  "severity": "critical",
  "tags": [
    "private_key_compromise",
    "hot_wallet",
    "single_key",
    "withdrawal",
    "timelock"
  ],
  "difficulty": "beginner",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-02",
  "description": "FixedFloat, a crypto exchange, lost $26M when attackers compromised the private key controlling hot wallet withdrawals. The single-key architecture with no multi-sig or timelock allowed immediate drainage of Bitcoin and Ethereum holdings.",
  "vulnerable_lines": [
    17
  ],
  "vulnerability_details": {
    "root_cause": "Single private key controlled withdrawal function without multi-signature or timelock protection",
    "attack_vector": "Compromise admin key via phishing/malware, call withdraw() to drain hot wallets",
    "vulnerable_functions": [
      "_0x347a3f()",
      "_0x8cd0a4()",
      "_0x0cce35()"
    ],
    "key_weakness": [
      "Single private key controls all funds",
      "No multi-signature requirement",
      "Missing timelock delay",
      "No withdrawal limits or rate limiting",
      "Insufficient monitoring and alerting",
      "No circuit breakers",
      "Hot wallet held excessive funds"
    ]
  },
  "attack_flow": [
    "Attacker compromises owner private key via phishing/malware",
    "With compromised key, call withdraw(WBTC, attackerAddress, balance)",
    "Withdraw ~$15M in Bitcoin without any delay or additional checks",
    "Call withdraw(address(0), attackerAddress, ethBalance)",
    "Withdraw ~$11M in Ethereum immediately",
    "Route funds through mixers to obfuscate trail",
    "No recovery possible due to blockchain irreversibility"
  ],
  "mitigation": [
    "Implement multi-signature wallet (3-of-5 or 4-of-7)",
    "Add timelock delay (24-48 hours) for large withdrawals",
    "Implement withdrawal limits per transaction/day",
    "Use Hardware Security Modules (HSM) for key storage",
    "Keep majority of funds in cold storage",
    "Add real-time monitoring and automatic alerts",
    "Implement pause mechanism for suspicious activity",
    "Regular key rotation and security audits",
    "Separate hot wallet operational funds from reserves"
  ],
  "references": [
    "https://blog.fixedfloat.com/",
    "https://twitter.com/FixedFloat/status/1758529373877465553"
  ],
  "contract_file": "contracts/ss_tc_046.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "shapeshifter_l3",
  "variant_parent_id": "nc_tc_046",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_046.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_046.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 12 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "authorizedOperators": "_0x390062",
      "transferOwnership": "_0x0cce35",
      "emergencyWithdraw": "_0x8cd0a4",
      "onlyOwner": "_0x7d6277",
      "balanceOf": "_0x7248ad",
      "newOwner": "_0x477183",
      "withdraw": "_0x347a3f",
      "account": "_0x2c833f",
      "amount": "_0xd80623",
      "owner": "_0x1045d1",
      "token": "_0x0f4194",
      "to": "_0x2ff8d2"
    },
    "coverage_percent": 54.55,
    "identifiers_transformed": 12,
    "created_date": "2025-12-31T19:59:41.245796"
  },
  "vulnerable_contract": "FloatHotWalletV2",
  "vulnerable_function": "_0x347a3f",
  "sanitized_from": "ms_tc_046"
}