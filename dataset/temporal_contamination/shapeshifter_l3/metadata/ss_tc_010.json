{
  "id": "the_dao_2016",
  "exploit_name": "The DAO",
  "date": "2016-06-17",
  "blockchain": "ethereum",
  "amount_stolen_usd": "60000000",
  "amount_stolen_crypto": "3600000 ETH",
  "vulnerability_type": "reentrancy",
  "attack_type": "recursive_call",
  "difficulty": 2,
  "impact": "critical",
  "description": "Classic reentrancy attack that drained 3.6M ETH from The DAO. The withdrawAll function sent ETH before updating balances, allowing attackers to recursively call the function and drain funds.",
  "root_cause": "External call to msg.sender before updating internal state (credit balance). Violation of checks-effects-interactions pattern.",
  "attack_scenario": "Attacker deposited ETH, then called withdrawAll from a malicious contract with a fallback function that re-entered withdrawAll, draining funds before balance was updated.",
  "vulnerable_contract": "DAO",
  "vulnerable_function": "_0x390062",
  "vulnerable_lines": [
    13,
    15
  ],
  "fix_description": "Move credit[msg.sender] = 0 before the external call, or use ReentrancyGuard modifier. Follow checks-effects-interactions pattern.",
  "tags": [
    "reentrancy",
    "classic",
    "historical",
    "checks-effects-interactions",
    "external-call"
  ],
  "references": [
    "https://www.coindesk.com/learn/2016/06/25/understanding-the-dao-attack/",
    "https://medium.com/@MyPaoG/explaining-the-dao-exploit-for-beginners-in-solidity-80ee84f0d470"
  ],
  "historical_significance": "Most famous smart contract hack ever. Led to Ethereum hard fork into ETH and ETC. Established security best practices for entire industry.",
  "compiler_version": "0.4.19",
  "is_pre_cutoff": true,
  "cutoff_date": "2024-01-01",
  "contract_file": "contracts/ss_tc_010.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "sample_id": "ss_tc_010",
  "variant_type": "shapeshifter_l3",
  "variant_parent_id": "nc_tc_010",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_010.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_010.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 7 identifiers using hex style",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "withdrawAll": "_0x390062",
      "callResult": "_0x0cce35",
      "getCredit": "_0x8cd0a4",
      "deposit": "_0x7d6277",
      "oCredit": "_0x7248ad",
      "credit": "_0x477183",
      "user": "_0x347a3f"
    },
    "coverage_percent": 41.18,
    "identifiers_transformed": 7,
    "created_date": "2025-12-31T19:59:41.155615"
  },
  "sanitized_from": "ms_tc_010"
}