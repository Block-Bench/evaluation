{
  "id": "qubit_bridge_2022_01",
  "exploit_name": "Qubit Bridge Zero Address Bypass",
  "date": "2022-01-27",
  "blockchain": "ethereum",
  "amount_lost_usd": "80000000",
  "vulnerability_type": "validation_bypass",
  "difficulty": 3,
  "tags": [
    "validation",
    "zero_address",
    "cross_chain",
    "access_control",
    "ethereum",
    "bsc"
  ],
  "description": "The Qubit Bridge failed to validate that the token contract address was not zero before processing deposits. An attacker exploited this by passing address(0) as the token contract. Since calling address(0) does not revert in the EVM, no tokens were actually transferred, but the bridge still emitted deposit events. The destination chain handler saw these events and minted tokens without real collateral backing, allowing the attacker to drain $80M.",
  "attack_scenario": "1) Attacker identified or created a resourceID that mapped to address(0) in the bridge handler. 2) Called deposit() with this resourceID and large amount. 3) Handler attempted transferFrom on address(0), which succeeded without transferring anything. 4) Bridge emitted deposit event. 5) BSC handler received event and minted tokens to attacker. 6) Attacker repeated the exploit multiple times to extract $80M worth of tokens without providing any real collateral.",
  "vulnerable_contract": "BridgeHandler",
  "root_cause": "The bridge handler did not validate that the token contract address was not zero. Calls to address(0) do not revert in the EVM, so the transferFrom call succeeded silently without moving any tokens. However, the deposit event was still emitted, causing the destination chain to mint unbacked tokens.",
  "vulnerable_lines": [
    42
  ],
  "fix": "Add explicit validation: require(tokenContract != address(0), 'Invalid token'). Also verify that tokenContract is in the whitelist and that the transferFrom actually succeeded by checking balance changes or return values.",
  "references": [
    "https://twitter.com/QubitFin/status/1486892916055601154",
    "https://certik.medium.com/qubit-bridge-collapse-exploited-to-the-tune-of-80-million-a7ab9068e1a0",
    "https://medium.com/quillhash/decoding-qubit-bridge-hack-d14cd2a5fb5f"
  ],
  "temporal_category": "pre_cutoff",
  "variant_type": "shapeshifter_l3",
  "checks_effects_interactions_violated": false,
  "involves_external_calls": true,
  "contract_file": "contracts/ss_tc_016.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "sample_id": "ss_tc_016",
  "variant_parent_id": "nc_tc_016",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_016.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_016.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 17 identifiers using hex style",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "resourceIDToTokenContractAddress": "_0x390062",
      "destinationDomainID": "_0x0cce35",
      "contractWhitelist": "_0x8cd0a4",
      "tokenContract": "_0x7d6277",
      "tokenAddress": "_0x7248ad",
      "transferFrom": "_0x477183",
      "depositNonce": "_0x347a3f",
      "setResource": "_0x2c833f",
      "resourceID": "_0xd80623",
      "depositer": "_0x1045d1",
      "balanceOf": "_0x0f4194",
      "_handler": "_0x2ff8d2",
      "deposit": "_0x6ff151",
      "handler": "_0x771f54",
      "account": "_0x0d961f",
      "amount": "_0x65ce0c",
      "to": "_0xd6cb4d"
    },
    "coverage_percent": 62.96,
    "identifiers_transformed": 17,
    "created_date": "2025-12-31T19:59:41.176924"
  },
  "vulnerable_function": "_0x6ff151",
  "sanitized_from": "ms_tc_016",
  "is_vulnerable": true
}