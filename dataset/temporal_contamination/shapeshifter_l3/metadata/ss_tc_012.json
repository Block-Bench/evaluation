{
  "id": "compound_tusd_2022",
  "exploit_name": "Compound cTUSD",
  "date": "2022-03-15",
  "blockchain": "ethereum",
  "amount_stolen_usd": "0",
  "amount_stolen_crypto": "N/A (funds returned)",
  "vulnerability_type": "logic_error",
  "attack_type": "token_sweep_exploit",
  "difficulty": 2,
  "impact": "medium",
  "description": "Token sweep function allowed sweeping upgraded TUSD token. The sweepToken function only checked against old TUSD address, not accounting for token upgrade to new address.",
  "root_cause": "After TUSD token upgrade, cTUSD contract still referenced old address as underlying. sweepToken only blocked old address, allowing new TUSD address to be swept despite being the actual underlying asset.",
  "attack_scenario": "TUSD upgraded from old to new contract address. cTUSD.sweepToken(newTUSD) was called. Check passed because newTUSD != oldTUSD. All TUSD swept from market. Exploiter returned funds.",
  "vulnerable_contract": "CToken",
  "vulnerable_function": "_0x8cd0a4",
  "vulnerable_lines": [
    25
  ],
  "fix_description": "Maintain mapping of all valid underlying addresses (old and new). Check against all addresses in sweepToken. Update contract when underlying token upgrades.",
  "tags": [
    "logic-error",
    "token-upgrade",
    "sweep-function",
    "address-mismatch"
  ],
  "references": [
    "https://etherscan.io/tx/0x0af5a6d2d8b49f68dcfd4599a0e767450e76e08a5aeba9b3d534a604d308e60b"
  ],
  "historical_significance": "Highlighted risks when underlying tokens upgrade. Showed importance of tracking all valid token addresses in integration contracts.",
  "compiler_version": "0.8.0",
  "is_pre_cutoff": true,
  "cutoff_date": "2024-01-01",
  "contract_file": "contracts/ss_tc_012.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "sample_id": "ss_tc_012",
  "variant_type": "shapeshifter_l3",
  "variant_parent_id": "nc_tc_012",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_012.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_012.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 12 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "accountTokens": "_0x390062",
      "totalSupply": "_0x0cce35",
      "sweepToken": "_0x8cd0a4",
      "underlying": "_0x7d6277",
      "balanceOf": "_0x7248ad",
      "account": "_0x477183",
      "redeem": "_0x347a3f",
      "amount": "_0x2c833f",
      "admin": "_0xd80623",
      "token": "_0x1045d1",
      "mint": "_0x0f4194",
      "to": "_0x2ff8d2"
    },
    "coverage_percent": 54.55,
    "identifiers_transformed": 12,
    "created_date": "2025-12-31T19:59:41.167435"
  },
  "sanitized_from": "ms_tc_012",
  "is_vulnerable": true
}