{
  "sample_id": "ss_tc_043",
  "exploit_name": "PlayDapp",
  "timestamp": "2024-02",
  "loss_amount_usd": 290000000,
  "blockchain": "ethereum",
  "vulnerability_type": "access_control",
  "sub_category": "unauthorized_minting",
  "severity": "critical",
  "tags": [
    "token",
    "minting",
    "private_key_compromise",
    "supply_manipulation",
    "single_key",
    "erc20"
  ],
  "difficulty": "beginner",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-02",
  "description": "PlayDapp's PLA token suffered a $290M exploit when attackers compromised a private key with minting privileges. They minted 1.79 billion tokens without restrictions, causing a 90% price collapse. The attack was repeated on the migration contract, demonstrating persistent access control vulnerabilities.",
  "vulnerable_lines": [
    29
  ],
  "vulnerability_details": {
    "root_cause": "Single private key controlled unlimited minting function without supply cap or multi-sig",
    "attack_vector": "Compromise minter key, call mint() repeatedly to create billions of tokens, dump on DEXes",
    "vulnerable_functions": [
      "_0xd6cb4d()",
      "_0x7d6277()"
    ],
    "key_weakness": [
      "Single minter key with unlimited power",
      "No supply cap enforcement",
      "No multi-signature requirement",
      "Missing rate limiting or cooldown",
      "No timelock delay",
      "No circuit breaker for unusual minting",
      "Same vulnerability in migration contract"
    ]
  },
  "attack_flow": [
    "Attacker compromises private key with MINTER_ROLE",
    "Call mint(attackerAddress, 1_790_000_000 * 10**18)",
    "Receive 1.79 billion PLA tokens (~$290M at time)",
    "Sell tokens across Uniswap, PancakeSwap, other DEXes",
    "Token price crashes from $0.16 to $0.016 (90% drop)",
    "PlayDapp deploys new token contract for migration",
    "Attacker gains access to new contract's minter key",
    "Mint additional 1.59 billion tokens on new contract",
    "Further market damage and user confidence loss"
  ],
  "mitigation": [
    "Implement hard supply cap: MAX_SUPPLY = 1B tokens",
    "Require multi-signature (3-of-5) for all minting",
    "Add timelock delay (24-48 hours) for mint operations",
    "Implement daily minting limits with rate limiting",
    "Use predefined vesting schedule, no ad-hoc minting",
    "Add circuit breakers for unusual minting patterns",
    "Store minter keys in Hardware Security Modules",
    "Real-time alerts for any minting activity",
    "Consider non-mintable design with fixed supply"
  ],
  "references": [
    "https://twitter.com/playdapp_io",
    "https://etherscan.io/token/0x3a4f40631a4f906c2BaD353Ed06De7A5D3fCb430"
  ],
  "contract_file": "contracts/ss_tc_043.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "shapeshifter_l3",
  "variant_parent_id": "nc_tc_043",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_043.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_043.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 19 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "transferFrom": "_0x390062",
      "totalSupply": "_0x0cce35",
      "onlyMinter": "_0x8cd0a4",
      "setMinter": "_0x7d6277",
      "allowance": "_0x7248ad",
      "newMinter": "_0x477183",
      "balanceOf": "_0x347a3f",
      "decimals": "_0x2c833f",
      "account": "_0xd80623",
      "approve": "_0x1045d1",
      "spender": "_0x0f4194",
      "minter": "_0x2ff8d2",
      "amount": "_0x6ff151",
      "symbol": "_0x771f54",
      "owner": "_0x0d961f",
      "_mint": "_0x65ce0c",
      "mint": "_0xd6cb4d",
      "name": "_0x70dd97",
      "to": "_0xe5feba"
    },
    "coverage_percent": 65.52,
    "identifiers_transformed": 19,
    "created_date": "2025-12-31T19:59:41.248310"
  },
  "vulnerable_contract": "GameToken",
  "vulnerable_function": "_0xd6cb4d",
  "sanitized_from": "ms_tc_043",
  "is_vulnerable": true
}