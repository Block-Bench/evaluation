{
  "sample_id": "ss_tc_041",
  "exploit_name": "Shezmu Protocol",
  "timestamp": "2024-09",
  "loss_amount_usd": 4900000,
  "blockchain": "ethereum",
  "vulnerability_type": "access_control",
  "sub_category": "missing_access_control",
  "severity": "critical",
  "tags": [
    "access_control",
    "mint_vulnerability",
    "authorization"
  ],
  "difficulty": "beginner",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-09",
  "description": "Shezmu, a CDP protocol, was exploited for $4.9M when attackers discovered the collateral token's mint() function had no access control. Anyone could mint unlimited collateral tokens, deposit them into the vault, and borrow real ShezUSD against worthless minted collateral.",
  "vulnerable_lines": [
    19
  ],
  "vulnerability_details": {
    "root_cause": "Missing access control modifier on mint() function allowing anyone to mint unlimited tokens",
    "attack_vector": "Mint maximum collateral tokens without authorization, deposit as collateral, borrow real assets",
    "vulnerable_functions": [
      "_0xae3550()",
      "_0x51bedd()"
    ],
    "key_weakness": [
      "No owner/admin check on mint()",
      "No role-based access control",
      "No minting limits or caps",
      "Vault accepts illegitimately minted collateral",
      "No token origin validation",
      "Missing pause functionality"
    ]
  },
  "attack_flow": [
    "Discover mint() function has no access control",
    "Call mint(attackerAddress, type(uint128).max - 1)",
    "Receive ~1.7e38 worthless collateral tokens at no cost",
    "Approve vault to spend minted collateral",
    "Deposit minted collateral into Shezmu vault",
    "Calculate maximum borrow based on 150% collateral ratio",
    "Borrow $4.9M worth of real ShezUSD tokens",
    "Transfer borrowed ShezUSD to attacker wallet",
    "Abandon worthless collateral position"
  ],
  "mitigation": [
    "Add onlyOwner or role-based modifier to mint()",
    "Implement OpenZeppelin AccessControl",
    "Add minting limits and rate limiting",
    "Implement supply caps on total minting",
    "Add circuit breakers for unusual minting",
    "Require multi-sig for minting operations",
    "Monitor for large mints and auto-pause",
    "Add collateral token whitelist validation in vault"
  ],
  "references": [
    "https://medium.com/coinmonks/decoding-shezmus-4-9-million-exploit-10dc0266b25b",
    "https://x.com/shoucccc/status/1837228053862437244",
    "https://etherscan.io/address/0x641249dB01d5C9a04d1A223765fFd15f95167924"
  ],
  "contract_file": "contracts/ss_tc_041.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "shapeshifter_l3",
  "variant_parent_id": "nc_tc_041",
  "transformation": {
    "type": "shapeshifter",
    "level": "l3",
    "includes": [
      "L1 formatting",
      "L2 hex identifiers",
      "L3 control flow"
    ],
    "identifier_style": "hex",
    "intensity": "medium",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_041.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_041.json",
    "script": "strategies/shapeshifter/shapeshifter_tc.py",
    "changes": [
      "Stripped existing line markers",
      "Renamed 26 identifiers using hex style",
      "Wrapped assignment in conditional",
      "Applied L1 tight formatting (removed blank lines, K&R braces)",
      "Added fresh sequential line markers"
    ],
    "rename_map": {
      "remainingCollateral": "_0x390062",
      "withdrawCollateral": "_0x0cce35",
      "collateralBalance": "_0x8cd0a4",
      "_collateralToken": "_0x7d6277",
      "collateralToken": "_0x7248ad",
      "addCollateral": "_0x477183",
      "transferFrom": "_0x347a3f",
      "totalSupply": "_0x2c833f",
      "debtBalance": "_0xd80623",
      "allowance": "_0x1045d1",
      "balanceOf": "_0x0f4194",
      "maxBorrow": "_0x2ff8d2",
      "decimals": "_0x6ff151",
      "_shezUSD": "_0x771f54",
      "account": "_0x0d961f",
      "maxDebt": "_0x65ce0c",
      "approve": "_0xd6cb4d",
      "spender": "_0x70dd97",
      "shezUSD": "_0xe5feba",
      "amount": "_0x8e6f03",
      "symbol": "_0x0353ce",
      "borrow": "_0x51bedd",
      "repay": "_0xd860ea",
      "mint": "_0xae3550",
      "name": "_0x8e4527",
      "to": "_0x4f9b02"
    },
    "coverage_percent": 72.22,
    "identifiers_transformed": 26,
    "created_date": "2025-12-31T19:59:41.234843"
  },
  "vulnerable_contract": "CollateralToken",
  "vulnerable_function": "_0xae3550",
  "sanitized_from": "ms_tc_041"
}