{
  "sample_id": "fp_tc_025",
  "exploit_name": "BVaults SafeMoon Drain",
  "date": "2021-05-30",
  "amount_lost_usd": "8500000",
  "blockchain": "binance_smart_chain",
  "language": "solidity",
  "vulnerability_type": "accounting_error",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "BVaults didn't account for deflationary tokens (like SafeMoon) that burn a percentage on transfer. The vault credited users for the full deposit amount but only received a reduced amount after fees, allowing withdrawals that drained more than deposited.",
  "vulnerable_contract": "Vault",
  "vulnerable_function": "deposit",
  "vulnerable_lines": [
    50
  ],
  "attack_scenario": "1) Deflationary token charges 10% fee on transfers. 2) Attacker deposits 100 tokens. 3) Vault receives only 90 tokens (10% burned as fee). 4) Vault credits attacker's account with full 100 tokens. 5) Attacker withdraws 100 tokens. 6) Vault sends 100 but only had 90 plus other users' funds. 7) Repeated deposits/withdrawals to drain $8.5M.",
  "root_cause": "Vault assumed tokens received equal amount transferred. Didn't check actual balance increase before/after transfer. Deflationary tokens with transfer fees caused accounting mismatch between credited amounts and actual holdings.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "transfer_fee",
    "deflationary_token",
    "accounting",
    "vault",
    "decoy",
    "false_prophet",
    "bsc"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_025",
  "notes": "",
  "contract_file": "contracts/fp_tc_025.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_025.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_025.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "DEPOSIT FUNCTION",
        "description": "Critical vulnerability obscured:",
        "comments_added": [
          "Critical vulnerability obscured:"
        ]
      },
      {
        "location": "WITHDRAW FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      }
    ],
    "manual_enhancements_count": 4,
    "contract_type": "Deflationary Token with Vault Integration",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.937461",
    "sanitized": true,
    "sanitization_date": "2026-01-02T00:36:44.056376",
    "contract_renames": {}
  }
}
