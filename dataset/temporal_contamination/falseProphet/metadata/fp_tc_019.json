{
  "sample_id": "fp_tc_019",
  "exploit_name": "Qubit Bridge Zero Address Bypass",
  "date": "2022-01-27",
  "amount_lost_usd": "80000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "validation_bypass",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "The Qubit Bridge failed to validate that the token contract address was not zero before processing deposits. An attacker exploited this by passing address(0) as the token contract. Since calling address(0) does not revert in the EVM, no tokens were actually transferred, but the bridge still emitted deposit events. The destination chain handler saw these events and minted tokens without real collateral backing, allowing the attacker to drain $80M.",
  "vulnerable_contract": {
    "name": "QBridgeHandler",
    "functions": [
      {
        "name": "deposit",
        "vulnerability": "Missing validation that tokenContract != address(0)"
      },
      {
        "name": "setResource",
        "vulnerability": "Allows setting tokenAddress to address(0) without validation"
      }
    ]
  },
  "vulnerable_function": "",
  "vulnerable_lines": [],
  "attack_scenario": "1) Attacker identified or created a resourceID that mapped to address(0) in the bridge handler. 2) Called deposit() with this resourceID and large amount. 3) Handler attempted transferFrom on address(0), which succeeded without transferring anything. 4) Bridge emitted deposit event. 5) BSC handler received event and minted tokens to attacker. 6) Attacker repeated the exploit multiple times to extract $80M worth of tokens without providing any real collateral.",
  "root_cause": "The bridge handler did not validate that the token contract address was not zero. Calls to address(0) do not revert in the EVM, so the transferFrom call succeeded silently without moving any tokens. However, the deposit event was still emitted, causing the destination chain to mint unbacked tokens.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "validation",
    "cross_chain",
    "bridge",
    "access_control",
    "ethereum",
    "decoy",
    "false_prophet",
    "bsc",
    "zero_address"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_019",
  "notes": "",
  "contract_file": "contracts/fp_tc_019.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_019.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_019.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "QBRIDGE CONTRACT HEADER",
        "description": "Professional bridge documentation:",
        "comments_added": [
          "Added: \"Cross-chain asset bridge with deposit verification\"",
          "Added: \"Audited by Halborn Security (Q4 2021) - All findings addressed\"",
          "Added: \"Implements ChainBridge standard with handler delegation pattern\"",
          "Added: \"Uses resource ID mapping for multi-token support\""
        ]
      },
      {
        "location": "HANDLER DEPOSIT FUNCTION",
        "description": "Critical vulnerability obscured:",
        "comments_added": [
          "Critical vulnerability obscured:"
        ]
      }
    ],
    "manual_enhancements_count": 7,
    "contract_type": "Cross-Chain Bridge / Handler Pattern",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.931495"
  }
}