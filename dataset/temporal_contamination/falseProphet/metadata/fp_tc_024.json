{
  "sample_id": "fp_tc_024",
  "exploit_name": "BurgerSwap Fake Token",
  "date": "2021-05-28",
  "amount_lost_usd": "7000000",
  "blockchain": "binance_smart_chain",
  "language": "solidity",
  "vulnerability_type": "input_validation",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "BurgerSwap router didn't validate that token pairs were from the official factory. Attackers created fake tokens and malicious pairs with manipulated reserves, then used the router to swap through these fake pairs to extract real tokens at manipulated prices.",
  "vulnerable_contract": "SwapRouter",
  "vulnerable_function": "swapExactTokensForTokens",
  "vulnerable_lines": [
    27,
    37
  ],
  "attack_scenario": "1) Attacker created fake token contracts mimicking legitimate addresses. 2) Created malicious pair contract with manipulated reserves (e.g., 1 fake token = 1000 real tokens). 3) Called router swap function with path through fake token. 4) Router accepted fake pair without factory validation. 5) Executed swap at manipulated price. 6) Extracted $7M in real tokens.",
  "root_cause": "Router's swap function didn't verify that pairs came from the official factory. It accepted any pair address provided in the path, allowing attackers to inject fake pairs with arbitrary reserve ratios.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "amm",
    "uniswap_fork",
    "decoy",
    "fake_token",
    "false_prophet",
    "bsc",
    "pair_validation"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_024",
  "notes": "",
  "contract_file": "contracts/fp_tc_024.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_024.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_024.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "CONTRACT HEADER",
        "description": "Professional DEX documentation:",
        "comments_added": [
          "Added: \"DEX router for token swaps via liquidity pools\"",
          "Added: \"Audited by SlowMist (Q2 2021) - All findings resolved\"",
          "Added: \"Implements Uniswap V2 style routing with path support\"",
          "Added: \"Uses CREATE2 pair address derivation for gas efficiency\""
        ]
      },
      {
        "location": "SWAPEXACTTOKENSFORTOKENS FUNCTION",
        "description": "Critical vulnerability obscured:",
        "comments_added": [
          "Added: \"@dev Routes through multiple pairs following the path\""
        ]
      }
    ],
    "manual_enhancements_count": 3,
    "contract_type": "DEX Router with Path Swapping",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.936858",
    "sanitized": true,
    "sanitization_date": "2026-01-02T00:36:44.013538",
    "contract_renames": {
      "BurgerSwapRouter": "SwapRouter"
    }
  }
}
