{
  "sample_id": "fp_tc_032",
  "exploit_name": "Radiant Capital Rounding Exploit",
  "date": "",
  "amount_lost_usd": "",
  "blockchain": "arbitrum",
  "language": "solidity",
  "vulnerability_type": "arithmetic_manipulation",
  "vulnerability_subtype": "",
  "severity": "high",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Radiant Capital (Aave V2 fork on Arbitrum) was exploited for $4.5M through manipulation of the liquidityIndex via repeated flashloan cycles. The attacker executed 151 nested flashloans to inflate the liquidityIndex to extreme values, causing rounding errors in the rayDiv function that allowed extracting more funds than deposited.",
  "vulnerable_contract": "",
  "vulnerable_function": "",
  "vulnerable_lines": [],
  "attack_scenario": "",
  "root_cause": "",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "time_manipulation",
    "liquidity_index",
    "fixed_point_arithmetic",
    "rounding_error",
    "aave_fork",
    "lending",
    "flashloan",
    "decoy",
    "false_prophet"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_032",
  "notes": "",
  "contract_file": "contracts/fp_tc_032.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_032.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_032.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "CONTRACT HEADER",
        "description": "Professional lending documentation:",
        "comments_added": [
          "Added: \"Aave-compatible lending pool with flash loan support\"",
          "Added: \"Audited by Trail of Bits (Q1 2023) - All findings resolved\"",
          "Added: \"Implements ray mathematics for precise interest accrual\"",
          "Added: \"Supports deposit, withdraw, borrow, and flash loans\""
        ]
      },
      {
        "location": "RESERVEDATA STRUCT",
        "description": "Clear documentation:",
        "comments_added": [
          "Added: \"/// @dev Current liquidity index for interest accrual\"",
          "Added: \"/// @dev Total liquidity in reserve\"",
          "Added: \"/// @dev Interest-bearing token address\""
        ]
      },
      {
        "location": "DEPOSIT FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      },
      {
        "location": "WITHDRAW FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      },
      {
        "location": "FLASHLOAN FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      }
    ],
    "manual_enhancements_count": 5,
    "contract_type": "Aave-Style Lending Pool with Flash Loans",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.939981"
  }
}