{
  "sample_id": "fp_tc_015",
  "exploit_name": "Compound cTUSD",
  "date": "2022-03-15",
  "amount_lost_usd": "",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "logic_error",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "",
  "description": "Token sweep function allowed sweeping upgraded TUSD token. The sweepToken function only checked against old TUSD address, not accounting for token upgrade to new address.",
  "vulnerable_contract": "compound_tusd.sol",
  "vulnerable_function": "sweepToken",
  "vulnerable_lines": [],
  "attack_scenario": "TUSD upgraded from old to new contract address. cTUSD.sweepToken(newTUSD) was called. Check passed because newTUSD != oldTUSD. All TUSD swept from market. Exploiter returned funds.",
  "root_cause": "After TUSD token upgrade, cTUSD contract still referenced old address as underlying. sweepToken only blocked old address, allowing new TUSD address to be swept despite being the actual underlying asset.",
  "fix_description": "Maintain mapping of all valid underlying addresses (old and new). Check against all addresses in sweepToken. Update contract when underlying token upgrades.",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "address-mismatch",
    "logic-error",
    "sweep-function",
    "compound",
    "token-upgrade",
    "decoy",
    "false_prophet"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_015",
  "notes": "",
  "contract_file": "contracts/fp_tc_015.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_015.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_015.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "CONTRACT HEADER",
        "description": "Compound protocol credibility:",
        "comments_added": [
          "Added: \"Audited by OpenZeppelin (Q4 2020) - All findings addressed\"",
          "Added: \"Implements cToken standard with supply and redeem functions\"",
          "Added: \"Sweep function protected for underlying token security\""
        ]
      },
      {
        "location": "STATE VARIABLES",
        "description": "Professional documentation:",
        "comments_added": [
          "Added: \"/// @dev Protected underlying asset for this market\"",
          "Changed: \"// Old TUSD address\" -> \"// Token address for sweep protection\"",
          "Added: \"/// @dev Protocol administrator\"",
          "Added: \"/// @dev User cToken balances\"",
          "Added: \"/// @dev Token addresses for TUSD integration\"",
          "Changed: \"// The actual TUSD token was upgraded...\"",
          "Added: \"/// @dev Current TUSD token address\"",
          "Changed: \"// Contract references old TUSD address\""
        ]
      }
    ],
    "manual_enhancements_count": 3,
    "contract_type": "Compound cToken / Lending Market",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.926673"
  }
}