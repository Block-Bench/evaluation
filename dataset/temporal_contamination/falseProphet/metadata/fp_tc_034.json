{
  "sample_id": "fp_tc_034",
  "exploit_name": "UwU Lend Oracle Manipulation",
  "date": "",
  "amount_lost_usd": "",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "price_oracle_manipulation",
  "vulnerability_subtype": "",
  "severity": "critical",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "UwU Lend, an Aave V2 fork, was exploited for $19.3M through oracle price manipulation. Attackers used massive flashloans to drain liquidity from Curve pools containing sUSDE, causing the oracle to report inflated prices. They then deposited sUSDE as collateral at the manipulated price and borrowed maximum assets against it.",
  "vulnerable_contract": "LendingPool",
  "vulnerable_function": "deposit",
  "vulnerable_lines": [
    97,
    148
  ],
  "attack_scenario": "",
  "root_cause": "",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "price_manipulation",
    "aave_fork",
    "lending",
    "curve_pools",
    "collateral_inflation",
    "flashloan",
    "decoy",
    "false_prophet",
    "oracle_manipulation"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_034",
  "notes": "",
  "contract_file": "contracts/fp_tc_034.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_034.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_034.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "BORROW FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      },
      {
        "location": "GETASSETPRICE FUNCTION",
        "description": "Critical vulnerability obscured:",
        "comments_added": [
          "Critical vulnerability obscured:"
        ]
      }
    ],
    "manual_enhancements_count": 4,
    "contract_type": "Aave-Compatible Lending with Curve Oracle",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.943491",
    "sanitized": true,
    "sanitization_date": "2026-01-02T00:36:44.559299",
    "contract_renames": {
      "CurvePool": "StablePool",
      "UwuLendingPool": "LendingPool",
      "ICurvePool": "IStablePool",
      "CurveOracle": "PoolOracle"
    }
  }
}
