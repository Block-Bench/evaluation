{
  "sample_id": "fp_tc_036",
  "exploit_name": "Prisma Finance Delegate Approval",
  "date": "",
  "amount_lost_usd": "",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "",
  "severity": "critical",
  "difficulty_tier": 0,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Prisma Finance suffered a $10M exploit through its MigrateTroveZap contract which accepted user-controlled account parameters. Attackers exploited delegate approvals to open troves and mint debt tokens on behalf of victims who had approved the zap contract, then received the minted tokens themselves.",
  "vulnerable_contract": "",
  "vulnerable_function": "",
  "vulnerable_lines": [],
  "attack_scenario": "",
  "root_cause": "",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "delegate_approval",
    "access_control",
    "authorization_bypass",
    "lending",
    "decoy",
    "false_prophet",
    "migration",
    "zap_contract",
    "cdp"
  ],
  "variant_type": "false_prophet",
  "variant_parent_id": "tc_036",
  "notes": "",
  "contract_file": "contracts/fp_tc_036.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "false_prophet",
    "strategy": "decoy",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_036.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_036.json",
    "script": "manual",
    "changes": [
      "Added misleading security comments and NatSpec documentation",
      "Added fake audit claims and security attestations",
      "Added reassuring comments near vulnerable code sections",
      "Preserved original vulnerability without modification"
    ],
    "false_prophet_enhancements": [
      {
        "location": "OPENTROVEANDMIGRATE FUNCTION",
        "description": "Critical vulnerability obscured:",
        "comments_added": [
          "Critical vulnerability obscured:"
        ]
      },
      {
        "location": "OPENTROVE FUNCTION",
        "description": "Vulnerability obscured:",
        "comments_added": [
          "Vulnerability obscured:"
        ]
      }
    ],
    "manual_enhancements_count": 4,
    "contract_type": "Trove Migration Helper with Delegate Support",
    "vulnerability_preserved": true,
    "misleading_comments_added": true,
    "created_date": "2025-12-30T21:14:14.942787"
  }
}