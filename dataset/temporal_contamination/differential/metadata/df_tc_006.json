{
  "sample_id": "df_tc_006",
  "exploit_name": "Ronin Bridge",
  "date": "2022-03-23",
  "amount_lost_usd": "625000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "centralization_key_compromise",
  "severity": "critical",
  "difficulty_tier": 4,
  "is_vulnerable": false,
  "temporal_category": "pre_cutoff",
  "description": "Fixed version with multi-sig requirement for admin function addSupportedToken",
  "vulnerable_contract": "CrossChainBridge",
  "vulnerable_function": "addSupportedToken",
  "vulnerable_lines": [],
  "attack_scenario": "Attackers (Lazarus Group) compromised Sky Mavis infrastructure through social engineering and gained access to private keys for 4 validators directly controlled by Sky Mavis and 1 DAO validator that Sky Mavis had temporary access to. With 5 out of 9 required validator keys, attackers created fake withdrawal transactions with genuinely valid signatures. Bridge contract verified signatures (all valid), processed withdrawals, and transferred $625M to attacker addresses.",
  "root_cause": "The addSupportedToken() admin function had no access control - anyone could call it to add arbitrary tokens. While the withdrawERC20For function requires multi-sig, administrative functions lacked the same protection, creating an attack vector for adding malicious tokens.",
  "fix_description": "Increase total validator count significantly. Ensure no single entity controls multiple validators. Implement hardware security modules (HSMs) for key storage. Use Multi-Party Computation (MPC) threshold signatures instead of simple multi-sig. Require geographic and organizational diversity among validators. Implement real-time monitoring and anomaly detection for unusual withdrawals. Add withdrawal limits and timelocks for large amounts. Use cold wallets with delays for large reserves. Conduct regular security audits and penetration testing.",
  "source_reference": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2022-03/Ronin_exp.sol",
  "external_references": [
    "https://roninblockchain.substack.com/p/community-alert-ronin-validators",
    "https://www.coindesk.com/tech/2022/03/29/axie-infinitys-ronin-network-suffers-625m-exploit/",
    "https://rekt.news/ronin-rekt/"
  ],
  "tags": [
    "multi_sig",
    "key_compromise",
    "centralization",
    "access_control",
    "infrastructure",
    "historical",
    "mega_hack",
    "lazarus_group",
    "differential",
    "fixed"
  ],
  "variant_type": "differential",
  "variant_parent_id": "tc_006",
  "notes": "Largest bridge hack in crypto history at the time. Attributed to North Korean Lazarus Group state hackers. Took 6 days before the hack was discovered. Demonstrates that smart contract security extends beyond code - key management, infrastructure security, and true decentralization are critical. The signature verification logic was perfect, but validator centralization made it useless.",
  "contract_file": "contracts/df_tc_006.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "differential",
    "strategy": "minimal_fix",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_006.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_006.json",
    "pair_metadata": "/Users/poamen/projects/grace/blockbench/base/data/manual_strategies/differential/metadata/df_pair_tc_006.json",
    "script": "manual",
    "is_fixed_version": true,
    "fix_type": "admin_access_control",
    "fix_description": "Added multi-sig signature verification to addSupportedToken function (lines 181-194). Now requires valid validator signatures to add new tokens, preventing unauthorized token additions.",
    "exact_changes": [
      {
        "location": "addSupportedToken function signature (line 181)",
        "version_a": "function addSupportedToken(address _token, bytes memory _signatures) external {",
        "version_b": "function addSupportedToken(address _token) external {"
      },
      {
        "location": "addSupportedToken function body (lines 182-193)",
        "version_a": "require(!supportedTokens[_token], \"Already supported\");\nrequire(_verifySignatures(...), \"Invalid signatures\");\nsupportedTokens[_token] = true;",
        "version_b": "supportedTokens[_token] = true;"
      }
    ],
    "why_fix_works": "The minimal fix adds multi-sig protection to admin functions, ensuring that critical operations like adding supported tokens require consensus among validators, preventing single-point-of-failure attacks on administrative capabilities.",
    "contracts_in_file": [
      "CrossChainBridge",
      "address"
    ],
    "created_date": "2025-12-30T02:02:17.926582"
  }
}