{
  "sample_id": "df_tc_041",
  "exploit_name": "Shezmu Protocol",
  "date": "",
  "amount_lost_usd": "",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "",
  "severity": "critical",
  "difficulty_tier": 0,
  "is_vulnerable": false,
  "temporal_category": "pre_cutoff",
  "description": "Fixed version with onlyOwner access control on mint function",
  "vulnerable_contract": "ShezmuCollateralToken",
  "vulnerable_function": "mint",
  "vulnerable_lines": [],
  "attack_scenario": "",
  "root_cause": "The mint() function has no access control, allowing anyone to mint arbitrary amounts of collateral tokens. These tokens can then be used as collateral to borrow real assets from the vault.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "cdp",
    "access_control",
    "mint_vulnerability",
    "collateral",
    "lending",
    "authorization",
    "differential",
    "fixed"
  ],
  "variant_type": "differential",
  "variant_parent_id": "tc_041",
  "notes": "",
  "contract_file": "contracts/df_tc_041.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "differential",
    "strategy": "minimal_fix",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_041.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_041.json",
    "pair_metadata": "/Users/poamen/projects/grace/blockbench/base/data/manual_strategies/differential/metadata/df_pair_tc_041.json",
    "script": "manual",
    "is_fixed_version": true,
    "fix_type": "access_control_modifier",
    "fix_description": "Added owner state variable, constructor to set owner, onlyOwner modifier, and applied onlyOwner to mint() function to restrict minting to contract owner only.",
    "exact_changes": [
      {
        "location": "state variable (line 24)",
        "version_a": "address public owner;",
        "version_b": "// No owner variable"
      },
      {
        "location": "constructor (lines 26-28)",
        "version_a": "constructor() { owner = msg.sender; }",
        "version_b": "// No constructor"
      },
      {
        "location": "modifier (lines 30-33)",
        "version_a": "modifier onlyOwner() { require(msg.sender == owner, \"Not owner\"); _; }",
        "version_b": "// No modifier"
      },
      {
        "location": "mint function (line 35)",
        "version_a": "function mint(address to, uint256 amount) external onlyOwner {",
        "version_b": "function mint(address to, uint256 amount) external {"
      }
    ],
    "why_fix_works": "Access control on mint prevents unauthorized token creation, ensuring only the owner can mint tokens and collateral value remains genuine.",
    "contracts_in_file": [
      "ShezmuCollateralToken",
      "ShezmuVault"
    ],
    "created_date": "2025-12-30T02:02:17.950359"
  }
}