{
  "sample_id": "df_tc_028",
  "exploit_name": "BVaults SafeMoon Drain",
  "date": "2021-05-30",
  "amount_lost_usd": "8500000",
  "blockchain": "binance_smart_chain",
  "language": "solidity",
  "vulnerability_type": "accounting_error",
  "vulnerability_subtype": "",
  "severity": "",
  "difficulty_tier": 0,
  "is_vulnerable": false,
  "temporal_category": "pre_cutoff",
  "description": "Fixed version with minimal changes to address the vulnerability",
  "vulnerable_contract": "TokenVault",
  "vulnerable_function": null,
  "vulnerable_lines": [],
  "attack_scenario": "1) Deflationary token charges 10% fee on transfers. 2) Attacker deposits 100 tokens. 3) Vault receives only 90 tokens (10% burned as fee). 4) Vault credits attacker's account with full 100 tokens. 5) Attacker withdraws 100 tokens. 6) Vault sends 100 but only had 90 plus other users' funds. 7) Repeated deposits/withdrawals to drain $8.5M.",
  "root_cause": "Vault assumed tokens received equal amount transferred. Didn't check actual balance increase before/after transfer. Deflationary tokens with transfer fees caused accounting mismatch between credited amounts and actual holdings.",
  "fix_description": "",
  "source_reference": "",
  "external_references": [],
  "tags": [
    "deflationary_token",
    "transfer_fee",
    "vault",
    "bsc",
    "accounting",
    "differential",
    "fixed"
  ],
  "variant_type": "differential",
  "variant_parent_id": "tc_028",
  "notes": "",
  "contract_file": "contracts/df_tc_028.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "differential",
    "strategy": "minimal_fix",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/contracts/tc_028.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/original/metadata/tc_028.json",
    "pair_metadata": "/Users/poamen/projects/grace/blockbench/base/data/manual_strategies/differential/metadata/df_pair_tc_028.json",
    "script": "manual",
    "is_fixed_version": true,
    "fix_type": "minimal_fix",
    "fix_description": "",
    "exact_changes": [],
    "why_fix_works": "",
    "contracts_in_file": [
      "TokenVault"
    ],
    "created_date": "2025-12-30T02:02:17.939915"
  }
}