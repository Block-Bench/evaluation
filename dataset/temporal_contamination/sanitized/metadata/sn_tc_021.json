{
  "id": "dodo_reinit_2021_03",
  "exploit_name": "DODO Reinitialization",
  "date": "2021-03-09",
  "blockchain": "ethereum",
  "amount_lost_usd": "3800000",
  "vulnerability_type": "reinitialization",
  "difficulty": 3,
  "tags": [
    "initialization",
    "access_control",
    "defi",
    "amm",
    "maintainer_hijack"
  ],
  "description": "DODO's liquidity pool contract had an init() function that could be called multiple times without proper access control or initialization guard. An attacker called init() again after deployment, setting themselves as the maintainer (fee recipient) and hijacking accumulated fees. The vulnerability allowed manipulation of critical pool parameters post-deployment.",
  "attack_scenario": "1) Attacker identified DODO pool contracts without proper initialization locks. 2) Called init() with attacker-controlled parameters, setting maintainer address to attacker. 3) Since maintainer receives all swap fees, attacker could claim accumulated fees via claimFees(). 4) All future swap fees also redirected to attacker. 5) In some cases, could manipulate baseBalance/quoteBalance for profitable swaps. 6) Drained $3.8M from affected pools.",
  "vulnerable_contract": "LiquidityPool",
  "root_cause": "The init() function lacked proper initialization protection (missing `require(!isInitialized)` check). This allowed attackers to call the initialization function again after deployment, overwriting critical parameters like the maintainer address and hijacking fee collection rights.",
  "vulnerable_lines": [
    37
  ],
  "fix": "Add initialization guard: `require(!initialized, 'Already initialized')` at the start of init(). Better approach: use OpenZeppelin's Initializable pattern with the `initializer` modifier which prevents reinitialization. For upgradeable contracts, use `initializer` and `reinitializer(version)` modifiers appropriately.",
  "references": [
    "https://blog.dodoex.io/dodo-pool-incident-postmortem-with-a-little-help-from-our-friends-327e66872d42",
    "https://twitter.com/DODOexchange/status/1369478893390807040",
    "https://medium.com/dodoex/dodo-security-incident-analysis-8fbbb7448e8c"
  ],
  "temporal_category": "pre_cutoff",
  "variant_type": "sanitized",
  "checks_effects_interactions_violated": false,
  "involves_external_calls": true,
  "contract_file": "contracts/sn_tc_021.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "sample_id": "sn_tc_021",
  "variant_parent_id": "tc_021",
  "transformation": {
    "type": "full_sanitization_from_minimalsanitized",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_021.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_021.json",
    "original_id": "tc_021",
    "minimalsanitized_id": "ms_tc_021",
    "script": "strategies/sanitize/sanitize_on_minimal_sanitize.py",
    "changes": [
      "Removed comment: DODO...",
      "Renamed: DODOPool \u2192 LiquidityPool"
    ],
    "contract_renames": {
      "DODOPool": "LiquidityPool"
    },
    "created_date": "2025-12-31T20:00:32.121440"
  },
  "vulnerable_function": "init",
  "sanitized_from": "ms_tc_021"
}