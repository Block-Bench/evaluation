{
  "sample_id": "sn_tc_003",
  "exploit_name": "Parity Wallet",
  "date": "2017-11-06",
  "amount_lost_usd": "150000000",
  "blockchain": "ethereum",
  "language": "solidity",
  "vulnerability_type": "access_control",
  "vulnerability_subtype": "unprotected_initialization_delegatecall",
  "severity": "critical",
  "difficulty_tier": 4,
  "is_vulnerable": true,
  "temporal_category": "pre_cutoff",
  "description": "Parity multi-sig wallet library vulnerability where anyone could call initWallet() on the shared library contract to become owner, then call kill() to selfdestruct it. This permanently froze $150M+ across 587 wallet contracts that relied on the destroyed library. The bug was accidentally triggered by a user, not a malicious attacker.",
  "vulnerable_contract": "WalletLibrary",
  "vulnerable_function": "kill",
  "vulnerable_lines": [
    20,
    62
  ],
  "attack_scenario": "User calls initWallet() directly on the WalletLibrary contract (not via delegatecall from a proxy), becoming the owner of the library itself. User then calls kill() function which executes selfdestruct, destroying the library contract. All 587 wallet proxies that delegatecall to this library are now permanently frozen with no way to access funds.",
  "root_cause": "The library contract's initWallet() function had no access control preventing direct calls. In the proxy pattern, libraries should never have initialization functions that can be called directly. Combined with a kill() function containing selfdestruct, this allowed anyone to destroy the shared library that all wallets depended on.",
  "fix_description": "Library contracts should not have initialization functions callable directly (only via delegatecall). Remove selfdestruct from library contracts entirely. Use Solidity's 'library' keyword instead of 'contract' for shared logic. Add explicit access controls checking deployment context. Use modern upgradeable proxy patterns (EIP-1967) with proper initialization guards. Separate proxy storage from library logic clearly.",
  "source_reference": "https://github.com/SunWeb3Sec/DeFiHackLabs/blob/main/src/test/2017-11/Parity_kill_exp.sol",
  "external_references": [
    "https://github.com/openethereum/parity-ethereum/issues/6995",
    "https://www.parity.io/blog/a-postmortem-on-the-parity-multi-sig-library-self-destruct",
    "https://etherscan.io/address/0x863df6bfa4469f3ead0be8f9f2aae51c91a907b4"
  ],
  "tags": [
    "delegatecall",
    "selfdestruct",
    "proxy_pattern",
    "library",
    "initialization",
    "access_control",
    "historical"
  ],
  "variant_type": "sanitized",
  "variant_parent_id": "tc_003",
  "notes": "Historic Ethereum bug from 2017. Funds remain frozen to this day. Triggered accidentally by a user testing functions, not by a malicious attacker. Demonstrated the extreme danger of selfdestruct in shared library contracts. Led to significant changes in how proxy patterns are implemented.",
  "contract_file": "contracts/sn_tc_003.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "transformation": {
    "type": "full_sanitization_from_minimalsanitized",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_003.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_003.json",
    "original_id": "tc_003",
    "minimalsanitized_id": "ms_tc_003",
    "script": "strategies/sanitize/sanitize_on_minimal_sanitize.py",
    "changes": [
      "Renamed: ParityWalletProxy \u2192 WalletProxy",
      "Renamed: ParityWalletLibrary \u2192 WalletLibrary"
    ],
    "contract_renames": {
      "ParityWalletProxy": "WalletProxy",
      "ParityWalletLibrary": "WalletLibrary"
    },
    "created_date": "2025-12-31T20:00:31.932670"
  },
  "sanitized_from": "ms_tc_003"
}