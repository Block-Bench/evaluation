{
  "sample_id": "sn_tc_037",
  "exploit_name": "UwU Lend Oracle Manipulation",
  "timestamp": "2024-06",
  "loss_amount_usd": 19300000,
  "blockchain": "ethereum",
  "vulnerability_type": "price_oracle_manipulation",
  "sub_category": "curve_pool_manipulation",
  "severity": "critical",
  "tags": [
    "aave_fork",
    "oracle_manipulation",
    "flashloan",
    "stable_pools",
    "price_manipulation",
    "collateral_inflation"
  ],
  "difficulty": "expert",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-06",
  "description": "UwU Lend, an Aave V2 fork, was exploited for $19.3M through oracle price manipulation. Attackers used massive flashloans to drain liquidity from Curve pools containing sUSDE, causing the oracle to report inflated prices. They then deposited sUSDE as collateral at the manipulated price and borrowed maximum assets against it.",
  "vulnerable_lines": [
    97,
    148
  ],
  "vulnerability_details": {
    "root_cause": "Oracle reliance on manipulable Curve pool spot prices without TWAP or external validation",
    "attack_vector": "Drain Curve pool liquidity to manipulate sUSDE price, deposit at inflated value, borrow maximum assets",
    "vulnerable_functions": [
      "deposit()",
      "borrow()",
      "getAssetPrice()"
    ],
    "key_weakness": [
      "No Time-Weighted Average Price (TWAP)",
      "Reliance on spot prices from Curve pools",
      "No external price feed validation",
      "Missing circuit breakers for price movements",
      "Insufficient liquidity requirements for pricing",
      "No price deviation checks",
      "No borrow caps during volatility"
    ]
  },
  "attack_flow": [
    "Obtain massive flashloans from Aave V3, Balancer, Spark, MorphoBlue, MakerDAO",
    "Execute large swaps in sUSDE/USDe, USDe/DAI, USDe/crvUSD Curve pools",
    "Drain pool liquidity to create price imbalance",
    "UwU Lend oracle reads manipulated spot price from Curve",
    "sUSDE price artificially inflated to 2x real value",
    "Deposit sUSDE into UwU Lend at inflated price",
    "Collateral appears worth 2x actual value due to manipulation",
    "Borrow maximum WETH, DAI, USDC, WBTC at 85% LTV",
    "Extract $19.3M worth of assets",
    "Reverse Curve swaps to restore price",
    "Position now undercollateralized but attacker extracted value",
    "Repay flashloans with profits"
  ],
  "mitigation": [
    "Implement TWAP oracles with multi-block price averaging",
    "Use Chainlink or external oracles as primary price source",
    "Add deviation checks between multiple price sources",
    "Implement circuit breakers for >X% price movements",
    "Add borrow caps to limit exposure during volatility",
    "Require minimum liquidity depth in pricing pools",
    "Implement gradual price updates, not instant spot prices",
    "Add emergency pause for suspicious activity",
    "Monitor for rapid large-volume swaps in pricing pools"
  ],
  "references": [
    "https://app.blocksec.com/explorer/tx/eth/0x242a0fb4fde9de0dc2fd42e8db743cbc197ffa2bf6a036ba0bba303df296408b",
    "https://x.com/peckshield/status/1800176089316163831",
    "https://etherscan.io/address/0x2409af0251dcb89ee3dee572629291f9b087c668"
  ],
  "contract_file": "contracts/sn_tc_037.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "sanitized",
  "variant_parent_id": "tc_037",
  "transformation": {
    "type": "full_sanitization_from_minimalsanitized",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/contracts/ms_tc_037.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/minimalsanitized/metadata/ms_tc_037.json",
    "original_id": "tc_037",
    "minimalsanitized_id": "ms_tc_037",
    "script": "strategies/sanitize/sanitize_on_minimal_sanitize.py",
    "changes": [
      "Removed comment: Curve...",
      "Renamed: CurveOracle \u2192 PoolOracle",
      "Renamed: UwuLendingPool \u2192 LendingPool",
      "Renamed: ICurvePool \u2192 IStablePool",
      "Renamed: curvePool \u2192 stablePool"
    ],
    "contract_renames": {
      "CurveOracle": "PoolOracle",
      "UwuLendingPool": "LendingPool",
      "ICurvePool": "IStablePool",
      "curvePool": "stablePool"
    },
    "created_date": "2025-12-31T20:00:32.262477"
  },
  "vulnerable_contract": "LendingPool",
  "vulnerable_function": "deposit",
  "sanitized_from": "ms_tc_037"
}