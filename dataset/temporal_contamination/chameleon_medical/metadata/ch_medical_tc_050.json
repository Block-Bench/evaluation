{
  "sample_id": "ch_medical_tc_050",
  "exploit_name": "Munchables",
  "timestamp": "2024-03",
  "loss_amount_usd": 62000000,
  "blockchain": "blast",
  "vulnerability_type": "access_control",
  "sub_category": "rogue_developer",
  "severity": "critical",
  "tags": [
    "gamefi",
    "private_key_compromise",
    "rogue_developer",
    "insider_threat",
    "proxy_upgrade",
    "funds_recovered"
  ],
  "difficulty": "intermediate",
  "temporal_category": "pre_cutoff",
  "cutoff_date": "2024-03",
  "description": "Munchables, a GameFi project on Blast L2, lost $62M when a rogue developer (later revealed as North Korean operative) used admin keys to upgrade contracts and redirect user funds. Uniquely, all funds were recovered after negotiations. The incident highlights insider threats and importance of developer vetting.",
  "vulnerable_lines": [
    71,
    76
  ],
  "vulnerability_details": {
    "root_cause": "Single developer had access to admin private keys without multi-sig or oversight, allowing malicious upgrades",
    "attack_vector": "Rogue developer upgrades LockManager, modifies user withdrawal addresses, drains all locked funds",
    "vulnerable_functions": [
      "setLockRecipient()",
      "emergencyUnlock()",
      "setConfigStorage()",
      "transferAdmin()"
    ],
    "key_weakness": [
      "Single developer with critical key access",
      "No multi-signature requirement",
      "Missing timelock delay",
      "Admin can arbitrarily modify user settings",
      "No user consent required for recipient changes",
      "Insufficient background checks on developers",
      "No code review process for upgrades"
    ]
  },
  "attack_flow": [
    "Rogue developer (DPRK operative) hired by project with admin access",
    "Developer prepares malicious LockManager implementation",
    "Uses admin key to upgrade contract without review",
    "For each user: setLockRecipient(user, attackerWallet)",
    "Calls emergencyUnlock() for all users",
    "Funds flow to attacker's controlled addresses ($62M total)",
    "Transfers to external wallets for mixing",
    "Project traces identity, discovers DPRK link",
    "Negotiations result in full fund return (unusual outcome)",
    "All users compensated, project continues operations"
  ],
  "mitigation": [
    "Require multi-signature (3-of-5) for all admin actions",
    "Implement timelock delay (48 hours) for upgrades",
    "Only users can change their own withdrawal addresses",
    "Remove admin override capabilities for user funds",
    "Thorough background checks and developer vetting",
    "Principle of least privilege for all team members",
    "Mandatory code review by multiple team members",
    "External audit before any upgrade deployment",
    "Store admin keys in Hardware Security Modules",
    "Real-time monitoring with automatic alerts",
    "Gradual privilege escalation for new developers",
    "Move to DAO-controlled governance for upgrades"
  ],
  "references": [
    "https://twitter.com/munchables_io/status/1772670116710154508",
    "https://blastscan.io/address/0x2B0B08e76502c75A0f5d87e03b1e00cf3B1Dd48d"
  ],
  "contract_file": "contracts/ch_medical_tc_050.sol",
  "subset": "annotated",
  "original_subset": "temporal_contamination",
  "variant_type": "chameleon_medical",
  "variant_parent_id": "nc_tc_050",
  "transformation": {
    "type": "chameleon",
    "theme": "medical",
    "source_dir": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments",
    "source_contract": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/contracts/nc_tc_050.sol",
    "source_metadata": "/Users/poamen/projects/grace/blockbench/base/dataset/temporal_contamination/nocomments/metadata/nc_tc_050.json",
    "script": "strategies/chameleon/chameleon_tc.py",
    "changes": [
      "Applied medical theme transformation",
      "Renamed 35/72 identifiers (48.6% coverage)"
    ],
    "rename_map": {
      "amount": "quantity",
      "from": "referrer",
      "account": "chart",
      "GameLockManager": "GameRestrictaccessHandler",
      "admin": "medicalDirector",
      "configStorage": "settingsRepository",
      "PlayerSettings": "PlayerPreferences",
      "lockedAmount": "restrictedQuantity",
      "lockRecipient": "restrictaccessBeneficiary",
      "lockDuration": "restrictaccessStaylength",
      "lockStartTime": "restrictaccessBeginMoment",
      "playerSettings": "playerPreferences",
      "playerBalances": "playerAccountcreditsmap",
      "Locked": "Restricted",
      "player": "participant",
      "recipient": "beneficiary",
      "ConfigUpdated": "SettingsUpdated",
      "oldConfig": "formerSettings",
      "newConfig": "updatedProtocol",
      "sender": "requestor",
      "onlyAdmin": "onlyMedicalDirector",
      "lock": "restrictAccess",
      "duration": "treatmentPeriod",
      "timestamp": "appointmentTime",
      "setConfigStorage": "groupSettingsArchive",
      "_configStorage": "_protocolRepository",
      "setLockRecipient": "collectionRestrictaccessBeneficiary",
      "newRecipient": "updatedBeneficiary",
      "unlock": "grantAccess",
      "settings": "options",
      "locked": "restricted",
      "tokens": "credentials",
      "emergencyUnlock": "urgentGrantaccess",
      "transferAdmin": "transfercareMedicaldirector",
      "newAdmin": "currentMedicaldirector"
    },
    "coverage_percent": 48.61,
    "identifiers_transformed": 35,
    "identifiers_total": 72,
    "created_date": "2025-12-31T19:50:53.828986"
  },
  "vulnerable_contract": "GameRestrictaccessHandler",
  "vulnerable_function": "collectionRestrictaccessBeneficiary",
  "sanitized_from": "ms_tc_050"
}