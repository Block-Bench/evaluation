{
  "id": "ds_t3_015",
  "original_id": "defivulnlabs_reentrancy",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Reentrancy.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "reentrancy",
  "original_category": null,
  "severity": "critical",
  "difficulty_tier": 3,
  "description": "The EtherStore Reentrancy Vulnerability is a flaw in the smart contract design that allows \nan attacker to exploit reentrancy and withdraw more funds than they are entitled to from the EtherStore contract. \nThe vulnerability arises due to the withdrawFunds function in the EtherStore contract,\nwhere the Ether is transferred to the attacker's address before updating their balance. \nThis allows the attacker's contract to make a reentrant call back to the withdrawFunds function before the balance update, \nleading to multiple withdrawals and potentially draining all the Ether from the EtherStore contract.",
  "fix_description": "Follow check-effect-interaction and use OpenZeppelin Reentrancy Guard.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/Reentrancy.sol",
  "source_url": null,
  "references": [
    "https://slowmist.medium.com/introduction-to-smart-contract-vulnerabilities-reentrancy-attack-2893ec8390a"
  ],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_015.sol",
  "subset": "annotated",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_199"
}
