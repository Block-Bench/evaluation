{
  "id": "ds_t3_015",
  "original_id": "defivulnlabs_reentrancy",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Reentrancy.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "reentrancy",
  "original_category": null,
  "severity": "critical",
  "difficulty_tier": 3,
  "description": "The EtherStore Reentrancy issue is a flaw in the smart contract design that allows reentrancy to withdraw more funds than entitled from the EtherStore contract. The issue arises due to the withdrawFunds function in the EtherStore contract, where the Ether is transferred to the caller's address before updating their balance. This allows the caller's contract to make a reentrant call back to the withdrawFunds function before the balance update, leading to multiple withdrawals and potentially draining all the Ether from the EtherStore contract.",
  "fix_description": "Follow check-effect-interaction and use OpenZeppelin Reentrancy Guard.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/Reentrancy.sol",
  "source_url": null,
  "references": [
    "https://slowmist.medium.com/introduction-to-smart-contract-vulnerabilities-reentrancy-attack-2893ec8390a"
  ],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_015.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_199",
  "sanitized_from": "ds_199",
  "sanitized_id": "sn_ds_199",
  "identifier_mappings": {
    "EtherStoreAttack": "EtherStoreOperator",
    "Attack": "Operator",
    "testReentrancy": "testWithdrawal",
    "EtherStoreRemediated": "EtherStoreB",
    "storeRemediated": "storeB",
    "operatorV2": "operatorB",
    "nonReentrant": "checkLock",
    "test_RevertRemediated": "testWithdrawalB"
  },
  "vulnerable_functions": [
    "withdrawFunds"
  ]
}
