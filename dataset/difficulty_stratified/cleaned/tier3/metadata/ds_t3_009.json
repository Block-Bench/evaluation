{
  "id": "ds_t3_009",
  "original_id": "defivulnlabs_unprotected-callback",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Unprotected-callback.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "unprotected_callback",
  "original_category": null,
  "severity": "high",
  "difficulty_tier": 3,
  "description": "The contract uses a callback feature to exceed the maximum mint limit set by the MaxMint721 contract. This is achieved by triggering the onERC721Received function, which internally calls the mint function again. Therefore, although MaxMint721 attempts to limit the number of tokens that a user can mint to MAX_PER_USER, the calling contract successfully mints more tokens than this limit.",
  "fix_description": "Follow check-effect-interaction and use OpenZeppelin Reentrancy Guard.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/Unprotected-callback.sol",
  "source_url": null,
  "references": [
    "https://blocksecteam.medium.com/when-safemint-becomes-unsafe-lessons-from-the-hypebears-security-incident-2965209bda2a"
  ],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_009.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_189",
  "sanitized_from": "ds_189",
  "sanitized_id": "sn_ds_189",
  "vulnerable_functions": [
    "mint"
  ]
}
