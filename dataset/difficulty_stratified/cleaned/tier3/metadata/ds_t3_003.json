{
  "id": "ds_t3_003",
  "original_id": "defivulnlabs_approvescam",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "ApproveScam.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "approval_scam",
  "original_category": null,
  "severity": "medium",
  "difficulty_tier": 3,
  "description": "This issue is associated with the approval process in ERC20 tokens. In this scenario, Alice approves Eve to transfer an unlimited (type(uint256).max) amount of tokens from Alice's account. Later, Eve uses this permission and transfers 1000 tokens from Alice's account to hers. Many scams use approve or setApprovalForAll to gain transfer rights over user tokens.",
  "fix_description": "Users should only approve the amount of tokens necessary for the operation at hand.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/ApproveScam.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_003.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_184",
  "sanitized_from": "ds_184",
  "sanitized_id": "sn_ds_184",
  "identifier_mappings": {
    "Exploit": "operate"
  },
  "vulnerable_functions": [
    "approve",
    "transferFrom"
  ]
}
