{
  "id": "ds_t3_007",
  "original_id": "defivulnlabs_struct-deletion",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Struct-deletion.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "logic_error",
  "original_category": null,
  "severity": "medium",
  "difficulty_tier": 3,
  "description": "Incomplete struct deletion leaves residual data. \nIf you delete a struct containing a mapping, the mapping won't be deleted.\n\nThe bug arises because Solidity's delete keyword does not reset the storage to its \ninitial state but rather performs a partial reset. \nWhen delete  myStructs[structId] is called, \nit only resets the id at mappingId to its default value 0, \nbut the other flags in the mapping remain unchanged. Therefore,\nif the struct is deleted without deleting the mapping inside, \nthe remaining flags will persist in storage.",
  "fix_description": "To fix this bug, you should delete the mapping inside the struct before deleting the struct itself.",
  "is_vulnerable": true,
  "context_level": "intra_contract",
  "original_source_path": "src/test/Struct-deletion.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t3_007.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_188",
  "sanitized_from": "ds_188",
  "sanitized_id": "sn_ds_188",
  "identifier_mappings": {
    "StructDeletionBug": "StructDeletion",
    "FixedStructDeletion": "StructDeletionB",
    "StructDeletionContract": "StructDeletionContract",
    "StructDeletion": "StructDeletion",
    "StructDeletionV2": "StructDeletionB",
    "StructDeletionContractV2": "StructDeletionContractB",
    "testFixedStructDeletion": "testStructDeletionB"
  },
  "vulnerable_functions": [
    "deleteStruct"
  ]
}
