{
  "id": "ds_t2_030",
  "original_id": "notso_denial_of_service_list_dos",
  "source_dataset": "not-so-smart-contracts",
  "language": "solidity",
  "chain": "evm",
  "file_name": "list_dos.sol",
  "vulnerable_function": "refundAll",
  "vulnerable_lines": [],
  "vulnerability_type": "dos",
  "original_category": "denial_of_service",
  "severity": "medium",
  "difficulty_tier": 2,
  "description": "The refundAll() function iterates over an unbounded array of participants to send refunds. An attacker can add many entries to the array, causing the function to exceed block gas limits and permanently fail, preventing legitimate refunds.",
  "fix_description": "Implement a pull-over-push pattern where users withdraw their own refunds. If batch processing is needed, add pagination with start/end indices.",
  "is_vulnerable": true,
  "context_level": "single_file",
  "original_source_path": "denial_of_service/list_dos.sol",
  "source_url": "Trail of Bits",
  "references": [],
  "framework": null,
  "contract_file": "contracts/ds_t2_030.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_120",
  "sanitized_from": "ds_120",
  "sanitized_id": "sn_ds_120",
  "identifier_mappings": {
    "refundDos": "refundAll",
    "CrowdFundSafe": "CrowdFundBatched",
    "refundSafe": "refundBatched",
    "CrowdFundBad": "CrowdFundBasic"
  },
  "vulnerable_functions": [
    "refundAll"
  ]
}
