{
  "id": "ds_t2_022",
  "original_id": "defivulnlabs_backdoor-assembly",
  "source_dataset": "DeFiVulnLabs",
  "language": "solidity",
  "chain": "evm",
  "file_name": "Backdoor-assembly.sol",
  "vulnerable_function": "multiple",
  "vulnerable_lines": [],
  "vulnerability_type": "backdoor",
  "original_category": null,
  "severity": "medium",
  "difficulty_tier": 2,
  "description": "In this contract, an apparently fair 'LotteryGame' contract is subtly designed to allow \na hidden privilege to the contract deployer/administrator. \nThis is achieved through the use of assembly level access to storage variables, \nwhere a referee function is designed to provide an administrative backdoor. \nThe 'pickWinner' function appears to randomly pick a winner, but in reality,\nit allows the administrator to set the winner. \nThis bypasses the usual access controls and can be used to drain the prize pool \nby an unauthorized user, acting as a type of rug pull.\n\nAn attacker can manipulate smart contracts as a backdoor by writing inline assembly. \nAny sensitive parameters can be changed at any time.",
  "fix_description": "Review and fix the vulnerability following security best practices.",
  "is_vulnerable": true,
  "context_level": "single_file",
  "original_source_path": "src/test/Backdoor-assembly.sol",
  "source_url": null,
  "references": [],
  "framework": "foundry",
  "contract_file": "contracts/ds_t2_022.sol",
  "subset": "cleaned",
  "original_subset": "difficulty_stratified",
  "original_ds_id": "ds_109",
  "sanitized_from": "ds_109",
  "sanitized_id": "sn_ds_109",
  "identifier_mappings": {
    "Exploit": "operate"
  },
  "vulnerable_functions": [
    "pickWinner",
    "referee"
  ]
}
